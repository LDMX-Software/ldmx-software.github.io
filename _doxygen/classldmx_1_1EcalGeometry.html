<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.6"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: ldmx::EcalGeometry Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>ldmx</b></li><li class="navelem"><a class="el" href="classldmx_1_1EcalGeometry.html">EcalGeometry</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classldmx_1_1EcalGeometry-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ldmx::EcalGeometry Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aea3b889943246d1a44b7c67b1094bd1c"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#aea3b889943246d1a44b7c67b1094bd1c">~EcalGeometry</a> ()=default</td></tr>
<tr class="separator:aea3b889943246d1a44b7c67b1094bd1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67346b26d72f3a7a6200a2c3744c0658"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a67346b26d72f3a7a6200a2c3744c0658">getID</a> (double x, double y, double z) const</td></tr>
<tr class="separator:a67346b26d72f3a7a6200a2c3744c0658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ef95ec5d5f9714b388ba00fd553cd30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a2ef95ec5d5f9714b388ba00fd553cd30">getID</a> (double x, double y, int layer_id) const</td></tr>
<tr class="separator:a2ef95ec5d5f9714b388ba00fd553cd30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd455e8c4463cf687ae1a24e60c9677b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#acd455e8c4463cf687ae1a24e60c9677b">getID</a> (double x, double y, int layer_id, int module_id) const</td></tr>
<tr class="separator:acd455e8c4463cf687ae1a24e60c9677b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a293431561edfdc3d0f123edbdbbe4237"><td class="memItemLeft" align="right" valign="top">std::tuple&lt; double, double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a293431561edfdc3d0f123edbdbbe4237">getPosition</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> id) const</td></tr>
<tr class="separator:a293431561edfdc3d0f123edbdbbe4237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5efc315947914bec346c25f1c4bf8f3b"><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a5efc315947914bec346c25f1c4bf8f3b">getPositionInModule</a> (int cell_id) const</td></tr>
<tr class="separator:a5efc315947914bec346c25f1c4bf8f3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4427ab0f7f6c4a8e72c71981c3bd132d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a4427ab0f7f6c4a8e72c71981c3bd132d">getZPosition</a> (int layer) const</td></tr>
<tr class="separator:a4427ab0f7f6c4a8e72c71981c3bd132d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e9decbb719af7763ba0fdc134dfce0c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a3e9decbb719af7763ba0fdc134dfce0c">getNumLayers</a> () const</td></tr>
<tr class="separator:a3e9decbb719af7763ba0fdc134dfce0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a721f67332ad0e39e283f9a714293e828"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a721f67332ad0e39e283f9a714293e828">getNumModulesPerLayer</a> () const</td></tr>
<tr class="separator:a721f67332ad0e39e283f9a714293e828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9789643117096e69382f4d1dadba1be3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a9789643117096e69382f4d1dadba1be3">getNumCellsPerModule</a> () const</td></tr>
<tr class="separator:a9789643117096e69382f4d1dadba1be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06d23452011822d2982b0010cddcd288"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a06d23452011822d2982b0010cddcd288">getNN</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> id) const</td></tr>
<tr class="separator:a06d23452011822d2982b0010cddcd288"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af12a764d4675dabd5c0790bd065a0d75"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#af12a764d4675dabd5c0790bd065a0d75">isNN</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> centroid, <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> probe) const</td></tr>
<tr class="separator:af12a764d4675dabd5c0790bd065a0d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c9d1f0d2116ecdbc83b605fa7a8ff9f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a9c9d1f0d2116ecdbc83b605fa7a8ff9f">getNNN</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> id) const</td></tr>
<tr class="separator:a9c9d1f0d2116ecdbc83b605fa7a8ff9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3d852aebced255c7d2b940eef88a24e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ab3d852aebced255c7d2b940eef88a24e">isNNN</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> centroid, <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> probe) const</td></tr>
<tr class="separator:ab3d852aebced255c7d2b940eef88a24e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a255599f9563e9c800dedd271d533c636"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a255599f9563e9c800dedd271d533c636">getModuleMinR</a> () const</td></tr>
<tr class="separator:a255599f9563e9c800dedd271d533c636"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a2ecb686bcb158f75285e1a04f1bc8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#aa0a2ecb686bcb158f75285e1a04f1bc8">getModuleMaxR</a> () const</td></tr>
<tr class="separator:aa0a2ecb686bcb158f75285e1a04f1bc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbc789b7727cd8c917fd244d8b080607"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#abbc789b7727cd8c917fd244d8b080607">getCellMinR</a> () const</td></tr>
<tr class="separator:abbc789b7727cd8c917fd244d8b080607"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af19dc4bede209d1eb6f29fd3cee7a2a2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#af19dc4bede209d1eb6f29fd3cee7a2a2">getCellMaxR</a> () const</td></tr>
<tr class="separator:af19dc4bede209d1eb6f29fd3cee7a2a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff5ff59b428b1b678fee58e3c55d70b0"><td class="memItemLeft" align="right" valign="top">TH2Poly *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#aff5ff59b428b1b678fee58e3c55d70b0">getCellPolyMap</a> () const</td></tr>
<tr class="separator:aff5ff59b428b1b678fee58e3c55d70b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classframework_1_1ConditionsObject"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classframework_1_1ConditionsObject')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classframework_1_1ConditionsObject.html">framework::ConditionsObject</a></td></tr>
<tr class="memitem:a47cde9473f38ece4308bc86449b7f7cd inherit pub_methods_classframework_1_1ConditionsObject"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classframework_1_1ConditionsObject.html#a47cde9473f38ece4308bc86449b7f7cd">ConditionsObject</a> (const std::string &amp;name)</td></tr>
<tr class="separator:a47cde9473f38ece4308bc86449b7f7cd inherit pub_methods_classframework_1_1ConditionsObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acad27a2b212637154ee120a39d2218fa inherit pub_methods_classframework_1_1ConditionsObject"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classframework_1_1ConditionsObject.html#acad27a2b212637154ee120a39d2218fa">~ConditionsObject</a> ()</td></tr>
<tr class="separator:acad27a2b212637154ee120a39d2218fa inherit pub_methods_classframework_1_1ConditionsObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9b359953434555cd095503c57344fca inherit pub_methods_classframework_1_1ConditionsObject"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classframework_1_1ConditionsObject.html#aa9b359953434555cd095503c57344fca">getName</a> () const</td></tr>
<tr class="separator:aa9b359953434555cd095503c57344fca inherit pub_methods_classframework_1_1ConditionsObject"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac16fc26a0b31c6560e4495735fbbcd9e"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classldmx_1_1EcalGeometry.html">EcalGeometry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ac16fc26a0b31c6560e4495735fbbcd9e">debugMake</a> (const <a class="el" href="classframework_1_1config_1_1Parameters.html">framework::config::Parameters</a> &amp;p)</td></tr>
<tr class="separator:ac16fc26a0b31c6560e4495735fbbcd9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a0b5fbaba75a1407685b51a67a3ed76f5"><td class="memItemLeft" align="right" valign="top">static constexpr const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a0b5fbaba75a1407685b51a67a3ed76f5">CONDITIONS_OBJECT_NAME</a> {&quot;EcalGeometry&quot;}</td></tr>
<tr class="separator:a0b5fbaba75a1407685b51a67a3ed76f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ad3712a92b3dfc510a7174a74019199ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ad3712a92b3dfc510a7174a74019199ad">EcalGeometry</a> (const <a class="el" href="classframework_1_1config_1_1Parameters.html">framework::config::Parameters</a> &amp;ps)</td></tr>
<tr class="separator:ad3712a92b3dfc510a7174a74019199ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a7fcfec4d0283112a3051f50566283"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ac9a7fcfec4d0283112a3051f50566283">buildLayerMap</a> ()</td></tr>
<tr class="separator:ac9a7fcfec4d0283112a3051f50566283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a28131bb624396e2cbc935a43f5461"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#aa4a28131bb624396e2cbc935a43f5461">buildModuleMap</a> ()</td></tr>
<tr class="separator:aa4a28131bb624396e2cbc935a43f5461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a646cc4a3db516ed9b9a55da987202613"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a646cc4a3db516ed9b9a55da987202613">buildCellMap</a> ()</td></tr>
<tr class="separator:a646cc4a3db516ed9b9a55da987202613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d7dfae36ac26a3ea5124419199af8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a57d7dfae36ac26a3ea5124419199af8f">buildCellModuleMap</a> ()</td></tr>
<tr class="separator:a57d7dfae36ac26a3ea5124419199af8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa7fc300cacc620d0dcbb395cd4f8789"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#afa7fc300cacc620d0dcbb395cd4f8789">buildNeighborMaps</a> ()</td></tr>
<tr class="separator:afa7fc300cacc620d0dcbb395cd4f8789"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e05778e09f1caa68658fed875fdd9f6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a5e05778e09f1caa68658fed875fdd9f6">distanceToEdge</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> id) const</td></tr>
<tr class="separator:a5e05778e09f1caa68658fed875fdd9f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af65f3d6bfad96b72f756447a845e46b0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#af65f3d6bfad96b72f756447a845e46b0">isEdgeCell</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> cellModuleID) const</td></tr>
<tr class="separator:af65f3d6bfad96b72f756447a845e46b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfecc7c5d3347d34d28c5416e263064f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#abfecc7c5d3347d34d28c5416e263064f">isInside</a> (double normX, double normY) const</td></tr>
<tr class="separator:abfecc7c5d3347d34d28c5416e263064f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae06623889182fa0846e434bde609c095"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">gap_</a></td></tr>
<tr class="memdesc:ae06623889182fa0846e434bde609c095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gap between module flat sides [mm].  <br /></td></tr>
<tr class="separator:ae06623889182fa0846e434bde609c095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a651d592aa54de9287dea72d808cd2554"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a> {0}</td></tr>
<tr class="memdesc:a651d592aa54de9287dea72d808cd2554"><td class="mdescLeft">&#160;</td><td class="mdescRight">Center-to-Flat Radius of cell hexagon [mm].  <br /></td></tr>
<tr class="separator:a651d592aa54de9287dea72d808cd2554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c1f3aadb8de68ddd6b5fb510a5dae3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> {0}</td></tr>
<tr class="memdesc:a64c1f3aadb8de68ddd6b5fb510a5dae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Center-to-Flat Radius of module hexagon [mm].  <br /></td></tr>
<tr class="separator:a64c1f3aadb8de68ddd6b5fb510a5dae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e8b261449b90ba1de53ae5257973452"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a> {0}</td></tr>
<tr class="memdesc:a9e8b261449b90ba1de53ae5257973452"><td class="mdescLeft">&#160;</td><td class="mdescRight">Center-to-Corner Radius of cell hexagon [mm].  <br /></td></tr>
<tr class="separator:a9e8b261449b90ba1de53ae5257973452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace81f2c5be35e292bf5bb5efdd215cc3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a> {0}</td></tr>
<tr class="memdesc:ace81f2c5be35e292bf5bb5efdd215cc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Center-to-Corner Radius of module hexagon [mm].  <br /></td></tr>
<tr class="separator:ace81f2c5be35e292bf5bb5efdd215cc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7e341393af52b14d9ea707c150a7c8e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ac7e341393af52b14d9ea707c150a7c8e">cornersSideUp_</a></td></tr>
<tr class="separator:ac7e341393af52b14d9ea707c150a7c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bb0a11ac0e11f34a5932ad3f60523ab"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a9bb0a11ac0e11f34a5932ad3f60523ab">layer_shift_x_</a></td></tr>
<tr class="separator:a9bb0a11ac0e11f34a5932ad3f60523ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589e6fc3e502ae2eac4582cf5a2948bb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a589e6fc3e502ae2eac4582cf5a2948bb">layer_shift_y_</a></td></tr>
<tr class="separator:a589e6fc3e502ae2eac4582cf5a2948bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e606e7607d19ba4c9f7b5456d8332a3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a6e606e7607d19ba4c9f7b5456d8332a3">layer_shift_odd_</a></td></tr>
<tr class="separator:a6e606e7607d19ba4c9f7b5456d8332a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac468282de94b62e9283a267e69f498f6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ac468282de94b62e9283a267e69f498f6">layer_shift_odd_bilayer_</a></td></tr>
<tr class="separator:ac468282de94b62e9283a267e69f498f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84e72c2f81aa3f1cca68fa7fd6d6e246"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a84e72c2f81aa3f1cca68fa7fd6d6e246">nCellRHeight_</a> {0}</td></tr>
<tr class="separator:a84e72c2f81aa3f1cca68fa7fd6d6e246"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99875f644f9d9a3ff168285327d4b317"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a99875f644f9d9a3ff168285327d4b317">ecalFrontZ_</a> {0}</td></tr>
<tr class="memdesc:a99875f644f9d9a3ff168285327d4b317"><td class="mdescLeft">&#160;</td><td class="mdescRight">Front of ECal relative to world geometry [mm].  <br /></td></tr>
<tr class="separator:a99875f644f9d9a3ff168285327d4b317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795e0ce16e97da42682ab441975898ba"><td class="memItemLeft" align="right" valign="top">std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a795e0ce16e97da42682ab441975898ba">layerZPositions_</a></td></tr>
<tr class="memdesc:a795e0ce16e97da42682ab441975898ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">The layer Z postions are with respect to the front of the ECal [mm].  <br /></td></tr>
<tr class="separator:a795e0ce16e97da42682ab441975898ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab93f50a312f15fff892f3cb2a794deb7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a></td></tr>
<tr class="memdesc:ab93f50a312f15fff892f3cb2a794deb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">verbosity  <br /></td></tr>
<tr class="separator:ab93f50a312f15fff892f3cb2a794deb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabb9051d9ec229d7854c231c648236bb"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::tuple&lt; double, double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a></td></tr>
<tr class="separator:aabb9051d9ec229d7854c231c648236bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63cc67f67a5eb89d692304e79562522a"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::pair&lt; double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a63cc67f67a5eb89d692304e79562522a">module_pos_xy_</a></td></tr>
<tr class="separator:a63cc67f67a5eb89d692304e79562522a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b81b46a7eb02def2e2b29c251fcd7e6"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, std::pair&lt; double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a9b81b46a7eb02def2e2b29c251fcd7e6">cell_pos_in_module_</a></td></tr>
<tr class="separator:a9b81b46a7eb02def2e2b29c251fcd7e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82580d37173279b7b826c851f2f1e964"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::pair&lt; double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a82580d37173279b7b826c851f2f1e964">cell_pos_in_layer_</a></td></tr>
<tr class="separator:a82580d37173279b7b826c851f2f1e964"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac96c88b8b17197cff1fa43f607edd282"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::tuple&lt; double, double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#ac96c88b8b17197cff1fa43f607edd282">cell_global_pos_</a></td></tr>
<tr class="separator:ac96c88b8b17197cff1fa43f607edd282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb99570de6a2dda43ba0c7669e36f1c2"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#acb99570de6a2dda43ba0c7669e36f1c2">NNMap_</a></td></tr>
<tr class="separator:acb99570de6a2dda43ba0c7669e36f1c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a2528207f8b7741ccba242cb8148a0d"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a1a2528207f8b7741ccba242cb8148a0d">NNNMap_</a></td></tr>
<tr class="separator:a1a2528207f8b7741ccba242cb8148a0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0b6afb52e1389b3b12af6f65132d3af"><td class="memItemLeft" align="right" valign="top">TH2Poly&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#af0b6afb52e1389b3b12af6f65132d3af">cell_id_in_module_</a></td></tr>
<tr class="separator:af0b6afb52e1389b3b12af6f65132d3af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a3fd818642a78fd5349c18c901426f594"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalGeometry.html#a3fd818642a78fd5349c18c901426f594">ecal::EcalGeometryProvider</a></td></tr>
<tr class="separator:a3fd818642a78fd5349c18c901426f594"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Translation between real-space positions and cell IDs within the ECal.</p>
<p>This is the object that does the extra geometry <em>not</em> implemented in the gdml. In order to save time during the simulation, the individual cells in the readout hexagons are not constructed individually in Geant4. This means we have to have a translation between position and cell ID which is accomplished by this class.</p>
<p>Moreover, downstream processors sometimes need access to the cell position when they only know the cell ID. This class can also do this conversion.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
ORIENTATION ASSUMPTIONS:</h2>
<ul>
<li>modules and cells have opposite orientation. i.e. if modules are corner-side down, then cells are flat-side down.</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
SOME GEOMETRY:</h2>
<ul>
<li>hexagons have two radii:<ul>
<li>r (half of flat-to-flat width) and R (half of corner-to-corner width).</li>
<li>r = (sqrt(3)/2)R and s = R, where s is the length of an edge.</li>
</ul>
</li>
<li>for seven ecal modules oriented flat-side-down, maximum x and y extents are:<ul>
<li>deltaY = 6r' + 2g = 3sqrt(3)R' + 2g</li>
<li>deltaX = 4R' + s' + 2g/cos(30 deg) = 5R' + 4g/sqrt(3)</li>
<li>where g is uniform gap width between modules, and primed variables correspond to modules.</li>
</ul>
</li>
</ul>
<p>Since the whole hexagon flower has changed orientation since previous versions of the detector (which we wish to still support), I am defining an extra set of axes with respect to the flower itself. Below I have drawn the ECal hexagon i flower and defined two axes: p (through the "pointy sides") and q (through the "flat sides"). In some versions of the ECal flower, p == x and q == y while in others p == -y and q == x. </p><pre class="fragment">     ^
     | q axis
    __
 __/1 \__
/6 \__/2 \
\__/0 \__/ __ p axis __&gt;
/5 \__/3 \
\__/4 \__/
   \__/
</pre><p> Now we can define a process for determining the cellular IDs.</p><ul>
<li>Define a mapping of cell IDs within a module (center of module is the origin)<ul>
<li>Use TH2Poly to do the Hexagon tiling in p,q space</li>
</ul>
</li>
<li>Define center of modules with respect to center of layer in p,q space<ul>
<li>currently this is assumed to be the same within all layers BUT will depend on geometry parameters like the gap between modules</li>
</ul>
</li>
<li>Define center of layers (INCLUDING x,y position)<ul>
<li>some versions of the geometry shift layers off the z axis to cover the gaps between modules</li>
<li>Will need to handle the conversion between x,y and p,q axes</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
THIS GRID:</h2>
<ul>
<li>column-to-column distance in a grid such as ours is 2r = sqrt(3)R.</li>
<li>row-to-row distance is 1.5R (easy to observe that twice that distance = 3R)</li>
</ul>
<p>The cell radius is calculated from the total number of center-to-corner cell radii that span the module height. This count can have fractional counts to account for the fractions of cell radii at the module edges. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00099">99</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aea3b889943246d1a44b7c67b1094bd1c" name="aea3b889943246d1a44b7c67b1094bd1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea3b889943246d1a44b7c67b1094bd1c">&#9670;&#160;</a></span>~EcalGeometry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual ldmx::EcalGeometry::~EcalGeometry </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Class destructor.</p>
<p>Does nothing because the member variables clean up themselves. </p>

</div>
</div>
<a id="ad3712a92b3dfc510a7174a74019199ad" name="ad3712a92b3dfc510a7174a74019199ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3712a92b3dfc510a7174a74019199ad">&#9670;&#160;</a></span>EcalGeometry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::EcalGeometry::EcalGeometry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classframework_1_1config_1_1Parameters.html">framework::config::Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Class constructor, for use only by the provider</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ps</td><td>Parameters to configure the <a class="el" href="classldmx_1_1EcalGeometry.html">EcalGeometry</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00047">47</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   48</span>    : <a class="code hl_class" href="classframework_1_1ConditionsObject.html">framework::ConditionsObject</a>(EcalGeometry::CONDITIONS_OBJECT_NAME) {</div>
<div class="line"><span class="lineno">   49</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a795e0ce16e97da42682ab441975898ba">layerZPositions_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;std::vector&lt;double&gt;&gt;(<span class="stringliteral">&quot;layerZPositions&quot;</span>);</div>
<div class="line"><span class="lineno">   50</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a99875f644f9d9a3ff168285327d4b317">ecalFrontZ_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ecalFrontZ&quot;</span>);</div>
<div class="line"><span class="lineno">   51</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;moduleMinR&quot;</span>);</div>
<div class="line"><span class="lineno">   52</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">gap_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;gap&quot;</span>);</div>
<div class="line"><span class="lineno">   53</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a84e72c2f81aa3f1cca68fa7fd6d6e246">nCellRHeight_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;nCellRHeight&quot;</span>);</div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;verbose&quot;</span>);</div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac7e341393af52b14d9ea707c150a7c8e">cornersSideUp_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;cornersSideUp&quot;</span>);</div>
<div class="line"><span class="lineno">   56</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9bb0a11ac0e11f34a5932ad3f60523ab">layer_shift_x_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;layer_shift_x&quot;</span>);</div>
<div class="line"><span class="lineno">   57</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a589e6fc3e502ae2eac4582cf5a2948bb">layer_shift_y_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;layer_shift_y&quot;</span>);</div>
<div class="line"><span class="lineno">   58</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a6e606e7607d19ba4c9f7b5456d8332a3">layer_shift_odd_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;layer_shift_odd&quot;</span>);</div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac468282de94b62e9283a267e69f498f6">layer_shift_odd_bilayer_</a> = ps.<a class="code hl_function" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;layer_shift_odd_bilayer&quot;</span>);</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a6e606e7607d19ba4c9f7b5456d8332a3">layer_shift_odd_</a> and <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac468282de94b62e9283a267e69f498f6">layer_shift_odd_bilayer_</a>) {</div>
<div class="line"><span class="lineno">   62</span>    EXCEPTION_RAISE(<span class="stringliteral">&quot;BadConf&quot;</span>,</div>
<div class="line"><span class="lineno">   63</span>        <span class="stringliteral">&quot;Cannot shift both odd sensitive layers and odd bilayers&quot;</span>);</div>
<div class="line"><span class="lineno">   64</span>  }</div>
<div class="line"><span class="lineno">   65</span>  </div>
<div class="line"><span class="lineno">   66</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a> = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> * (2 / sqrt(3));</div>
<div class="line"><span class="lineno">   67</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a> = 2 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> / <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a84e72c2f81aa3f1cca68fa7fd6d6e246">nCellRHeight_</a>;</div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a> = (sqrt(3.) / 2.) * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a>;</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 0) {</div>
<div class="line"><span class="lineno">   71</span>    std::cout &lt;&lt; std::endl</div>
<div class="line"><span class="lineno">   72</span>              &lt;&lt; <span class="stringliteral">&quot;[EcalGeometry] Verbosity set in header to &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a></div>
<div class="line"><span class="lineno">   73</span>              &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   74</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;     Building module map with gap &quot;</span> &lt;&lt; std::setprecision(2)</div>
<div class="line"><span class="lineno">   75</span>              &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">gap_</a> &lt;&lt; <span class="stringliteral">&quot;, nCellRHeight &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a84e72c2f81aa3f1cca68fa7fd6d6e246">nCellRHeight_</a></div>
<div class="line"><span class="lineno">   76</span>              &lt;&lt; <span class="stringliteral">&quot;,  min/max radii of cell &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a> &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a></div>
<div class="line"><span class="lineno">   77</span>              &lt;&lt; <span class="stringliteral">&quot;, and module &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   78</span>  }</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>  <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#ac9a7fcfec4d0283112a3051f50566283">buildLayerMap</a>();</div>
<div class="line"><span class="lineno">   81</span>  <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#aa4a28131bb624396e2cbc935a43f5461">buildModuleMap</a>();</div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#a646cc4a3db516ed9b9a55da987202613">buildCellMap</a>();</div>
<div class="line"><span class="lineno">   83</span>  <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#a57d7dfae36ac26a3ea5124419199af8f">buildCellModuleMap</a>();</div>
<div class="line"><span class="lineno">   84</span>  <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#afa7fc300cacc620d0dcbb395cd4f8789">buildNeighborMaps</a>();</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 0) std::cout &lt;&lt; <span class="stringliteral">&quot;[EcalGeometry] : fully constructed&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   87</span>}</div>
<div class="ttc" id="aclassframework_1_1ConditionsObject_html"><div class="ttname"><a href="classframework_1_1ConditionsObject.html">framework::ConditionsObject</a></div><div class="ttdoc">Base class for all conditions objects, very simple.</div><div class="ttdef"><b>Definition:</b> <a href="ConditionsObject_8h_source.html#l00018">ConditionsObject.h:18</a></div></div>
<div class="ttc" id="aclassframework_1_1config_1_1Parameters_html_a18206b7c01007dd706abce7e5505eae1"><div class="ttname"><a href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">framework::config::Parameters::getParameter</a></div><div class="ttdeci">T getParameter(const std::string &amp;name) const</div><div class="ttdef"><b>Definition:</b> <a href="Parameters_8h_source.html#l00089">Parameters.h:89</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a57d7dfae36ac26a3ea5124419199af8f"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a57d7dfae36ac26a3ea5124419199af8f">ldmx::EcalGeometry::buildCellModuleMap</a></div><div class="ttdeci">void buildCellModuleMap()</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00464">EcalGeometry.cxx:464</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a589e6fc3e502ae2eac4582cf5a2948bb"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a589e6fc3e502ae2eac4582cf5a2948bb">ldmx::EcalGeometry::layer_shift_y_</a></div><div class="ttdeci">double layer_shift_y_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00477">EcalGeometry.h:477</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a646cc4a3db516ed9b9a55da987202613"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a646cc4a3db516ed9b9a55da987202613">ldmx::EcalGeometry::buildCellMap</a></div><div class="ttdeci">void buildCellMap()</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00244">EcalGeometry.cxx:244</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a64c1f3aadb8de68ddd6b5fb510a5dae3"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">ldmx::EcalGeometry::moduler_</a></div><div class="ttdeci">double moduler_</div><div class="ttdoc">Center-to-Flat Radius of module hexagon [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00455">EcalGeometry.h:455</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a651d592aa54de9287dea72d808cd2554"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">ldmx::EcalGeometry::cellr_</a></div><div class="ttdeci">double cellr_</div><div class="ttdoc">Center-to-Flat Radius of cell hexagon [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00452">EcalGeometry.h:452</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a6e606e7607d19ba4c9f7b5456d8332a3"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a6e606e7607d19ba4c9f7b5456d8332a3">ldmx::EcalGeometry::layer_shift_odd_</a></div><div class="ttdeci">bool layer_shift_odd_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00486">EcalGeometry.h:486</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a795e0ce16e97da42682ab441975898ba"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a795e0ce16e97da42682ab441975898ba">ldmx::EcalGeometry::layerZPositions_</a></div><div class="ttdeci">std::vector&lt; double &gt; layerZPositions_</div><div class="ttdoc">The layer Z postions are with respect to the front of the ECal [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00515">EcalGeometry.h:515</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a84e72c2f81aa3f1cca68fa7fd6d6e246"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a84e72c2f81aa3f1cca68fa7fd6d6e246">ldmx::EcalGeometry::nCellRHeight_</a></div><div class="ttdeci">double nCellRHeight_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00509">EcalGeometry.h:509</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a99875f644f9d9a3ff168285327d4b317"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a99875f644f9d9a3ff168285327d4b317">ldmx::EcalGeometry::ecalFrontZ_</a></div><div class="ttdeci">double ecalFrontZ_</div><div class="ttdoc">Front of ECal relative to world geometry [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00512">EcalGeometry.h:512</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a9bb0a11ac0e11f34a5932ad3f60523ab"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a9bb0a11ac0e11f34a5932ad3f60523ab">ldmx::EcalGeometry::layer_shift_x_</a></div><div class="ttdeci">double layer_shift_x_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00472">EcalGeometry.h:472</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a9e8b261449b90ba1de53ae5257973452"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">ldmx::EcalGeometry::cellR_</a></div><div class="ttdeci">double cellR_</div><div class="ttdoc">Center-to-Corner Radius of cell hexagon [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00458">EcalGeometry.h:458</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_aa4a28131bb624396e2cbc935a43f5461"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#aa4a28131bb624396e2cbc935a43f5461">ldmx::EcalGeometry::buildModuleMap</a></div><div class="ttdeci">void buildModuleMap()</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00211">EcalGeometry.cxx:211</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_ab93f50a312f15fff892f3cb2a794deb7"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">ldmx::EcalGeometry::verbose_</a></div><div class="ttdeci">int verbose_</div><div class="ttdoc">verbosity</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00519">EcalGeometry.h:519</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_ac468282de94b62e9283a267e69f498f6"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#ac468282de94b62e9283a267e69f498f6">ldmx::EcalGeometry::layer_shift_odd_bilayer_</a></div><div class="ttdeci">bool layer_shift_odd_bilayer_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00500">EcalGeometry.h:500</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_ac7e341393af52b14d9ea707c150a7c8e"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#ac7e341393af52b14d9ea707c150a7c8e">ldmx::EcalGeometry::cornersSideUp_</a></div><div class="ttdeci">bool cornersSideUp_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00467">EcalGeometry.h:467</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_ac9a7fcfec4d0283112a3051f50566283"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#ac9a7fcfec4d0283112a3051f50566283">ldmx::EcalGeometry::buildLayerMap</a></div><div class="ttdeci">void buildLayerMap()</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00176">EcalGeometry.cxx:176</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_ace81f2c5be35e292bf5bb5efdd215cc3"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">ldmx::EcalGeometry::moduleR_</a></div><div class="ttdeci">double moduleR_</div><div class="ttdoc">Center-to-Corner Radius of module hexagon [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00461">EcalGeometry.h:461</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_ae06623889182fa0846e434bde609c095"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">ldmx::EcalGeometry::gap_</a></div><div class="ttdeci">double gap_</div><div class="ttdoc">Gap between module flat sides [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00449">EcalGeometry.h:449</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_afa7fc300cacc620d0dcbb395cd4f8789"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#afa7fc300cacc620d0dcbb395cd4f8789">ldmx::EcalGeometry::buildNeighborMaps</a></div><div class="ttdeci">void buildNeighborMaps()</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00508">EcalGeometry.cxx:508</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00464">buildCellModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00211">buildModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00508">buildNeighborMaps()</a>, <a class="el" href="EcalGeometry_8h_source.html#l00452">cellr_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00458">cellR_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00467">cornersSideUp_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00512">ecalFrontZ_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00449">gap_</a>, <a class="el" href="Parameters_8h_source.html#l00089">framework::config::Parameters::getParameter()</a>, <a class="el" href="EcalGeometry_8h_source.html#l00486">layer_shift_odd_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00500">layer_shift_odd_bilayer_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00472">layer_shift_x_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00477">layer_shift_y_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00515">layerZPositions_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00455">moduler_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00461">moduleR_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00509">nCellRHeight_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00519">verbose_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a646cc4a3db516ed9b9a55da987202613" name="a646cc4a3db516ed9b9a55da987202613"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a646cc4a3db516ed9b9a55da987202613">&#9670;&#160;</a></span>buildCellMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalGeometry::buildCellMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs the flat-bottomed hexagonal grid (cellID) of corner-down hexagonal cells.</p>
<p>Sets ecalMap_ with the defined bins being the ecal cells in coordinates with respect to the module center. Also sets cellPostionMap_ with the keys being the cell ID and the values being the position of the cell with respect to the module center.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Strategy</h2>
<p>Use ROOT's TH2Poly::HoneyComb method to build a large hexagonal grid, then copy the polygons from it which overlap with the module with more than one vertex.</p>
<p>A vertex between three cells is placed at the origin, then the bottom left corner of the honeycomb and the number of x and y cells across the honeycomb is calculated by continuing to decrement the grid x/y point until the module center-to-flat distance is reached.</p>
<p>The hexagons that only have one vertex outside the module hexagon leave a small space un-covered by the tiling, so the vertices adjacent to the external vertex are projected onto the module edge.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellr_</td><td>the center-to-flat cell radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellR_</td><td>the center-to-corner cell radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moduler_</td><td>the center-to-flat module radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moduleR_</td><td>the center-to-flat module radius </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ecalMap_</td><td>TH2Poly with local cell ID to local cell position mapping </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cellPostionMap_</td><td>map of local cell ID to cell center position relative to module </td></tr>
  </table>
  </dd>
</dl>
<p>STRATEGY use ROOT HoneyComb method (build large hex grid, copy polygons that cover module)</p>
<p>the sneaky bit is that the center of TH2Poly::HoneyComb is the center of a cell while the center of one of our modules is the corner between three cells. This means some of the hexagons along the edges of the module will <em>not</em> be regular and need to stretched/squashed a bit.</p>
<p>REMEMBER: We are in p,q space for the cells_in_module_ map. i.e.</p>
<p>^ | q axis __ / \ &ndash; &gt; p axis __/</p>
<p>TODO is this needed?</p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00244">244</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  244</span>                                {</div>
<div class="line"><span class="lineno">  263</span>  TH2Poly gridMap;</div>
<div class="line"><span class="lineno">  264</span>    </div>
<div class="line"><span class="lineno">  265</span>  <span class="comment">// make hexagonal grid [boundary is rectangle] larger than the module</span></div>
<div class="line"><span class="lineno">  266</span>  <span class="keywordtype">double</span> gridMinP = 0., gridMinQ = 0.;  <span class="comment">// start at the origin</span></div>
<div class="line"><span class="lineno">  267</span>  <span class="keywordtype">int</span> numPCells = 0, numQCells = 0;</div>
<div class="line"><span class="lineno">  268</span>    </div>
<div class="line"><span class="lineno">  269</span>  <span class="comment">// first x-cell is only a half</span></div>
<div class="line"><span class="lineno">  270</span>  gridMinP -= <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a>;</div>
<div class="line"><span class="lineno">  271</span>  numPCells++;</div>
<div class="line"><span class="lineno">  272</span>  <span class="keywordflow">while</span> (gridMinP &gt; -1 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>) {</div>
<div class="line"><span class="lineno">  273</span>    gridMinP -= 2 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a>;  <span class="comment">// decrement x by cell center-to-flat diameter</span></div>
<div class="line"><span class="lineno">  274</span>    numPCells++;</div>
<div class="line"><span class="lineno">  275</span>  }</div>
<div class="line"><span class="lineno">  276</span>  <span class="keywordflow">while</span> (gridMinQ &gt; -1 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a>) {</div>
<div class="line"><span class="lineno">  277</span>    <span class="comment">// decrement y by cell center-to-corner radius</span></div>
<div class="line"><span class="lineno">  278</span>    <span class="comment">//  alternate between a full corner-to-corner diameter</span></div>
<div class="line"><span class="lineno">  279</span>    <span class="comment">//  and a side of a cell (center-to-corner radius)</span></div>
<div class="line"><span class="lineno">  280</span>    <span class="keywordflow">if</span> (numQCells % 2 == 0) gridMinQ -= 1 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a>;</div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">else</span> gridMinQ -= 2 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a>;</div>
<div class="line"><span class="lineno">  282</span>    numQCells++;</div>
<div class="line"><span class="lineno">  283</span>  }</div>
<div class="line"><span class="lineno">  284</span>  <span class="comment">// only counted one half of the cells</span></div>
<div class="line"><span class="lineno">  285</span>  numPCells *= 2;</div>
<div class="line"><span class="lineno">  286</span>  numQCells *= 2;</div>
<div class="line"><span class="lineno">  287</span>  </div>
<div class="line"><span class="lineno">  288</span>  gridMap.Honeycomb(gridMinP, gridMinQ, <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a>, numPCells, numQCells);</div>
<div class="line"><span class="lineno">  289</span>  </div>
<div class="line"><span class="lineno">  290</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  291</span>    std::cout &lt;&lt; std::setprecision(2) </div>
<div class="line"><span class="lineno">  292</span>      &lt;&lt; <span class="stringliteral">&quot;[EcalGeometry::buildCellMap] cell rmin: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a></div>
<div class="line"><span class="lineno">  293</span>      &lt;&lt; <span class="stringliteral">&quot; cell rmax: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a> </div>
<div class="line"><span class="lineno">  294</span>      &lt;&lt; <span class="stringliteral">&quot; (gridMinP,gridMinQ) = (&quot;</span></div>
<div class="line"><span class="lineno">  295</span>      &lt;&lt; gridMinP &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; gridMinQ &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><span class="lineno">  296</span>      &lt;&lt; <span class="stringliteral">&quot; (numPCells,numQCells) = (&quot;</span> &lt;&lt; numPCells &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; numQCells</div>
<div class="line"><span class="lineno">  297</span>      &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  298</span>  }</div>
<div class="line"><span class="lineno">  299</span>        </div>
<div class="line"><span class="lineno">  300</span>  <span class="comment">// copy cells lying within module boundaries to a module grid</span></div>
<div class="line"><span class="lineno">  301</span>  TListIter next(gridMap.GetBins());  <span class="comment">// a TH2Poly is a TList of TH2PolyBin</span></div>
<div class="line"><span class="lineno">  302</span>  TH2PolyBin* polyBin = 0;</div>
<div class="line"><span class="lineno">  303</span>  TGraph* poly = 0;   <span class="comment">// a polygon returned by TH2Poly is a TGraph</span></div>
<div class="line"><span class="lineno">  304</span>  <span class="comment">// cells_in_module_ IDs go from 0 to N-1, not equal to original grid cell ID</span></div>
<div class="line"><span class="lineno">  305</span>  <span class="keywordtype">int</span> cell_id = 0;</div>
<div class="line"><span class="lineno">  306</span>  <span class="keywordflow">while</span> ((polyBin = (TH2PolyBin*)next())) {</div>
<div class="line"><span class="lineno">  307</span>    <span class="comment">// these bins are coming from the honeycomb</span></div>
<div class="line"><span class="lineno">  308</span>    <span class="comment">//  grid so we assume that they are regular</span></div>
<div class="line"><span class="lineno">  309</span>    <span class="comment">//  hexagons i.e. has 6 vertices</span></div>
<div class="line"><span class="lineno">  310</span>    poly = (TGraph*)polyBin-&gt;GetPolygon();</div>
<div class="line"><span class="lineno">  311</span>      </div>
<div class="line"><span class="lineno">  312</span>    <span class="comment">// decide whether to copy polygon to new map.</span></div>
<div class="line"><span class="lineno">  313</span>    <span class="comment">// use all vertices in case of cut-off edge polygons.</span></div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordtype">int</span> numVerticesInside = 0;</div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordtype">double</span> vertex_p[6], vertex_q[6];  <span class="comment">// vertices of the cell</span></div>
<div class="line"><span class="lineno">  316</span>    <span class="keywordtype">bool</span> isinside[6];                 <span class="comment">// which vertices are inside</span></div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2) std::cout &lt;&lt; <span class="stringliteral">&quot;    Cell vertices&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  318</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; 6; i++) {</div>
<div class="line"><span class="lineno">  319</span>      poly-&gt;GetPoint(i, vertex_p[i], vertex_q[i]);</div>
<div class="line"><span class="lineno">  320</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2) {</div>
<div class="line"><span class="lineno">  321</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;      vtx # &quot;</span> &lt;&lt; i &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  322</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;      vtx p,q &quot;</span> &lt;&lt; vertex_p[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vertex_q[i]</div>
<div class="line"><span class="lineno">  323</span>          &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  324</span>      }</div>
<div class="line"><span class="lineno">  325</span>      isinside[i] = <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#abfecc7c5d3347d34d28c5416e263064f">isInside</a>(vertex_p[i] / <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>, vertex_q[i] / <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>);</div>
<div class="line"><span class="lineno">  326</span>      <span class="keywordflow">if</span> (isinside[i]) numVerticesInside++;</div>
<div class="line"><span class="lineno">  327</span>    }</div>
<div class="line"><span class="lineno">  328</span>      </div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordflow">if</span> (numVerticesInside &gt; 1) {</div>
<div class="line"><span class="lineno">  330</span>      <span class="comment">// Include this cell if more than one of its vertices is inside the module</span></div>
<div class="line"><span class="lineno">  331</span>      <span class="comment">// hexagon</span></div>
<div class="line"><span class="lineno">  332</span>      <span class="keywordtype">double</span> actual_p[8], actual_q[8];</div>
<div class="line"><span class="lineno">  333</span>      <span class="keywordtype">int</span> num_vertices{0};</div>
<div class="line"><span class="lineno">  334</span>      <span class="keywordflow">if</span> (numVerticesInside &lt; 6) {</div>
<div class="line"><span class="lineno">  335</span>        <span class="comment">// This cell is stradling the edge of the module</span></div>
<div class="line"><span class="lineno">  336</span>        <span class="comment">// and is NOT cleanly cut by module edge</span></div>
<div class="line"><span class="lineno">  337</span>      </div>
<div class="line"><span class="lineno">  338</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 1) {</div>
<div class="line"><span class="lineno">  339</span>          std::cout &lt;&lt; <span class="stringliteral">&quot;    Polygon &quot;</span> &lt;&lt; cell_id</div>
<div class="line"><span class="lineno">  340</span>            &lt;&lt; <span class="stringliteral">&quot; has vertices poking out of module hexagon.&quot;</span></div>
<div class="line"><span class="lineno">  341</span>            &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  342</span>        }</div>
<div class="line"><span class="lineno">  343</span>      </div>
<div class="line"><span class="lineno">  344</span>        <span class="comment">// loop through vertices</span></div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {</div>
<div class="line"><span class="lineno">  346</span>          <span class="keywordtype">int</span> up = i == 5 ? 0 : i + 1;</div>
<div class="line"><span class="lineno">  347</span>          <span class="keywordtype">int</span> dn = i == 0 ? 5 : i - 1;</div>
<div class="line"><span class="lineno">  348</span>          <span class="keywordflow">if</span> (isinside[i] and (not isinside[up] or not isinside[dn])) {</div>
<div class="line"><span class="lineno">  349</span>            <span class="comment">// this vertex is inside the module hexagon and is adjacent to a</span></div>
<div class="line"><span class="lineno">  350</span>            <span class="comment">// vertex outside</span></div>
<div class="line"><span class="lineno">  351</span>            <span class="comment">// ==&gt; project this vertex onto the nearest edge of the module</span></div>
<div class="line"><span class="lineno">  352</span>            <span class="comment">// hexagon</span></div>
<div class="line"><span class="lineno">  353</span>          </div>
<div class="line"><span class="lineno">  354</span>            <span class="comment">// determine which side of hexagon we should project onto</span></div>
<div class="line"><span class="lineno">  355</span>            <span class="keywordtype">double</span> edge_origin_p, edge_origin_q;</div>
<div class="line"><span class="lineno">  356</span>            <span class="keywordtype">double</span> edge_dest_p, edge_dest_q;</div>
<div class="line"><span class="lineno">  357</span>            <span class="keywordflow">if</span> (vertex_p[i] &lt; -<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a> / 2.) {</div>
<div class="line"><span class="lineno">  358</span>              <span class="comment">// sloped edge on negative-x side</span></div>
<div class="line"><span class="lineno">  359</span>              edge_origin_p = -1. * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>;</div>
<div class="line"><span class="lineno">  360</span>              edge_origin_q = 0.;</div>
<div class="line"><span class="lineno">  361</span>              edge_dest_p = -0.5 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>;</div>
<div class="line"><span class="lineno">  362</span>              edge_dest_q = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a>;</div>
<div class="line"><span class="lineno">  363</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vertex_p[i] &gt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a> / 2.) {</div>
<div class="line"><span class="lineno">  364</span>              <span class="comment">// sloped edge on positive-x side</span></div>
<div class="line"><span class="lineno">  365</span>              edge_origin_p = 0.5 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>;</div>
<div class="line"><span class="lineno">  366</span>              edge_origin_q = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a>;</div>
<div class="line"><span class="lineno">  367</span>              edge_dest_p = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>;</div>
<div class="line"><span class="lineno">  368</span>              edge_dest_q = 0.;</div>
<div class="line"><span class="lineno">  369</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  370</span>              <span class="comment">// flat edge at top</span></div>
<div class="line"><span class="lineno">  371</span>              edge_origin_p = 0.5 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>;</div>
<div class="line"><span class="lineno">  372</span>              edge_origin_q = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a>;</div>
<div class="line"><span class="lineno">  373</span>              edge_dest_p = -0.5 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>;</div>
<div class="line"><span class="lineno">  374</span>              edge_dest_q = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a>;</div>
<div class="line"><span class="lineno">  375</span>            }</div>
<div class="line"><span class="lineno">  376</span>            <span class="comment">// flip to bottom half if below x-axis</span></div>
<div class="line"><span class="lineno">  377</span>            <span class="keywordflow">if</span> (vertex_q[i] &lt; 0) {</div>
<div class="line"><span class="lineno">  378</span>              edge_dest_q *= -1;</div>
<div class="line"><span class="lineno">  379</span>              edge_origin_q *= -1;</div>
<div class="line"><span class="lineno">  380</span>            }</div>
<div class="line"><span class="lineno">  381</span>            </div>
<div class="line"><span class="lineno">  382</span>            <span class="comment">// get edge slope vector</span></div>
<div class="line"><span class="lineno">  383</span>            <span class="keywordtype">double</span> edge_slope_p = edge_dest_p - edge_origin_p;</div>
<div class="line"><span class="lineno">  384</span>            <span class="keywordtype">double</span> edge_slope_q = edge_dest_q - edge_origin_q;</div>
<div class="line"><span class="lineno">  385</span>            </div>
<div class="line"><span class="lineno">  386</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2) {</div>
<div class="line"><span class="lineno">  387</span>                  std::cout &lt;&lt; <span class="stringliteral">&quot;Vertex &quot;</span> &lt;&lt; i</div>
<div class="line"><span class="lineno">  388</span>                    &lt;&lt; <span class="stringliteral">&quot; is inside and adjacent to a vertex outside the module.&quot;</span></div>
<div class="line"><span class="lineno">  389</span>                    &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  390</span>                  std::cout &lt;&lt; <span class="stringliteral">&quot;Working on edge with slope (&quot;</span> &lt;&lt; edge_slope_p &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><span class="lineno">  391</span>                            &lt;&lt; edge_slope_q &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><span class="lineno">  392</span>                            &lt;&lt; <span class="stringliteral">&quot; and origin (&quot;</span> &lt;&lt; edge_origin_p &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><span class="lineno">  393</span>                            &lt;&lt; edge_origin_q &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  394</span>            }</div>
<div class="line"><span class="lineno">  395</span>            </div>
<div class="line"><span class="lineno">  396</span>            <span class="comment">// project vertices adjacent to the vertex outside the module onto</span></div>
<div class="line"><span class="lineno">  397</span>            <span class="comment">// the module edge</span></div>
<div class="line"><span class="lineno">  398</span>            <span class="keywordtype">double</span> projection_factor =</div>
<div class="line"><span class="lineno">  399</span>                    ((vertex_p[i] - edge_origin_p) * edge_slope_p +</div>
<div class="line"><span class="lineno">  400</span>                     (vertex_q[i] - edge_origin_q) * edge_slope_q) /</div>
<div class="line"><span class="lineno">  401</span>                    (edge_slope_p * edge_slope_p + edge_slope_q * edge_slope_q);</div>
<div class="line"><span class="lineno">  402</span>            </div>
<div class="line"><span class="lineno">  403</span>            <span class="keywordtype">double</span> proj_p = edge_origin_p + projection_factor * edge_slope_p;</div>
<div class="line"><span class="lineno">  404</span>            <span class="keywordtype">double</span> proj_q = edge_origin_q + projection_factor * edge_slope_q;</div>
<div class="line"><span class="lineno">  405</span>            </div>
<div class="line"><span class="lineno">  406</span>            <span class="keywordflow">if</span> (not isinside[up]) {</div>
<div class="line"><span class="lineno">  407</span>              <span class="comment">// the next point is outside</span></div>
<div class="line"><span class="lineno">  408</span>              actual_p[num_vertices] = vertex_p[i];</div>
<div class="line"><span class="lineno">  409</span>              actual_q[num_vertices] = vertex_q[i];</div>
<div class="line"><span class="lineno">  410</span>              actual_p[num_vertices + 1] = proj_p;</div>
<div class="line"><span class="lineno">  411</span>              actual_q[num_vertices + 1] = proj_q;</div>
<div class="line"><span class="lineno">  412</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  413</span>              <span class="comment">// the previous point was outside</span></div>
<div class="line"><span class="lineno">  414</span>              actual_p[num_vertices] = proj_p;</div>
<div class="line"><span class="lineno">  415</span>              actual_q[num_vertices] = proj_q;</div>
<div class="line"><span class="lineno">  416</span>              actual_p[num_vertices + 1] = vertex_p[i];</div>
<div class="line"><span class="lineno">  417</span>              actual_q[num_vertices + 1] = vertex_q[i];</div>
<div class="line"><span class="lineno">  418</span>            }</div>
<div class="line"><span class="lineno">  419</span>            num_vertices += 2;</div>
<div class="line"><span class="lineno">  420</span>            </div>
<div class="line"><span class="lineno">  421</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2) {</div>
<div class="line"><span class="lineno">  422</span>              std::cout &lt;&lt; <span class="stringliteral">&quot;New Vertex &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; : (&quot;</span> &lt;&lt; vertex_p[i] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><span class="lineno">  423</span>                &lt;&lt; vertex_q[i] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  424</span>            }</div>
<div class="line"><span class="lineno">  425</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  426</span>            actual_p[num_vertices] = vertex_p[i];</div>
<div class="line"><span class="lineno">  427</span>            actual_q[num_vertices] = vertex_q[i];</div>
<div class="line"><span class="lineno">  428</span>            num_vertices++;</div>
<div class="line"><span class="lineno">  429</span>          }  <span class="comment">// should we project or not</span></div>
<div class="line"><span class="lineno">  430</span>        }    <span class="comment">// loop through vertices</span></div>
<div class="line"><span class="lineno">  431</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  432</span>        <span class="comment">// all 6 inside, just copy the vertices over</span></div>
<div class="line"><span class="lineno">  433</span>        num_vertices = 6;</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 6; i++) {</div>
<div class="line"><span class="lineno">  435</span>          actual_p[i] = vertex_p[i];</div>
<div class="line"><span class="lineno">  436</span>          actual_q[i] = vertex_q[i];</div>
<div class="line"><span class="lineno">  437</span>        }</div>
<div class="line"><span class="lineno">  438</span>      }  <span class="comment">// if numVerticesInside is less than 5</span></div>
<div class="line"><span class="lineno">  439</span>  </div>
<div class="line"><span class="lineno">  440</span>      <span class="comment">// TH2Poly needs to have its own copy of the polygon TGraph</span></div>
<div class="line"><span class="lineno">  441</span>      <span class="comment">//  otherwise, we get a seg fault when EcalGeometry is destructed</span></div>
<div class="line"><span class="lineno">  442</span>      <span class="comment">//  because the polygon that was copied over from gridMap is deleted at</span></div>
<div class="line"><span class="lineno">  443</span>      <span class="comment">//  the end of this function</span></div>
<div class="line"><span class="lineno">  444</span>      <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#af0b6afb52e1389b3b12af6f65132d3af">cell_id_in_module_</a>.AddBin(num_vertices, actual_p, actual_q);</div>
<div class="line"><span class="lineno">  445</span>      </div>
<div class="line"><span class="lineno">  449</span>      <span class="keywordtype">double</span> p = (polyBin-&gt;GetXMax() + polyBin-&gt;GetXMin()) / 2.;</div>
<div class="line"><span class="lineno">  450</span>      <span class="keywordtype">double</span> q = (polyBin-&gt;GetYMax() + polyBin-&gt;GetYMin()) / 2.;</div>
<div class="line"><span class="lineno">  451</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 1) {</div>
<div class="line"><span class="lineno">  452</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;    Copying poly with ID &quot;</span></div>
<div class="line"><span class="lineno">  453</span>            &lt;&lt; polyBin-&gt;GetBinNumber() &lt;&lt; <span class="stringliteral">&quot; and (p,q) (&quot;</span></div>
<div class="line"><span class="lineno">  454</span>            &lt;&lt; std::setprecision(2) &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; q &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  455</span>      }</div>
<div class="line"><span class="lineno">  456</span>      <span class="comment">// save cell location as center of ENTIRE hexagon</span></div>
<div class="line"><span class="lineno">  457</span>      <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9b81b46a7eb02def2e2b29c251fcd7e6">cell_pos_in_module_</a>[cell_id] = std::pair&lt;double, double&gt;(p, q);</div>
<div class="line"><span class="lineno">  458</span>      ++cell_id; <span class="comment">// incrememnt cell ID</span></div>
<div class="line"><span class="lineno">  459</span>    } <span class="comment">// if num vertices inside is &gt; 1</span></div>
<div class="line"><span class="lineno">  460</span>  }   <span class="comment">// loop over larger grid spanning module hexagon</span></div>
<div class="line"><span class="lineno">  461</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  462</span>}</div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a9b81b46a7eb02def2e2b29c251fcd7e6"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a9b81b46a7eb02def2e2b29c251fcd7e6">ldmx::EcalGeometry::cell_pos_in_module_</a></div><div class="ttdeci">std::map&lt; int, std::pair&lt; double, double &gt; &gt; cell_pos_in_module_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00541">EcalGeometry.h:541</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_abfecc7c5d3347d34d28c5416e263064f"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#abfecc7c5d3347d34d28c5416e263064f">ldmx::EcalGeometry::isInside</a></div><div class="ttdeci">bool isInside(double normX, double normY) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00595">EcalGeometry.cxx:595</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_af0b6afb52e1389b3b12af6f65132d3af"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#af0b6afb52e1389b3b12af6f65132d3af">ldmx::EcalGeometry::cell_id_in_module_</a></div><div class="ttdeci">TH2Poly cell_id_in_module_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00587">EcalGeometry.h:587</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00587">cell_id_in_module_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00541">cell_pos_in_module_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00452">cellr_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00458">cellR_</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00595">isInside()</a>, <a class="el" href="EcalGeometry_8h_source.html#l00455">moduler_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00461">moduleR_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00519">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="a57d7dfae36ac26a3ea5124419199af8f" name="a57d7dfae36ac26a3ea5124419199af8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57d7dfae36ac26a3ea5124419199af8f">&#9670;&#160;</a></span>buildCellModuleMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalGeometry::buildCellModuleMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs the positions of all the cells in a layer relative to the ecal center.</p>
<p>This uses the modulePostionMap_ and cellPositionMap_ to calculate the center of all cells relative to the ecal center.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">modulePositionMap_</td><td>map of module IDs to module centers relative to ecal </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellPositionMap_</td><td>map of cell IDs to cell centers relative to module </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>
<p>construct map of cell centers relative to layer center</p>
<p>construct map of global cell centers relative to target center</p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00464">464</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  464</span>                                      {</div>
<div class="line"><span class="lineno">  465</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 0)</div>
<div class="line"><span class="lineno">  466</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;[EcalGeometry::buildCellModuleMap] Building cellModule position map&quot;</span></div>
<div class="line"><span class="lineno">  467</span>              &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  469</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [module_id, module_xy] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a63cc67f67a5eb89d692304e79562522a">module_pos_xy_</a>) {</div>
<div class="line"><span class="lineno">  470</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [cell_id, cell_pq] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9b81b46a7eb02def2e2b29c251fcd7e6">cell_pos_in_module_</a>) {</div>
<div class="line"><span class="lineno">  471</span>      <span class="keywordtype">double</span> cell_x{cell_pq.first}, cell_y{cell_pq.second};</div>
<div class="line"><span class="lineno">  472</span>      <span class="comment">// convert from (p,q) to (x,y) space</span></div>
<div class="line"><span class="lineno">  473</span>      <span class="comment">// when the corners are not up, x = p and y = q</span></div>
<div class="line"><span class="lineno">  474</span>      <span class="comment">// so no transformation needs to be done</span></div>
<div class="line"><span class="lineno">  475</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac7e341393af52b14d9ea707c150a7c8e">cornersSideUp_</a>) unrotate(cell_x, cell_y);</div>
<div class="line"><span class="lineno">  476</span>      </div>
<div class="line"><span class="lineno">  477</span>      <span class="comment">// calculate cell&#39;s pq relative to entire layer center</span></div>
<div class="line"><span class="lineno">  478</span>      <span class="keyword">auto</span> cell_rel_to_layer = std::make_pair(</div>
<div class="line"><span class="lineno">  479</span>          module_xy.first + cell_x,</div>
<div class="line"><span class="lineno">  480</span>          module_xy.second + cell_y</div>
<div class="line"><span class="lineno">  481</span>          );</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>      <span class="comment">// now add the layer-center values to get the global position</span></div>
<div class="line"><span class="lineno">  484</span>      <span class="comment">// of the cell</span></div>
<div class="line"><span class="lineno">  485</span>      <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a82580d37173279b7b826c851f2f1e964">cell_pos_in_layer_</a>[EcalID(0, module_id, cell_id)] = cell_rel_to_layer;</div>
<div class="line"><span class="lineno">  486</span>    }</div>
<div class="line"><span class="lineno">  487</span>  }</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  490</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [layer_id, layer_xyz] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>) {</div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [flat_id, rel_to_layer] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a82580d37173279b7b826c851f2f1e964">cell_pos_in_layer_</a>) {</div>
<div class="line"><span class="lineno">  492</span>      <span class="comment">// now add the layer-center values to get the global position</span></div>
<div class="line"><span class="lineno">  493</span>      <span class="comment">// of the cell</span></div>
<div class="line"><span class="lineno">  494</span>      <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac96c88b8b17197cff1fa43f607edd282">cell_global_pos_</a>[EcalID(layer_id, flat_id.module(), flat_id.cell())]</div>
<div class="line"><span class="lineno">  495</span>        = std::make_tuple(</div>
<div class="line"><span class="lineno">  496</span>            rel_to_layer.first + std::get&lt;0&gt;(layer_xyz),</div>
<div class="line"><span class="lineno">  497</span>            rel_to_layer.second + std::get&lt;1&gt;(layer_xyz),</div>
<div class="line"><span class="lineno">  498</span>            std::get&lt;2&gt;(layer_xyz));</div>
<div class="line"><span class="lineno">  499</span>    }</div>
<div class="line"><span class="lineno">  500</span>  }</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 0)</div>
<div class="line"><span class="lineno">  503</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;  contained &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac96c88b8b17197cff1fa43f607edd282">cell_global_pos_</a>.size() &lt;&lt; <span class="stringliteral">&quot; entries. &quot;</span></div>
<div class="line"><span class="lineno">  504</span>              &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  505</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  506</span>}</div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a63cc67f67a5eb89d692304e79562522a"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a63cc67f67a5eb89d692304e79562522a">ldmx::EcalGeometry::module_pos_xy_</a></div><div class="ttdeci">std::map&lt; int, std::pair&lt; double, double &gt; &gt; module_pos_xy_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00533">EcalGeometry.h:533</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a82580d37173279b7b826c851f2f1e964"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a82580d37173279b7b826c851f2f1e964">ldmx::EcalGeometry::cell_pos_in_layer_</a></div><div class="ttdeci">std::map&lt; EcalID, std::pair&lt; double, double &gt; &gt; cell_pos_in_layer_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00552">EcalGeometry.h:552</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_aabb9051d9ec229d7854c231c648236bb"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">ldmx::EcalGeometry::layer_pos_xy_</a></div><div class="ttdeci">std::map&lt; int, std::tuple&lt; double, double, double &gt; &gt; layer_pos_xy_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00525">EcalGeometry.h:525</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_ac96c88b8b17197cff1fa43f607edd282"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#ac96c88b8b17197cff1fa43f607edd282">ldmx::EcalGeometry::cell_global_pos_</a></div><div class="ttdeci">std::map&lt; EcalID, std::tuple&lt; double, double, double &gt; &gt; cell_global_pos_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00563">EcalGeometry.h:563</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00563">cell_global_pos_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00552">cell_pos_in_layer_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00541">cell_pos_in_module_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00467">cornersSideUp_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00525">layer_pos_xy_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00533">module_pos_xy_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00519">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="ac9a7fcfec4d0283112a3051f50566283" name="ac9a7fcfec4d0283112a3051f50566283"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a7fcfec4d0283112a3051f50566283">&#9670;&#160;</a></span>buildLayerMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalGeometry::buildLayerMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs the positions of the layers in world coordinates </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00176">176</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  176</span>                                 {</div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  178</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;[EcalGeometry::buildLayerMap] &quot;</span></div>
<div class="line"><span class="lineno">  179</span>      &lt;&lt; <span class="stringliteral">&quot; Building layer map with &quot;</span> </div>
<div class="line"><span class="lineno">  180</span>      &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a795e0ce16e97da42682ab441975898ba">layerZPositions_</a>.size() &lt;&lt; <span class="stringliteral">&quot; layers&quot;</span> &lt;&lt; std::endl;;</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a6e606e7607d19ba4c9f7b5456d8332a3">layer_shift_odd_</a> or <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac468282de94b62e9283a267e69f498f6">layer_shift_odd_bilayer_</a>) {</div>
<div class="line"><span class="lineno">  182</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;  shifting odd &quot;</span>;</div>
<div class="line"><span class="lineno">  183</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a6e606e7607d19ba4c9f7b5456d8332a3">layer_shift_odd_</a>) std::cout &lt;&lt; <span class="stringliteral">&quot;layers&quot;</span>;</div>
<div class="line"><span class="lineno">  184</span>      <span class="keywordflow">else</span> std::cout &lt;&lt; <span class="stringliteral">&quot;bilayers&quot;</span>;</div>
<div class="line"><span class="lineno">  185</span>      std::cout &lt;&lt; <span class="stringliteral">&quot; by (x,y) = (&quot;</span> </div>
<div class="line"><span class="lineno">  186</span>        &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9bb0a11ac0e11f34a5932ad3f60523ab">layer_shift_x_</a> &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a589e6fc3e502ae2eac4582cf5a2948bb">layer_shift_y_</a> &lt;&lt; <span class="stringliteral">&quot;) mm&quot;</span></div>
<div class="line"><span class="lineno">  187</span>        &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  188</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  189</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;  without any shifting&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  190</span>    }</div>
<div class="line"><span class="lineno">  191</span>  }</div>
<div class="line"><span class="lineno">  192</span>  <span class="keywordflow">for</span> (std::size_t i_layer{0}; i_layer &lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a795e0ce16e97da42682ab441975898ba">layerZPositions_</a>.size(); ++i_layer) {</div>
<div class="line"><span class="lineno">  193</span>    <span class="comment">// default is centered on z-axis</span></div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordtype">double</span> x{0},y{0},z{<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a99875f644f9d9a3ff168285327d4b317">ecalFrontZ_</a>+<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a795e0ce16e97da42682ab441975898ba">layerZPositions_</a>.at(i_layer)};</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a6e606e7607d19ba4c9f7b5456d8332a3">layer_shift_odd_</a> and (i_layer % 2 == 1)) {</div>
<div class="line"><span class="lineno">  196</span>      x += <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9bb0a11ac0e11f34a5932ad3f60523ab">layer_shift_x_</a>;</div>
<div class="line"><span class="lineno">  197</span>      y += <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a589e6fc3e502ae2eac4582cf5a2948bb">layer_shift_y_</a>;</div>
<div class="line"><span class="lineno">  198</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac468282de94b62e9283a267e69f498f6">layer_shift_odd_bilayer_</a> and ((i_layer/2) % 2 == 1)) {</div>
<div class="line"><span class="lineno">  199</span>      x += <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9bb0a11ac0e11f34a5932ad3f60523ab">layer_shift_x_</a>;</div>
<div class="line"><span class="lineno">  200</span>      y += <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a589e6fc3e502ae2eac4582cf5a2948bb">layer_shift_y_</a>;</div>
<div class="line"><span class="lineno">  201</span>    }</div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2) {</div>
<div class="line"><span class="lineno">  203</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;    Layer &quot;</span> &lt;&lt; i_layer</div>
<div class="line"><span class="lineno">  204</span>        &lt;&lt; <span class="stringliteral">&quot; has center at (&quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; z &lt;&lt; <span class="stringliteral">&quot;) mm&quot;</span></div>
<div class="line"><span class="lineno">  205</span>        &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  206</span>    }</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>[i_layer] = std::make_tuple(x,y,z);  </div>
<div class="line"><span class="lineno">  208</span>  } </div>
<div class="line"><span class="lineno">  209</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00512">ecalFrontZ_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00525">layer_pos_xy_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00486">layer_shift_odd_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00500">layer_shift_odd_bilayer_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00472">layer_shift_x_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00477">layer_shift_y_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00515">layerZPositions_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00519">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="aa4a28131bb624396e2cbc935a43f5461" name="aa4a28131bb624396e2cbc935a43f5461"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a28131bb624396e2cbc935a43f5461">&#9670;&#160;</a></span>buildModuleMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalGeometry::buildModuleMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs the positions of the seven modules (moduleID) relative to the ecal center</p>
<p>Sets modulePositionMap_ using the module IDs for keys and the centers of the module hexagons for values.</p>
<p>The module IDs are set in the ecal.gdml file and are replicated here.</p><ul>
<li>0 for center module</li>
<li>1 on top (12 o'clock)</li>
<li>clockwise till 6 at 11 o'clock</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gap_</td><td>separation between module flat-sides </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moduler_</td><td>center-to-flat module radius </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">modulePositionMap_</td><td>map of module IDs to module centers relative to ecal </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00211">211</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  211</span>                                  {</div>
<div class="line"><span class="lineno">  212</span>  <span class="keyword">static</span> <span class="keywordtype">double</span> C_PI = 3.14159265358979323846;  <span class="comment">// or TMath::Pi(), #define, atan(), ...</span></div>
<div class="line"><span class="lineno">  213</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  214</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;[EcalGeometry::buildModuleMap] &quot;</span></div>
<div class="line"><span class="lineno">  215</span>      &lt;&lt; <span class="stringliteral">&quot;Building module position map for module min r of &quot;</span></div>
<div class="line"><span class="lineno">  216</span>      &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> &lt;&lt; <span class="stringliteral">&quot; and gap of &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">gap_</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  217</span>  }</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>  <span class="comment">// the center module (module_id == 0) has always been (and will always be?)</span></div>
<div class="line"><span class="lineno">  220</span>  <span class="comment">//  centered with respect to the layer position</span></div>
<div class="line"><span class="lineno">  221</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a63cc67f67a5eb89d692304e79562522a">module_pos_xy_</a>[0] = std::pair&lt;double, double&gt;(0., 0.);</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>  <span class="comment">// for flat-side-up designs (v12 and earlier), the modules are numbered 1 on</span></div>
<div class="line"><span class="lineno">  224</span>  <span class="comment">// positive y-axis and then counter-clockwise until 6</span></div>
<div class="line"><span class="lineno">  225</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  226</span>  <span class="comment">// for corner-side-up designes (v13 and later), the modules are numbered 1 on</span></div>
<div class="line"><span class="lineno">  227</span>  <span class="comment">// positive x-axis and then counter-clockwise until 6.</span></div>
<div class="line"><span class="lineno">  228</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">id</span> = 1; <span class="keywordtype">id</span> &lt; 7; <span class="keywordtype">id</span>++) {</div>
<div class="line"><span class="lineno">  229</span>    <span class="comment">// flat-side-up</span></div>
<div class="line"><span class="lineno">  230</span>    <span class="keywordtype">double</span> x = (2. * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> + <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">gap_</a>) * sin((<span class="keywordtype">id</span> - 1) * (C_PI / 3.));</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordtype">double</span> y = (2. * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> + <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">gap_</a>) * cos((<span class="keywordtype">id</span> - 1) * (C_PI / 3.));</div>
<div class="line"><span class="lineno">  232</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac7e341393af52b14d9ea707c150a7c8e">cornersSideUp_</a>) {</div>
<div class="line"><span class="lineno">  233</span>      <span class="comment">// re-calculating to make sure centers match GDML</span></div>
<div class="line"><span class="lineno">  234</span>      x = (2. * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> + <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">gap_</a>) * cos((<span class="keywordtype">id</span> - 1) * (C_PI / 3.));</div>
<div class="line"><span class="lineno">  235</span>      y = - (2. * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> + <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ae06623889182fa0846e434bde609c095">gap_</a>) * sin((<span class="keywordtype">id</span> - 1) * (C_PI / 3.));</div>
<div class="line"><span class="lineno">  236</span>    }</div>
<div class="line"><span class="lineno">  237</span>    <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a63cc67f67a5eb89d692304e79562522a">module_pos_xy_</a>[id] = std::pair&lt;double, double&gt;(x, y);</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2)</div>
<div class="line"><span class="lineno">  239</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;    Module &quot;</span> &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot; is centered at (x,y) = &quot;</span></div>
<div class="line"><span class="lineno">  240</span>        &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;) mm&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  241</span>  }</div>
<div class="line"><span class="lineno">  242</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00467">cornersSideUp_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00449">gap_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00533">module_pos_xy_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00455">moduler_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00519">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="afa7fc300cacc620d0dcbb395cd4f8789" name="afa7fc300cacc620d0dcbb395cd4f8789"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa7fc300cacc620d0dcbb395cd4f8789">&#9670;&#160;</a></span>buildNeighborMaps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalGeometry::buildNeighborMaps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Construts NNMap and NNNMap</p>
<p>Since this only occurs once during processing, we can be wasteful. We do a nested loop over the entire cellular position map and calculate neighbors by seeing which cells are within multiples of the cellular radius of each other.</p>
<dl class="section note"><dt>Note</dt><dd>We require two cells to be in the same layer in order to be nearest neighbors or next-nearest neighbors.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellModulePostionMap_</td><td>map of cells to cell centers relative to ecal </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NNMap_</td><td>map of cell IDs to list of cell IDs that are its nearest neighbors </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NNNMap_</td><td>map of cell IDs to list of cell IDs that are its next-to-nearest neighbors </td></tr>
  </table>
  </dd>
</dl>
<p>STRATEGY</p>
<p>Neighbors may include from other modules. All this is precomputed. So we can be wasteful here. Gaps may be nonzero, so we simply apply an anulus requirement (r &lt; point &lt;= r+dr) using total x,y positions relative to the ecal center (cell+module positions). This makes the routine portable to future cell layouts. Note that the module centers already take into account a nonzero gap. The number of neighbors is not simple because: edges, and that module edges have cutoff cells. (NN) Center within [1*cellr_, 3*cellr_] (NNN) Center within [3*cellr_, 4.5*cellr_] Chosen b/c in ideal case, centers are at 2*cell_ (NN), and at 3*cellR_=3.46*cellr_ and 4*cellr_ (NNN).</p>
<p>do distance calculation</p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00508">508</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  508</span>                                     {</div>
<div class="line"><span class="lineno">  522</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 0)</div>
<div class="line"><span class="lineno">  523</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;[EcalGeometry::buildNeighborMaps] : &quot;</span></div>
<div class="line"><span class="lineno">  524</span>      &lt;&lt; <span class="stringliteral">&quot;Building Nearest and Next-Nearest Neighbor maps&quot;</span></div>
<div class="line"><span class="lineno">  525</span>      &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#acb99570de6a2dda43ba0c7669e36f1c2">NNMap_</a>.clear();</div>
<div class="line"><span class="lineno">  528</span>  <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a1a2528207f8b7741ccba242cb8148a0d">NNNMap_</a>.clear();</div>
<div class="line"><span class="lineno">  529</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [center_id, center_xyz] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a82580d37173279b7b826c851f2f1e964">cell_pos_in_layer_</a>) {</div>
<div class="line"><span class="lineno">  530</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [probe_id, probe_xyz] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a82580d37173279b7b826c851f2f1e964">cell_pos_in_layer_</a>) {</div>
<div class="line"><span class="lineno">  532</span>      <span class="keywordtype">double</span> dist = distance(probe_xyz, center_xyz);</div>
<div class="line"><span class="lineno">  533</span>      <span class="keywordflow">if</span> (dist &gt; 1 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a> &amp;&amp; dist &lt;= 3. * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a>) {</div>
<div class="line"><span class="lineno">  534</span>        <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#acb99570de6a2dda43ba0c7669e36f1c2">NNMap_</a>[center_id].push_back(probe_id);</div>
<div class="line"><span class="lineno">  535</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dist &gt; 3. * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a> &amp;&amp; dist &lt;= 4.5 * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a>) {</div>
<div class="line"><span class="lineno">  536</span>        <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a1a2528207f8b7741ccba242cb8148a0d">NNNMap_</a>[center_id].push_back(probe_id);</div>
<div class="line"><span class="lineno">  537</span>      }</div>
<div class="line"><span class="lineno">  538</span>    }</div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 1)</div>
<div class="line"><span class="lineno">  540</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;  Found &quot;</span> &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#acb99570de6a2dda43ba0c7669e36f1c2">NNMap_</a>[center_id].size() &lt;&lt; <span class="stringliteral">&quot; NN and &quot;</span></div>
<div class="line"><span class="lineno">  541</span>        &lt;&lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a1a2528207f8b7741ccba242cb8148a0d">NNNMap_</a>[center_id].size() &lt;&lt; <span class="stringliteral">&quot; NNN for cell &quot;</span> &lt;&lt; center_id</div>
<div class="line"><span class="lineno">  542</span>        &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  543</span>  }</div>
<div class="line"><span class="lineno">  544</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  545</span><span class="comment">   * DEBUG CHECK HERE</span></div>
<div class="line"><span class="lineno">  546</span><span class="comment">   *  this is double checking that NN and NNN can cross modules</span></div>
<div class="line"><span class="lineno">  547</span><span class="comment">  if (verbose_ &gt; 2) {</span></div>
<div class="line"><span class="lineno">  548</span><span class="comment">    double specialX =</span></div>
<div class="line"><span class="lineno">  549</span><span class="comment">        0.5 * moduleR_ - 0.5 * cellr_;  // center of cell which is upper-right</span></div>
<div class="line"><span class="lineno">  550</span><span class="comment">                                        // corner of center module</span></div>
<div class="line"><span class="lineno">  551</span><span class="comment">    double specialY = moduler_ - 0.5 * cellR_;</span></div>
<div class="line"><span class="lineno">  552</span><span class="comment">    EcalID specialCellModuleID = getCellModuleID(specialX, specialY);</span></div>
<div class="line"><span class="lineno">  553</span><span class="comment">    std::cout &lt;&lt; &quot;The neighbors of the bin in the upper-right corner of the &quot;</span></div>
<div class="line"><span class="lineno">  554</span><span class="comment">                 &quot;center module, with cellModuleID &quot;</span></div>
<div class="line"><span class="lineno">  555</span><span class="comment">              &lt;&lt; specialCellModuleID &lt;&lt; &quot; include &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  556</span><span class="comment">    for (auto centerNN : NNMap_.at(specialCellModuleID)) {</span></div>
<div class="line"><span class="lineno">  557</span><span class="comment">      std::cout &lt;&lt; &quot; NN &quot; &lt;&lt; centerNN</span></div>
<div class="line"><span class="lineno">  558</span><span class="comment">                &lt;&lt; TString::Format(&quot; (x,y) (%.2f, %.2f)&quot;,</span></div>
<div class="line"><span class="lineno">  559</span><span class="comment">                                   getCellCenterAbsolute(centerNN).first,</span></div>
<div class="line"><span class="lineno">  560</span><span class="comment">                                   getCellCenterAbsolute(centerNN).second)</span></div>
<div class="line"><span class="lineno">  561</span><span class="comment">                &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  562</span><span class="comment">    }</span></div>
<div class="line"><span class="lineno">  563</span><span class="comment">    for (auto centerNNN : NNNMap_.at(specialCellModuleID)) {</span></div>
<div class="line"><span class="lineno">  564</span><span class="comment">      std::cout &lt;&lt; &quot; NNN &quot; &lt;&lt; centerNNN</span></div>
<div class="line"><span class="lineno">  565</span><span class="comment">                &lt;&lt; TString::Format(&quot; (x,y) (%.2f, %.2f)&quot;,</span></div>
<div class="line"><span class="lineno">  566</span><span class="comment">                                   getCellCenterAbsolute(centerNNN).first,</span></div>
<div class="line"><span class="lineno">  567</span><span class="comment">                                   getCellCenterAbsolute(centerNNN).second)</span></div>
<div class="line"><span class="lineno">  568</span><span class="comment">                &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  569</span><span class="comment">    }</span></div>
<div class="line"><span class="lineno">  570</span><span class="comment">    std::cout &lt;&lt; TString::Format(</span></div>
<div class="line"><span class="lineno">  571</span><span class="comment">                     &quot;This bin is a distance of %.2f away from a module edge. &quot;</span></div>
<div class="line"><span class="lineno">  572</span><span class="comment">                     &quot;Decision isEdge %d.&quot;,</span></div>
<div class="line"><span class="lineno">  573</span><span class="comment">                     distanceToEdge(specialCellModuleID),</span></div>
<div class="line"><span class="lineno">  574</span><span class="comment">                     isEdgeCell(specialCellModuleID))</span></div>
<div class="line"><span class="lineno">  575</span><span class="comment">              &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  576</span><span class="comment">  }</span></div>
<div class="line"><span class="lineno">  577</span><span class="comment">  */</span></div>
<div class="line"><span class="lineno">  578</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  579</span>}</div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a1a2528207f8b7741ccba242cb8148a0d"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a1a2528207f8b7741ccba242cb8148a0d">ldmx::EcalGeometry::NNNMap_</a></div><div class="ttdeci">std::map&lt; EcalID, std::vector&lt; EcalID &gt; &gt; NNNMap_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00577">EcalGeometry.h:577</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_acb99570de6a2dda43ba0c7669e36f1c2"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#acb99570de6a2dda43ba0c7669e36f1c2">ldmx::EcalGeometry::NNMap_</a></div><div class="ttdeci">std::map&lt; EcalID, std::vector&lt; EcalID &gt; &gt; NNMap_</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00570">EcalGeometry.h:570</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00552">cell_pos_in_layer_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00452">cellr_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00570">NNMap_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00577">NNNMap_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00519">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="ac16fc26a0b31c6560e4495735fbbcd9e" name="ac16fc26a0b31c6560e4495735fbbcd9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac16fc26a0b31c6560e4495735fbbcd9e">&#9670;&#160;</a></span>debugMake()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classldmx_1_1EcalGeometry.html">EcalGeometry</a> * ldmx::EcalGeometry::debugMake </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classframework_1_1config_1_1Parameters.html">framework::config::Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00302">302</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  302</span>                                                                     {</div>
<div class="line"><span class="lineno">  303</span>    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#ad3712a92b3dfc510a7174a74019199ad">EcalGeometry</a>(p);</div>
<div class="line"><span class="lineno">  304</span>  }</div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_ad3712a92b3dfc510a7174a74019199ad"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#ad3712a92b3dfc510a7174a74019199ad">ldmx::EcalGeometry::EcalGeometry</a></div><div class="ttdeci">EcalGeometry(const framework::config::Parameters &amp;ps)</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry.cxx:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5e05778e09f1caa68658fed875fdd9f6" name="a5e05778e09f1caa68658fed875fdd9f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e05778e09f1caa68658fed875fdd9f6">&#9670;&#160;</a></span>distanceToEdge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::distanceToEdge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Distance to module edge, and whether cell is on edge of module.</p>
<p>@TODO Use <a class="el" href="classldmx_1_1EcalGeometry.html#a06d23452011822d2982b0010cddcd288">getNN()</a>/getNNN() + <a class="el" href="classldmx_1_1EcalGeometry.html#af65f3d6bfad96b72f756447a845e46b0">isEdgeCell()</a> to expand functionality.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellModuleID</td><td>EcalId where all we care about is module and cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>distance to edge of the module </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00581">581</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  581</span>                                                   {</div>
<div class="line"><span class="lineno">  582</span>  <span class="comment">// https://math.stackexchange.com/questions/1210572/find-the-distance-to-the-edge-of-a-hexagon</span></div>
<div class="line"><span class="lineno">  583</span>  std::pair&lt;double, double&gt; cellLocation = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9b81b46a7eb02def2e2b29c251fcd7e6">cell_pos_in_module_</a>.at(<span class="keywordtype">id</span>.cell());</div>
<div class="line"><span class="lineno">  584</span>  <span class="keywordtype">double</span> x = fabs(cellLocation.first);  <span class="comment">// bring to first quadrant</span></div>
<div class="line"><span class="lineno">  585</span>  <span class="keywordtype">double</span> y = fabs(cellLocation.second);</div>
<div class="line"><span class="lineno">  586</span>  <span class="keywordtype">double</span> r = sqrt(x * x + y * y);</div>
<div class="line"><span class="lineno">  587</span>  <span class="keywordtype">double</span> theta = (r &gt; 1E-3) ? fabs(std::atan(y / x)) : 0;</div>
<div class="line"><span class="lineno">  588</span>  <span class="keywordflow">if</span> (x &lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a> / 2.)</div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">return</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a> - y);  <span class="comment">// closest line is straight vertical to top edge</span></div>
<div class="line"><span class="lineno">  590</span>  <span class="keywordtype">double</span> dist =</div>
<div class="line"><span class="lineno">  591</span>      sqrt(3.) * <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a> / (std::sin(theta) + sqrt(3.) * std::cos(theta));</div>
<div class="line"><span class="lineno">  592</span>  <span class="keywordflow">return</span> dist;</div>
<div class="line"><span class="lineno">  593</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00541">cell_pos_in_module_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00455">moduler_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00461">moduleR_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8h_source.html#l00426">isEdgeCell()</a>.</p>

</div>
</div>
<a id="af19dc4bede209d1eb6f29fd3cee7a2a2" name="af19dc4bede209d1eb6f29fd3cee7a2a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af19dc4bede209d1eb6f29fd3cee7a2a2">&#9670;&#160;</a></span>getCellMaxR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::getCellMaxR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the center-to-corner radius of the cell hexagons</p>
<dl class="section return"><dt>Returns</dt><dd>cell max radius [mm] </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00284">284</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  284</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00458">cellR_</a>.</p>

</div>
</div>
<a id="abbc789b7727cd8c917fd244d8b080607" name="abbc789b7727cd8c917fd244d8b080607"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbc789b7727cd8c917fd244d8b080607">&#9670;&#160;</a></span>getCellMinR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::getCellMinR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the center-to-flat radius of the cell hexagons</p>
<dl class="section return"><dt>Returns</dt><dd>cell min radius [mm] </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00277">277</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  277</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a651d592aa54de9287dea72d808cd2554">cellr_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00452">cellr_</a>.</p>

</div>
</div>
<a id="aff5ff59b428b1b678fee58e3c55d70b0" name="aff5ff59b428b1b678fee58e3c55d70b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff5ff59b428b1b678fee58e3c55d70b0">&#9670;&#160;</a></span>getCellPolyMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2Poly * ldmx::EcalGeometry::getCellPolyMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a reference to the TH2Poly used for Cell IDs.</p>
<dl class="section note"><dt>Note</dt><dd>This is only helpful in the use case where you want to print the cell ID &lt;-&gt; cell position map. DO NOT USE THIS OTHERWISE.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to member variable cell_id_in_module_ </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00295">295</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  295</span>                                  { </div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [cell_id, cell_center] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9b81b46a7eb02def2e2b29c251fcd7e6">cell_pos_in_module_</a>) {</div>
<div class="line"><span class="lineno">  297</span>      <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#af0b6afb52e1389b3b12af6f65132d3af">cell_id_in_module_</a>.Fill(cell_center.first, cell_center.second, cell_id);</div>
<div class="line"><span class="lineno">  298</span>    }</div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#af0b6afb52e1389b3b12af6f65132d3af">cell_id_in_module_</a>; </div>
<div class="line"><span class="lineno">  300</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00587">cell_id_in_module_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00541">cell_pos_in_module_</a>.</p>

</div>
</div>
<a id="a67346b26d72f3a7a6200a2c3744c0658" name="a67346b26d72f3a7a6200a2c3744c0658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67346b26d72f3a7a6200a2c3744c0658">&#9670;&#160;</a></span>getID() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a> ldmx::EcalGeometry::getID </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a cell's ID number from its position</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>global x position [mm] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>global y position [mm] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z</td><td>global z position [mm] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> of the cell </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00089">89</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   89</span>                                                             {</div>
<div class="line"><span class="lineno">   90</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> tolerance = 0.5; <span class="comment">// thickness of Si</span></div>
<div class="line"><span class="lineno">   91</span>  <span class="keywordtype">int</span> layer_id{-1};</div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [lid, layer_xyz] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>) {</div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">if</span> (abs(std::get&lt;2&gt;(layer_xyz)-z) &lt; tolerance) {</div>
<div class="line"><span class="lineno">   94</span>      layer_id = lid;</div>
<div class="line"><span class="lineno">   95</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   96</span>    }</div>
<div class="line"><span class="lineno">   97</span>  }</div>
<div class="line"><span class="lineno">   98</span>  <span class="keywordflow">if</span> (layer_id &lt; 0) {</div>
<div class="line"><span class="lineno">   99</span>    EXCEPTION_RAISE(<span class="stringliteral">&quot;BadConf&quot;</span>,</div>
<div class="line"><span class="lineno">  100</span>        <span class="stringliteral">&quot;z = &quot;</span>+std::to_string(z)+<span class="stringliteral">&quot; mm is not within any&quot;</span></div>
<div class="line"><span class="lineno">  101</span>        <span class="stringliteral">&quot; of the configured layers.&quot;</span>);</div>
<div class="line"><span class="lineno">  102</span>  }</div>
<div class="line"><span class="lineno">  103</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#a67346b26d72f3a7a6200a2c3744c0658">getID</a>(x,y,layer_id);</div>
<div class="line"><span class="lineno">  104</span>}</div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a67346b26d72f3a7a6200a2c3744c0658"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a67346b26d72f3a7a6200a2c3744c0658">ldmx::EcalGeometry::getID</a></div><div class="ttdeci">EcalID getID(double x, double y, double z) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00089">EcalGeometry.cxx:89</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8cxx_source.html#l00089">getID()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00525">layer_pos_xy_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00089">getID()</a>.</p>

</div>
</div>
<a id="a2ef95ec5d5f9714b388ba00fd553cd30" name="a2ef95ec5d5f9714b388ba00fd553cd30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ef95ec5d5f9714b388ba00fd553cd30">&#9670;&#160;</a></span>getID() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a> ldmx::EcalGeometry::getID </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layer_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a cell's ID from its x,y global position and layer number</p>
<p>This is faster as long as we trust that the layer positions between GDML and the configured parameters of this class match.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>global x position [mm] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>global y position [mm] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer_id</td><td>integer ID of the layer the hit is in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> of the cell </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00106">106</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>                                                                 {</div>
<div class="line"><span class="lineno">  107</span>  <span class="comment">// now assume we know the layer</span></div>
<div class="line"><span class="lineno">  108</span>  <span class="comment">// shift to center of layer</span></div>
<div class="line"><span class="lineno">  109</span>  <span class="comment">// and convert to flower coordinates</span></div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordtype">double</span> p{x - std::get&lt;0&gt;(<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>.at(layer_id))}, </div>
<div class="line"><span class="lineno">  111</span>         q{y - std::get&lt;1&gt;(<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>.at(layer_id))};</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  <span class="comment">// deduce module ID</span></div>
<div class="line"><span class="lineno">  114</span>  <span class="comment">//    there are only 7 modules so we just loop through them</span></div>
<div class="line"><span class="lineno">  115</span>  <span class="comment">//    all and pick out the module ID that we are inside of</span></div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  <span class="keywordtype">int</span> module_id{-1};</div>
<div class="line"><span class="lineno">  118</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [mid, module_xy] : <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a63cc67f67a5eb89d692304e79562522a">module_pos_xy_</a>) {</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordtype">double</span> probe_x{p-module_xy.first}, probe_y{q-module_xy.second};</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac7e341393af52b14d9ea707c150a7c8e">cornersSideUp_</a>) rotate(probe_x, probe_y);</div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classldmx_1_1EcalGeometry.html#abfecc7c5d3347d34d28c5416e263064f">isInside</a>(probe_x/<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>, probe_y/<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>)) {</div>
<div class="line"><span class="lineno">  122</span>      module_id = mid;</div>
<div class="line"><span class="lineno">  123</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  124</span>    }</div>
<div class="line"><span class="lineno">  125</span>  }</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>  <span class="keywordflow">if</span> (module_id &lt; 0) {</div>
<div class="line"><span class="lineno">  129</span>    EXCEPTION_RAISE(<span class="stringliteral">&quot;BadConf&quot;</span>,</div>
<div class="line"><span class="lineno">  130</span>        TString::Format(<span class="stringliteral">&quot;Coordinates relative to layer (p,q) = (%.2f, %.2f) mm &quot;</span></div>
<div class="line"><span class="lineno">  131</span>          <span class="stringliteral">&quot;derived from world coordinates (%.2f, %.2f) mm with layer = %d &quot;</span></div>
<div class="line"><span class="lineno">  132</span>          <span class="stringliteral">&quot;are not inside any module.&quot;</span>,</div>
<div class="line"><span class="lineno">  133</span>          p,q,x,y,layer_id).Data());</div>
<div class="line"><span class="lineno">  134</span>  }</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#a67346b26d72f3a7a6200a2c3744c0658">getID</a>(x,y,layer_id, module_id);</div>
<div class="line"><span class="lineno">  137</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00467">cornersSideUp_</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00089">getID()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00595">isInside()</a>, <a class="el" href="EcalGeometry_8h_source.html#l00525">layer_pos_xy_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00533">module_pos_xy_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00461">moduleR_</a>.</p>

</div>
</div>
<a id="acd455e8c4463cf687ae1a24e60c9677b" name="acd455e8c4463cf687ae1a24e60c9677b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd455e8c4463cf687ae1a24e60c9677b">&#9670;&#160;</a></span>getID() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a> ldmx::EcalGeometry::getID </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layer_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>module_id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a cell's ID from its x,y global position and layer/module numbers as deduced from GDML copy numbers.</p>
<p>This is the fastest option but we need to carefully validated that the layer and module positions between the GDML and the configured parameters of this class match.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>global x position [mm] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>global y position [mm] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">layer_id</td><td>integer ID of the layer the hit is in </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">module_id</td><td>integer ID of the module the hit is in </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> of the cell </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00139">139</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  139</span>                                                                                {</div>
<div class="line"><span class="lineno">  140</span>  <span class="comment">// now assume we know the layer and module</span></div>
<div class="line"><span class="lineno">  141</span>  <span class="comment">// shift to center of layer and then center of module</span></div>
<div class="line"><span class="lineno">  142</span>  <span class="keywordtype">double</span> p{x - std::get&lt;0&gt;(<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>.at(layer_id)) - <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a63cc67f67a5eb89d692304e79562522a">module_pos_xy_</a>.at(module_id).first}, </div>
<div class="line"><span class="lineno">  143</span>         q{y - std::get&lt;1&gt;(<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>.at(layer_id)) - <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a63cc67f67a5eb89d692304e79562522a">module_pos_xy_</a>.at(module_id).second};</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  <span class="comment">// need to rotate</span></div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac7e341393af52b14d9ea707c150a7c8e">cornersSideUp_</a>) rotate(p,q);</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  <span class="comment">// deduce cell ID</span></div>
<div class="line"><span class="lineno">  149</span>  <span class="keywordtype">int</span> cell_id = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#af0b6afb52e1389b3b12af6f65132d3af">cell_id_in_module_</a>.FindBin(p,q) - 1;</div>
<div class="line"><span class="lineno">  150</span>  </div>
<div class="line"><span class="lineno">  151</span>  <span class="keywordflow">if</span> (cell_id &lt; 0) {</div>
<div class="line"><span class="lineno">  152</span>    EXCEPTION_RAISE(<span class="stringliteral">&quot;BadConf&quot;</span>,</div>
<div class="line"><span class="lineno">  153</span>        TString::Format(<span class="stringliteral">&quot;Relative cell coordinates (%.2f, %.2f) mm &quot;</span></div>
<div class="line"><span class="lineno">  154</span>          <span class="stringliteral">&quot;derived from world coordinates (%.2f, %.2f) mm with layer = %d &quot;</span></div>
<div class="line"><span class="lineno">  155</span>          <span class="stringliteral">&quot;and module = %d are outside module hexagon&quot;</span>,</div>
<div class="line"><span class="lineno">  156</span>          p,q,x,y,layer_id,module_id).Data());</div>
<div class="line"><span class="lineno">  157</span>  }</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  <span class="keywordflow">return</span> EcalID(layer_id,module_id,cell_id);</div>
<div class="line"><span class="lineno">  160</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00587">cell_id_in_module_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00467">cornersSideUp_</a>, <a class="el" href="EcalGeometry_8h_source.html#l00525">layer_pos_xy_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00533">module_pos_xy_</a>.</p>

</div>
</div>
<a id="aa0a2ecb686bcb158f75285e1a04f1bc8" name="aa0a2ecb686bcb158f75285e1a04f1bc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0a2ecb686bcb158f75285e1a04f1bc8">&#9670;&#160;</a></span>getModuleMaxR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::getModuleMaxR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the center-to-corner radius of the module hexagons</p>
<dl class="section return"><dt>Returns</dt><dd>module max radius [mm] </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00270">270</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  270</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ace81f2c5be35e292bf5bb5efdd215cc3">moduleR_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00461">moduleR_</a>.</p>

</div>
</div>
<a id="a255599f9563e9c800dedd271d533c636" name="a255599f9563e9c800dedd271d533c636"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a255599f9563e9c800dedd271d533c636">&#9670;&#160;</a></span>getModuleMinR()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::getModuleMinR </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the center-to-flat radius of the module hexagons</p>
<dl class="section return"><dt>Returns</dt><dd>module min radius [mm] </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00263">263</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  263</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a64c1f3aadb8de68ddd6b5fb510a5dae3">moduler_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00455">moduler_</a>.</p>

</div>
</div>
<a id="a06d23452011822d2982b0010cddcd288" name="a06d23452011822d2982b0010cddcd288"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06d23452011822d2982b0010cddcd288">&#9670;&#160;</a></span>getNN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt; ldmx::EcalGeometry::getNN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the Nearest Neighbors of the input ID</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>id to get </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>list of <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> that are the inputs nearest neighbors </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00211">211</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  211</span>                                           {</div>
<div class="line"><span class="lineno">  212</span>    <span class="keyword">auto</span> list = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#acb99570de6a2dda43ba0c7669e36f1c2">NNMap_</a>.at(EcalID(0, <span class="keywordtype">id</span>.module(), <span class="keywordtype">id</span>.cell()));</div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; flat : list) flat = EcalID(<span class="keywordtype">id</span>.layer(), flat.module(), flat.cell());</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">return</span> list;</div>
<div class="line"><span class="lineno">  215</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00570">NNMap_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8h_source.html#l00224">isNN()</a>.</p>

</div>
</div>
<a id="a9c9d1f0d2116ecdbc83b605fa7a8ff9f" name="a9c9d1f0d2116ecdbc83b605fa7a8ff9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c9d1f0d2116ecdbc83b605fa7a8ff9f">&#9670;&#160;</a></span>getNNN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt; ldmx::EcalGeometry::getNNN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the Next-to-Nearest Neighbors of the input ID</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>id to get </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>list of <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> that are the inputs next-to-nearest neighbors </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00237">237</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  237</span>                                            {</div>
<div class="line"><span class="lineno">  238</span>    <span class="keyword">auto</span> list = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a1a2528207f8b7741ccba242cb8148a0d">NNNMap_</a>.at(EcalID(0, <span class="keywordtype">id</span>.module(), <span class="keywordtype">id</span>.cell()));</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; flat : list) flat = EcalID(<span class="keywordtype">id</span>.layer(), flat.module(), flat.cell());</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">return</span> list;</div>
<div class="line"><span class="lineno">  241</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00577">NNNMap_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8h_source.html#l00251">isNNN()</a>.</p>

</div>
</div>
<a id="a9789643117096e69382f4d1dadba1be3" name="a9789643117096e69382f4d1dadba1be3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9789643117096e69382f4d1dadba1be3">&#9670;&#160;</a></span>getNumCellsPerModule()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ldmx::EcalGeometry::getNumCellsPerModule </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the number of cells in each module of the Ecal Geometry</p>
<dl class="section note"><dt>Note</dt><dd>This assumes that all modules are the full high-density hexagons from CMS (no triangles!) </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00203">203</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  203</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#af0b6afb52e1389b3b12af6f65132d3af">cell_id_in_module_</a>.GetNumberOfBins(); }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00587">cell_id_in_module_</a>.</p>

</div>
</div>
<a id="a3e9decbb719af7763ba0fdc134dfce0c" name="a3e9decbb719af7763ba0fdc134dfce0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e9decbb719af7763ba0fdc134dfce0c">&#9670;&#160;</a></span>getNumLayers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ldmx::EcalGeometry::getNumLayers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the number of layers in the Ecal Geometry</p>
<dl class="section return"><dt>Returns</dt><dd>number fo layers in geometry </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00181">181</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  181</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>.size(); }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00525">layer_pos_xy_</a>.</p>

</div>
</div>
<a id="a721f67332ad0e39e283f9a714293e828" name="a721f67332ad0e39e283f9a714293e828"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a721f67332ad0e39e283f9a714293e828">&#9670;&#160;</a></span>getNumModulesPerLayer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ldmx::EcalGeometry::getNumModulesPerLayer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the number of modules in the Ecal flower</p>
<dl class="section note"><dt>Note</dt><dd>This number is hard-coded to reflect the fact that it is also hard-coded in the buildModuleMap function. If a future geometry adds more modules (perhaps "triangles" to fill in rectangular block in the HCal that the ECal is in), then buildModuleMap and this function will need to be modified.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>number of modules </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00195">195</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  195</span>{ <span class="keywordflow">return</span> 7; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a293431561edfdc3d0f123edbdbbe4237" name="a293431561edfdc3d0f123edbdbbe4237"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a293431561edfdc3d0f123edbdbbe4237">&#9670;&#160;</a></span>getPosition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::tuple&lt; double, double, double &gt; ldmx::EcalGeometry::getPosition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a cell's position from its ID number</p>
<p>std::tuple is useful here because you can use C++17's pattern matching to use code like the following </p><div class="fragment"><div class="line"><span class="keyword">auto</span> [x,y,z] = geometry.getPosition(<span class="keywordtype">id</span>);</div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00163">163</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  163</span>                                                                        {</div>
<div class="line"><span class="lineno">  164</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac96c88b8b17197cff1fa43f607edd282">cell_global_pos_</a>.at(<span class="keywordtype">id</span>);</div>
<div class="line"><span class="lineno">  165</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00563">cell_global_pos_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalTriggerGeometry_8cxx_source.html#l00133">ecal::EcalTriggerGeometry::globalPosition()</a>, <a class="el" href="DNNEcalVetoProcessor_8cxx_source.html#l00075">ecal::DNNEcalVetoProcessor::make_inputs()</a>, and <a class="el" href="EcalVetoProcessor_8cxx_source.html#l00192">ecal::EcalVetoProcessor::produce()</a>.</p>

</div>
</div>
<a id="a5efc315947914bec346c25f1c4bf8f3b" name="a5efc315947914bec346c25f1c4bf8f3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5efc315947914bec346c25f1c4bf8f3b">&#9670;&#160;</a></span>getPositionInModule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; double, double &gt; ldmx::EcalGeometry::getPositionInModule </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cell_id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get a cell's position within a module </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00167">167</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  167</span>                                                                          {</div>
<div class="line"><span class="lineno">  168</span>  <span class="keyword">auto</span> pq = <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9b81b46a7eb02def2e2b29c251fcd7e6">cell_pos_in_module_</a>.at(cell_id);</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>  <span class="comment">// going from (p,q) to (x,y) is a unrotate</span></div>
<div class="line"><span class="lineno">  171</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ac7e341393af52b14d9ea707c150a7c8e">cornersSideUp_</a>) unrotate(pq.first, pq.second);</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  <span class="keywordflow">return</span> pq;</div>
<div class="line"><span class="lineno">  174</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00541">cell_pos_in_module_</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00467">cornersSideUp_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalTriggerGeometry_8cxx_source.html#l00140">ecal::EcalTriggerGeometry::localPosition()</a>.</p>

</div>
</div>
<a id="a4427ab0f7f6c4a8e72c71981c3bd132d" name="a4427ab0f7f6c4a8e72c71981c3bd132d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4427ab0f7f6c4a8e72c71981c3bd132d">&#9670;&#160;</a></span>getZPosition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::getZPosition </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layer</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the z-coordinate given the layer id</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>int layer id </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>z-coordinate of the input sensitive layer </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00172">172</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  172</span>                                       {</div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">return</span> std::get&lt;2&gt;(<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#aabb9051d9ec229d7854c231c648236bb">layer_pos_xy_</a>.at(layer));</div>
<div class="line"><span class="lineno">  174</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00525">layer_pos_xy_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalVetoProcessor_8cxx_source.html#l00192">ecal::EcalVetoProcessor::produce()</a>.</p>

</div>
</div>
<a id="af65f3d6bfad96b72f756447a845e46b0" name="af65f3d6bfad96b72f756447a845e46b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af65f3d6bfad96b72f756447a845e46b0">&#9670;&#160;</a></span>isEdgeCell()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalGeometry::isEdgeCell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>cellModuleID</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if input cell is on the edge of a module.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classldmx_1_1EcalGeometry.html#a5e05778e09f1caa68658fed875fdd9f6">distanceToEdge</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellModuleID</td><td>EcalId where all we care about is module and cell return true if distance to edge is less than max cell radius </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00426">426</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  426</span>                                             {</div>
<div class="line"><span class="lineno">  427</span>    <span class="keywordflow">return</span> (<a class="code hl_function" href="classldmx_1_1EcalGeometry.html#a5e05778e09f1caa68658fed875fdd9f6">distanceToEdge</a>(cellModuleID) &lt; <a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#a9e8b261449b90ba1de53ae5257973452">cellR_</a>);</div>
<div class="line"><span class="lineno">  428</span>  }</div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a5e05778e09f1caa68658fed875fdd9f6"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a5e05778e09f1caa68658fed875fdd9f6">ldmx::EcalGeometry::distanceToEdge</a></div><div class="ttdeci">double distanceToEdge(EcalID id) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8cxx_source.html#l00581">EcalGeometry.cxx:581</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00458">cellR_</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00581">distanceToEdge()</a>.</p>

</div>
</div>
<a id="abfecc7c5d3347d34d28c5416e263064f" name="abfecc7c5d3347d34d28c5416e263064f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfecc7c5d3347d34d28c5416e263064f">&#9670;&#160;</a></span>isInside()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalGeometry::isInside </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>normX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>normY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Determines if point (x,y), already normed to max hexagon radius, lies within a hexagon. Corners are (1,0) and (0.5,sqrt(3)/2). Uses "&lt;", not "&lt;=".</p>
<dl class="section note"><dt>Note</dt><dd>This function is in p,q space so any rotations need to be performed before calling this function.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">normX</td><td>X-coordinate relative to module hexagon divided by maximum hexagon radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">normY</td><td>Y-coordinate relative to module hexagon divided by maximum hexagon radius </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if (normX,normY) is within the hexagon centered at the origin with maximum radius 1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8cxx_source.html#l00595">595</a> of file <a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  595</span>                                                            {</div>
<div class="line"><span class="lineno">  596</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2)</div>
<div class="line"><span class="lineno">  597</span>    std::cout &lt;&lt; TString::Format(</div>
<div class="line"><span class="lineno">  598</span>                     <span class="stringliteral">&quot;[isInside] Checking if normXY=(%.2f,%.2f) is inside.&quot;</span>,</div>
<div class="line"><span class="lineno">  599</span>                     normX, normY)</div>
<div class="line"><span class="lineno">  600</span>              &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  601</span>  normX = fabs(normX), normY = fabs(normY);</div>
<div class="line"><span class="lineno">  602</span>  <span class="keywordtype">double</span> xvec = -1, yvec = -1. / sqrt(3);</div>
<div class="line"><span class="lineno">  603</span>  <span class="keywordtype">double</span> xref = 0.5, yref = sqrt(3) / 2.;</div>
<div class="line"><span class="lineno">  604</span>  <span class="keywordflow">if</span> ((normX &gt; 1.) || (normY &gt; yref)) {</div>
<div class="line"><span class="lineno">  605</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2)</div>
<div class="line"><span class="lineno">  606</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;[isInside]   they are outside quadrant.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  607</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  608</span>  }</div>
<div class="line"><span class="lineno">  609</span>  <span class="keywordtype">double</span> dotProd = (xvec * (normX - xref) + yvec * (normY - yref));</div>
<div class="line"><span class="lineno">  610</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classldmx_1_1EcalGeometry.html#ab93f50a312f15fff892f3cb2a794deb7">verbose_</a> &gt; 2)</div>
<div class="line"><span class="lineno">  611</span>    std::cout &lt;&lt; TString::Format(</div>
<div class="line"><span class="lineno">  612</span>                     <span class="stringliteral">&quot;[isInside] they are inside quadrant. Dot product (&gt;0 is &quot;</span></div>
<div class="line"><span class="lineno">  613</span>                     <span class="stringliteral">&quot;inside): %.2f &quot;</span>,</div>
<div class="line"><span class="lineno">  614</span>                     dotProd)</div>
<div class="line"><span class="lineno">  615</span>              &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  616</span>  <span class="keywordflow">return</span> (dotProd &gt; 0.);</div>
<div class="line"><span class="lineno">  617</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00519">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00106">getID()</a>.</p>

</div>
</div>
<a id="af12a764d4675dabd5c0790bd065a0d75" name="af12a764d4675dabd5c0790bd065a0d75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af12a764d4675dabd5c0790bd065a0d75">&#9670;&#160;</a></span>isNN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalGeometry::isNN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>centroid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>probe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if the probe id is one of the nearest neightbors of the centroid id</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">probe</td><td>id to check if it is nearest neighbor </td></tr>
    <tr><td class="paramname">centroid</td><td>id that is center of neighbors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if probe ID is a nearest neighbor of the centroid </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00224">224</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  224</span>                                                 {</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <span class="keywordtype">id</span> : <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#a06d23452011822d2982b0010cddcd288">getNN</a>(centroid)) {</div>
<div class="line"><span class="lineno">  226</span>      <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == probe) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  227</span>    }</div>
<div class="line"><span class="lineno">  228</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  229</span>  }</div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a06d23452011822d2982b0010cddcd288"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a06d23452011822d2982b0010cddcd288">ldmx::EcalGeometry::getNN</a></div><div class="ttdeci">std::vector&lt; EcalID &gt; getNN(EcalID id) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00211">EcalGeometry.h:211</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00211">getNN()</a>.</p>

</div>
</div>
<a id="ab3d852aebced255c7d2b940eef88a24e" name="ab3d852aebced255c7d2b940eef88a24e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3d852aebced255c7d2b940eef88a24e">&#9670;&#160;</a></span>isNNN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalGeometry::isNNN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>centroid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>probe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if the probe id is one of the next-to-nearest neightbors of the centroid id</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">probe</td><td>id to check if it is a next-to-nearest neighbor </td></tr>
    <tr><td class="paramname">centroid</td><td>id that is center of neighbors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if probe ID is a next-to-nearest neighbor of the centroid </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00251">251</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  251</span>                                                  {</div>
<div class="line"><span class="lineno">  252</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; <span class="keywordtype">id</span> : <a class="code hl_function" href="classldmx_1_1EcalGeometry.html#a9c9d1f0d2116ecdbc83b605fa7a8ff9f">getNNN</a>(centroid)) {</div>
<div class="line"><span class="lineno">  253</span>      <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == probe) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  254</span>    }</div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  256</span>  }</div>
<div class="ttc" id="aclassldmx_1_1EcalGeometry_html_a9c9d1f0d2116ecdbc83b605fa7a8ff9f"><div class="ttname"><a href="classldmx_1_1EcalGeometry.html#a9c9d1f0d2116ecdbc83b605fa7a8ff9f">ldmx::EcalGeometry::getNNN</a></div><div class="ttdeci">std::vector&lt; EcalID &gt; getNNN(EcalID id) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalGeometry_8h_source.html#l00237">EcalGeometry.h:237</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalGeometry_8h_source.html#l00237">getNNN()</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a id="a3fd818642a78fd5349c18c901426f594" name="a3fd818642a78fd5349c18c901426f594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fd818642a78fd5349c18c901426f594">&#9670;&#160;</a></span>ecal::EcalGeometryProvider</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classecal_1_1EcalGeometryProvider.html">ecal::EcalGeometryProvider</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00313">313</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ac96c88b8b17197cff1fa43f607edd282" name="ac96c88b8b17197cff1fa43f607edd282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac96c88b8b17197cff1fa43f607edd282">&#9670;&#160;</a></span>cell_global_pos_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::tuple&lt;double,double, double&gt; &gt; ldmx::EcalGeometry::cell_global_pos_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Position of cell centers relative to world geometry</p>
<p>This is where we convert p,q (flower) space into x,y (world) space by calculating the z-location as well as including rotations and shifts when converting from p,q to x,y.</p>
<p>The key is the full <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> and the value is the x,y,z tuple. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00563">563</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00464">buildCellModuleMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00163">getPosition()</a>.</p>

</div>
</div>
<a id="af0b6afb52e1389b3b12af6f65132d3af" name="af0b6afb52e1389b3b12af6f65132d3af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0b6afb52e1389b3b12af6f65132d3af">&#9670;&#160;</a></span>cell_id_in_module_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2Poly ldmx::EcalGeometry::cell_id_in_module_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Honeycomb Binning from ROOT</p>
<p>Needs to be mutable because ROOT doesn't have good const handling</p>
<p>Lookup a cell ID using its position relative to the center of the module in p,q space. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00587">587</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, <a class="el" href="EcalGeometry_8h_source.html#l00295">getCellPolyMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00139">getID()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00203">getNumCellsPerModule()</a>.</p>

</div>
</div>
<a id="a82580d37173279b7b826c851f2f1e964" name="a82580d37173279b7b826c851f2f1e964"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82580d37173279b7b826c851f2f1e964">&#9670;&#160;</a></span>cell_pos_in_layer_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::pair&lt;double,double&gt; &gt; ldmx::EcalGeometry::cell_pos_in_layer_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Position of cell centers relative to center of layer in world coordinates.</p>
<dl class="section note"><dt>Note</dt><dd>Layer shifts are NOT included in this map since they depend on the layer number!!</dd></dl>
<p>Uses <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> with layer set to zero as key. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00552">552</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00464">buildCellModuleMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00508">buildNeighborMaps()</a>.</p>

</div>
</div>
<a id="a9b81b46a7eb02def2e2b29c251fcd7e6" name="a9b81b46a7eb02def2e2b29c251fcd7e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b81b46a7eb02def2e2b29c251fcd7e6">&#9670;&#160;</a></span>cell_pos_in_module_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;int, std::pair&lt;double, double&gt; &gt; ldmx::EcalGeometry::cell_pos_in_module_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Position of cell centers relative to center of module in p,q space.</p>
<p>use cell ID as key </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00541">541</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00464">buildCellModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00581">distanceToEdge()</a>, <a class="el" href="EcalGeometry_8h_source.html#l00295">getCellPolyMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00167">getPositionInModule()</a>.</p>

</div>
</div>
<a id="a651d592aa54de9287dea72d808cd2554" name="a651d592aa54de9287dea72d808cd2554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a651d592aa54de9287dea72d808cd2554">&#9670;&#160;</a></span>cellr_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::cellr_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Center-to-Flat Radius of cell hexagon [mm]. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00452">452</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00508">buildNeighborMaps()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00277">getCellMinR()</a>.</p>

</div>
</div>
<a id="a9e8b261449b90ba1de53ae5257973452" name="a9e8b261449b90ba1de53ae5257973452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e8b261449b90ba1de53ae5257973452">&#9670;&#160;</a></span>cellR_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::cellR_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Center-to-Corner Radius of cell hexagon [mm]. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00458">458</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>, <a class="el" href="EcalGeometry_8h_source.html#l00284">getCellMaxR()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00426">isEdgeCell()</a>.</p>

</div>
</div>
<a id="a0b5fbaba75a1407685b51a67a3ed76f5" name="a0b5fbaba75a1407685b51a67a3ed76f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b5fbaba75a1407685b51a67a3ed76f5">&#9670;&#160;</a></span>CONDITIONS_OBJECT_NAME</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr const char* ldmx::EcalGeometry::CONDITIONS_OBJECT_NAME {&quot;EcalGeometry&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00101">101</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

</div>
</div>
<a id="ac7e341393af52b14d9ea707c150a7c8e" name="ac7e341393af52b14d9ea707c150a7c8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7e341393af52b14d9ea707c150a7c8e">&#9670;&#160;</a></span>cornersSideUp_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalGeometry::cornersSideUp_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>indicator of geometry orientation if true, flower shape's corners side (ie: side with two modules) is at the top </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00467">467</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00464">buildCellModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00211">buildModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00106">getID()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00167">getPositionInModule()</a>.</p>

</div>
</div>
<a id="a99875f644f9d9a3ff168285327d4b317" name="a99875f644f9d9a3ff168285327d4b317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99875f644f9d9a3ff168285327d4b317">&#9670;&#160;</a></span>ecalFrontZ_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::ecalFrontZ_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Front of ECal relative to world geometry [mm]. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00512">512</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="ae06623889182fa0846e434bde609c095" name="ae06623889182fa0846e434bde609c095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06623889182fa0846e434bde609c095">&#9670;&#160;</a></span>gap_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::gap_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gap between module flat sides [mm]. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00449">449</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00211">buildModuleMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="aabb9051d9ec229d7854c231c648236bb" name="aabb9051d9ec229d7854c231c648236bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabb9051d9ec229d7854c231c648236bb">&#9670;&#160;</a></span>layer_pos_xy_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;int, std::tuple&lt;double,double,double&gt; &gt; ldmx::EcalGeometry::layer_pos_xy_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Position of layer centers in world coordinates (uses layer ID as key) </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00525">525</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00464">buildCellModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00089">getID()</a>, <a class="el" href="EcalGeometry_8h_source.html#l00181">getNumLayers()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00172">getZPosition()</a>.</p>

</div>
</div>
<a id="a6e606e7607d19ba4c9f7b5456d8332a3" name="a6e606e7607d19ba4c9f7b5456d8332a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e606e7607d19ba4c9f7b5456d8332a3">&#9670;&#160;</a></span>layer_shift_odd_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalGeometry::layer_shift_odd_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>shift odd layers</p>
<p>odd layers are the high-z layer in each bi-layer</p>
<p>i.e. We will shift if layer_id_ % 2 == 1 </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00486">486</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="ac468282de94b62e9283a267e69f498f6" name="ac468282de94b62e9283a267e69f498f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac468282de94b62e9283a267e69f498f6">&#9670;&#160;</a></span>layer_shift_odd_bilayer_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalGeometry::layer_shift_odd_bilayer_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>shift odd bi layers</p>
<p>NOT IMPLEMENTED IN GDML</p>
<p>This shifts the bi-layer grouping of two sensitive layers together.</p>
<p>i.e. We will shift if (layer_id_ / 2) % 2 == 1</p>
<p>where it is integer division. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00500">500</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="a9bb0a11ac0e11f34a5932ad3f60523ab" name="a9bb0a11ac0e11f34a5932ad3f60523ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bb0a11ac0e11f34a5932ad3f60523ab">&#9670;&#160;</a></span>layer_shift_x_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::layer_shift_x_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>shift of layers in the x-direction [mm] </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00472">472</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="a589e6fc3e502ae2eac4582cf5a2948bb" name="a589e6fc3e502ae2eac4582cf5a2948bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a589e6fc3e502ae2eac4582cf5a2948bb">&#9670;&#160;</a></span>layer_shift_y_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::layer_shift_y_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>shift of layers in the y-direction [mm] </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00477">477</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="a795e0ce16e97da42682ab441975898ba" name="a795e0ce16e97da42682ab441975898ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a795e0ce16e97da42682ab441975898ba">&#9670;&#160;</a></span>layerZPositions_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;double&gt; ldmx::EcalGeometry::layerZPositions_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The layer Z postions are with respect to the front of the ECal [mm]. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00515">515</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="a63cc67f67a5eb89d692304e79562522a" name="a63cc67f67a5eb89d692304e79562522a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63cc67f67a5eb89d692304e79562522a">&#9670;&#160;</a></span>module_pos_xy_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;int, std::pair&lt;double, double&gt; &gt; ldmx::EcalGeometry::module_pos_xy_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Postion of module centers relative to the center of the layer in world coordinates</p>
<p>(uses module ID as key) </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00533">533</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00464">buildCellModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00211">buildModuleMap()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00106">getID()</a>.</p>

</div>
</div>
<a id="a64c1f3aadb8de68ddd6b5fb510a5dae3" name="a64c1f3aadb8de68ddd6b5fb510a5dae3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64c1f3aadb8de68ddd6b5fb510a5dae3">&#9670;&#160;</a></span>moduler_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::moduler_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Center-to-Flat Radius of module hexagon [mm]. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00455">455</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00211">buildModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00581">distanceToEdge()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00263">getModuleMinR()</a>.</p>

</div>
</div>
<a id="ace81f2c5be35e292bf5bb5efdd215cc3" name="ace81f2c5be35e292bf5bb5efdd215cc3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace81f2c5be35e292bf5bb5efdd215cc3">&#9670;&#160;</a></span>moduleR_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::moduleR_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Center-to-Corner Radius of module hexagon [mm]. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00461">461</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00581">distanceToEdge()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00106">getID()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00270">getModuleMaxR()</a>.</p>

</div>
</div>
<a id="a84e72c2f81aa3f1cca68fa7fd6d6e246" name="a84e72c2f81aa3f1cca68fa7fd6d6e246"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84e72c2f81aa3f1cca68fa7fd6d6e246">&#9670;&#160;</a></span>nCellRHeight_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalGeometry::nCellRHeight_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of cell center-to-corner radii (one side of the cell) from the bottom to the top of the module</p>
<p>Could be fractional depending on how many fractions of a radii are spanning between the center of the top/bottom cell row and the edge of the module </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00509">509</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>.</p>

</div>
</div>
<a id="acb99570de6a2dda43ba0c7669e36f1c2" name="acb99570de6a2dda43ba0c7669e36f1c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb99570de6a2dda43ba0c7669e36f1c2">&#9670;&#160;</a></span>NNMap_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::vector&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&gt; &gt; ldmx::EcalGeometry::NNMap_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map of cell ID to neighboring cells</p>
<p>The <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a>'s in this map all have layer ID set to zero. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00570">570</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00508">buildNeighborMaps()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00211">getNN()</a>.</p>

</div>
</div>
<a id="a1a2528207f8b7741ccba242cb8148a0d" name="a1a2528207f8b7741ccba242cb8148a0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a2528207f8b7741ccba242cb8148a0d">&#9670;&#160;</a></span>NNNMap_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::vector&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&gt; &gt; ldmx::EcalGeometry::NNNMap_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map of cell ID to neighbors of neighbor cells</p>
<p>The <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a>'s in this map all have layer ID set to zero. </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00577">577</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00508">buildNeighborMaps()</a>, and <a class="el" href="EcalGeometry_8h_source.html#l00237">getNNN()</a>.</p>

</div>
</div>
<a id="ab93f50a312f15fff892f3cb2a794deb7" name="ab93f50a312f15fff892f3cb2a794deb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab93f50a312f15fff892f3cb2a794deb7">&#9670;&#160;</a></span>verbose_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ldmx::EcalGeometry::verbose_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>verbosity </p>

<p class="definition">Definition at line <a class="el" href="EcalGeometry_8h_source.html#l00519">519</a> of file <a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalGeometry_8cxx_source.html#l00244">buildCellMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00464">buildCellModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00176">buildLayerMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00211">buildModuleMap()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00508">buildNeighborMaps()</a>, <a class="el" href="EcalGeometry_8cxx_source.html#l00047">EcalGeometry()</a>, and <a class="el" href="EcalGeometry_8cxx_source.html#l00595">isInside()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>DetDescr/include/DetDescr/<a class="el" href="EcalGeometry_8h_source.html">EcalGeometry.h</a></li>
<li>DetDescr/src/DetDescr/<a class="el" href="EcalGeometry_8cxx_source.html">EcalGeometry.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>