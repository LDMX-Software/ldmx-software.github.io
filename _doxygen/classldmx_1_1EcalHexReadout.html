<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.19"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: ldmx::EcalHexReadout Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceldmx.html">ldmx</a></li><li class="navelem"><a class="el" href="classldmx_1_1EcalHexReadout.html">EcalHexReadout</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classldmx_1_1EcalHexReadout-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ldmx::EcalHexReadout Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation of ECal hexagonal cell readout.  
 <a href="classldmx_1_1EcalHexReadout.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac3e0433bb3af65620929cc881ed110eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#ac3e0433bb3af65620929cc881ed110eb">EcalHexReadout</a> (const <a class="el" href="classldmx_1_1Parameters.html">Parameters</a> &amp;ps)</td></tr>
<tr class="separator:ac3e0433bb3af65620929cc881ed110eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2f2a9f43fbc3e02dee49ce92b4a2da0"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#aa2f2a9f43fbc3e02dee49ce92b4a2da0">~EcalHexReadout</a> ()</td></tr>
<tr class="separator:aa2f2a9f43fbc3e02dee49ce92b4a2da0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e179626757c116ccc8dc85e825fbf66"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a9e179626757c116ccc8dc85e825fbf66">getCellAbsolutePosition</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> id, double &amp;x, double &amp;y, double &amp;z) const</td></tr>
<tr class="separator:a9e179626757c116ccc8dc85e825fbf66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53eb62b5d96ad24072aff1a1752e0bad"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a53eb62b5d96ad24072aff1a1752e0bad">getZPosition</a> (int layer) const</td></tr>
<tr class="separator:a53eb62b5d96ad24072aff1a1752e0bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c26f03d3d7029a3aace3745b9ef1ab6"><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a4c26f03d3d7029a3aace3745b9ef1ab6">getModuleCenter</a> (int moduleID) const</td></tr>
<tr class="separator:a4c26f03d3d7029a3aace3745b9ef1ab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b455834faccba33f2a2235b9888c81"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#ab5b455834faccba33f2a2235b9888c81">getModuleID</a> (double x, double y) const</td></tr>
<tr class="separator:ab5b455834faccba33f2a2235b9888c81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b24c37eeb6ad660963022e4758b92c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a1b24c37eeb6ad660963022e4758b92c5">getCellIDRelative</a> (double x, double y) const</td></tr>
<tr class="separator:a1b24c37eeb6ad660963022e4758b92c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a523f77a4dad9737cf2679d2994b748c6"><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a523f77a4dad9737cf2679d2994b748c6">getCellCenterRelative</a> (int cellID) const</td></tr>
<tr class="separator:a523f77a4dad9737cf2679d2994b748c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5293b7b33e0eea806b797069a7ca1ffb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a5293b7b33e0eea806b797069a7ca1ffb">getCellModuleID</a> (double x, double y) const</td></tr>
<tr class="separator:a5293b7b33e0eea806b797069a7ca1ffb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f2b9f3ed6994ffb2716ad5d15ed9e67"><td class="memItemLeft" align="right" valign="top">std::pair&lt; double, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a1f2b9f3ed6994ffb2716ad5d15ed9e67">getCellCenterAbsolute</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> cellModuleID) const</td></tr>
<tr class="separator:a1f2b9f3ed6994ffb2716ad5d15ed9e67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba0999d9c878a1ac5746d1b1f8cd7856"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#aba0999d9c878a1ac5746d1b1f8cd7856">distanceToEdge</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> cellModuleID) const</td></tr>
<tr class="separator:aba0999d9c878a1ac5746d1b1f8cd7856"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ae3be71cc7980920b64eccf59b0c27d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a7ae3be71cc7980920b64eccf59b0c27d">isEdgeCell</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> cellModuleID) const</td></tr>
<tr class="separator:a7ae3be71cc7980920b64eccf59b0c27d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d22369c3704814a3c52667b1373bbe8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a9d22369c3704814a3c52667b1373bbe8">isInside</a> (double normX, double normY) const</td></tr>
<tr class="separator:a9d22369c3704814a3c52667b1373bbe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2825ec01b21a6f697bf03c3d98fb304a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a2825ec01b21a6f697bf03c3d98fb304a">getNN</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> id) const</td></tr>
<tr class="separator:a2825ec01b21a6f697bf03c3d98fb304a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d10081ac0818753db568097c765a4d8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a1d10081ac0818753db568097c765a4d8">isNN</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> centroid, <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> probe) const</td></tr>
<tr class="separator:a1d10081ac0818753db568097c765a4d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b8d8ccd4c0f4253a6c70aba413b1b27"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a4b8d8ccd4c0f4253a6c70aba413b1b27">getNNN</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> id) const</td></tr>
<tr class="separator:a4b8d8ccd4c0f4253a6c70aba413b1b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21bde7564d75c3b1b2fb83ffdf5ac1cd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a21bde7564d75c3b1b2fb83ffdf5ac1cd">isNNN</a> (<a class="el" href="classldmx_1_1EcalID.html">EcalID</a> centroid, <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> probe) const</td></tr>
<tr class="separator:a21bde7564d75c3b1b2fb83ffdf5ac1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae75265eb71219cc63ea25fb6b4081180"><td class="memItemLeft" align="right" valign="top">const std::map&lt; int, std::pair&lt; double, double &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#ae75265eb71219cc63ea25fb6b4081180">getCellPositionMap</a> () const</td></tr>
<tr class="separator:ae75265eb71219cc63ea25fb6b4081180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5fc46d98284ea1d0f370b8b4f9a216f"><td class="memItemLeft" align="right" valign="top">const std::map&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::pair&lt; double, double &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#ad5fc46d98284ea1d0f370b8b4f9a216f">getCellModulePositionMap</a> () const</td></tr>
<tr class="separator:ad5fc46d98284ea1d0f370b8b4f9a216f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a7054d9c8f5a227daf3ee4b0557edb7"><td class="memItemLeft" align="right" valign="top">TH2Poly *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a8a7054d9c8f5a227daf3ee4b0557edb7">getCellPolyMap</a> () const</td></tr>
<tr class="separator:a8a7054d9c8f5a227daf3ee4b0557edb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a05e3dc7a3e36411474327cc877cb0079"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a05e3dc7a3e36411474327cc877cb0079">buildModuleMap</a> ()</td></tr>
<tr class="separator:a05e3dc7a3e36411474327cc877cb0079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab42dd6bfd06539ace4bedfa6e5c6bfad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#ab42dd6bfd06539ace4bedfa6e5c6bfad">buildCellMap</a> ()</td></tr>
<tr class="separator:ab42dd6bfd06539ace4bedfa6e5c6bfad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a201ec824d6806ff70bdb716cc42cc70e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a201ec824d6806ff70bdb716cc42cc70e">buildCellModuleMap</a> ()</td></tr>
<tr class="separator:a201ec824d6806ff70bdb716cc42cc70e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4aeb2b9831ad98110e4984f2c6f766b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#ac4aeb2b9831ad98110e4984f2c6f766b">buildNeighborMaps</a> ()</td></tr>
<tr class="separator:ac4aeb2b9831ad98110e4984f2c6f766b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f0f75f6681b73e09cee4268710c55a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a7f0f75f6681b73e09cee4268710c55a5">buildTriggerGroup</a> ()</td></tr>
<tr class="separator:a7f0f75f6681b73e09cee4268710c55a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aeac683d8c4aa534f55488f2dbff4d511"><td class="memItemLeft" align="right" valign="top"><a id="aeac683d8c4aa534f55488f2dbff4d511"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a> {2}</td></tr>
<tr class="memdesc:aeac683d8c4aa534f55488f2dbff4d511"><td class="mdescLeft">&#160;</td><td class="mdescRight">verbosity, not configurable but helpful if developing <br /></td></tr>
<tr class="separator:aeac683d8c4aa534f55488f2dbff4d511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8283a781129c83d72b4b05b411b4906"><td class="memItemLeft" align="right" valign="top"><a id="aa8283a781129c83d72b4b05b411b4906"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#aa8283a781129c83d72b4b05b411b4906">gap_</a></td></tr>
<tr class="memdesc:aa8283a781129c83d72b4b05b411b4906"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gap between module flat sides [mm]. <br /></td></tr>
<tr class="separator:aa8283a781129c83d72b4b05b411b4906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa411a6f3c759da91bd9ddda4ba1decb9"><td class="memItemLeft" align="right" valign="top"><a id="aa411a6f3c759da91bd9ddda4ba1decb9"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a> {0}</td></tr>
<tr class="memdesc:aa411a6f3c759da91bd9ddda4ba1decb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Center-to-Flat Radius of cell hexagon [mm]. <br /></td></tr>
<tr class="separator:aa411a6f3c759da91bd9ddda4ba1decb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe8818450ac613540a84aca91c808fe8"><td class="memItemLeft" align="right" valign="top"><a id="abe8818450ac613540a84aca91c808fe8"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a> {0}</td></tr>
<tr class="memdesc:abe8818450ac613540a84aca91c808fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Center-to-Flat Radius of module hexagon [mm]. <br /></td></tr>
<tr class="separator:abe8818450ac613540a84aca91c808fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1481095039b9283d620827b825ca06b1"><td class="memItemLeft" align="right" valign="top"><a id="a1481095039b9283d620827b825ca06b1"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a> {0}</td></tr>
<tr class="memdesc:a1481095039b9283d620827b825ca06b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Center-to-Corner Radius of cell hexagon [mm]. <br /></td></tr>
<tr class="separator:a1481095039b9283d620827b825ca06b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbf95653cded8772299056d5ea557105"><td class="memItemLeft" align="right" valign="top"><a id="acbf95653cded8772299056d5ea557105"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a> {0}</td></tr>
<tr class="memdesc:acbf95653cded8772299056d5ea557105"><td class="mdescLeft">&#160;</td><td class="mdescRight">Center-to-Corner Radius of module hexagon [mm]. <br /></td></tr>
<tr class="separator:acbf95653cded8772299056d5ea557105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bbd845808c2836b6c1530c12b4e0fa4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a1bbd845808c2836b6c1530c12b4e0fa4">nCellRHeight_</a> {0}</td></tr>
<tr class="separator:a1bbd845808c2836b6c1530c12b4e0fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d6cf2d6aa9ed38913936445e031fa0a"><td class="memItemLeft" align="right" valign="top"><a id="a3d6cf2d6aa9ed38913936445e031fa0a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a3d6cf2d6aa9ed38913936445e031fa0a">ecalFrontZ_</a> {0}</td></tr>
<tr class="memdesc:a3d6cf2d6aa9ed38913936445e031fa0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Front of ECal relative to world geometry [mm]. <br /></td></tr>
<tr class="separator:a3d6cf2d6aa9ed38913936445e031fa0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabdd321c511fa6728a4d22a376eeae14"><td class="memItemLeft" align="right" valign="top"><a id="aabdd321c511fa6728a4d22a376eeae14"></a>
std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#aabdd321c511fa6728a4d22a376eeae14">layerZPositions_</a></td></tr>
<tr class="memdesc:aabdd321c511fa6728a4d22a376eeae14"><td class="mdescLeft">&#160;</td><td class="mdescRight">The layer Z postions are with respect to the front of the ECal [mm]. <br /></td></tr>
<tr class="separator:aabdd321c511fa6728a4d22a376eeae14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6982db29300d9015cc04a7cbda3986c"><td class="memItemLeft" align="right" valign="top"><a id="af6982db29300d9015cc04a7cbda3986c"></a>
std::map&lt; int, std::pair&lt; double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">modulePositionMap_</a></td></tr>
<tr class="memdesc:af6982db29300d9015cc04a7cbda3986c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Postion of module centers relative to world geometry (uses module ID as key) <br /></td></tr>
<tr class="separator:af6982db29300d9015cc04a7cbda3986c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ca64659ba36e91c8c214d2b6bbdaba"><td class="memItemLeft" align="right" valign="top"><a id="a93ca64659ba36e91c8c214d2b6bbdaba"></a>
std::map&lt; int, std::pair&lt; double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a93ca64659ba36e91c8c214d2b6bbdaba">cellPositionMap_</a></td></tr>
<tr class="memdesc:a93ca64659ba36e91c8c214d2b6bbdaba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Position of cell centers relative to module (uses cell ID as key) <br /></td></tr>
<tr class="separator:a93ca64659ba36e91c8c214d2b6bbdaba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3bd1214a3836bc6a8e8fe4547e0fc8d"><td class="memItemLeft" align="right" valign="top"><a id="ad3bd1214a3836bc6a8e8fe4547e0fc8d"></a>
std::map&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::pair&lt; double, double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#ad3bd1214a3836bc6a8e8fe4547e0fc8d">cellModulePositionMap_</a></td></tr>
<tr class="memdesc:ad3bd1214a3836bc6a8e8fe4547e0fc8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Position of cell centers relative to world geometry (uses ID with real cell and module and layer as zero for key) <br /></td></tr>
<tr class="separator:ad3bd1214a3836bc6a8e8fe4547e0fc8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a910aa8077878771e6b264ce5c804409c"><td class="memItemLeft" align="right" valign="top"><a id="a910aa8077878771e6b264ce5c804409c"></a>
std::map&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a910aa8077878771e6b264ce5c804409c">NNMap_</a></td></tr>
<tr class="memdesc:a910aa8077878771e6b264ce5c804409c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map of cell ID to neighboring cells (uses ID with real cell and module and layer as zero for key) <br /></td></tr>
<tr class="separator:a910aa8077878771e6b264ce5c804409c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a769854d7fb0c67df7e56f7a73c9bf207"><td class="memItemLeft" align="right" valign="top"><a id="a769854d7fb0c67df7e56f7a73c9bf207"></a>
std::map&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a>, std::vector&lt; <a class="el" href="classldmx_1_1EcalID.html">EcalID</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#a769854d7fb0c67df7e56f7a73c9bf207">NNNMap_</a></td></tr>
<tr class="memdesc:a769854d7fb0c67df7e56f7a73c9bf207"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map of cell ID to neighbors of neighbor cells (uses ID with real cell and module and layer as zero for key) <br /></td></tr>
<tr class="separator:a769854d7fb0c67df7e56f7a73c9bf207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa08ab9e0e15d4ff4283b0ff4d416ca"><td class="memItemLeft" align="right" valign="top"><a id="aefa08ab9e0e15d4ff4283b0ff4d416ca"></a>
std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#aefa08ab9e0e15d4ff4283b0ff4d416ca">triggerGroups_</a></td></tr>
<tr class="memdesc:aefa08ab9e0e15d4ff4283b0ff4d416ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of Trigger Group IDs (index is cell ID) <br /></td></tr>
<tr class="separator:aefa08ab9e0e15d4ff4283b0ff4d416ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af15a164a554997823d0a6ac5479dfab6"><td class="memItemLeft" align="right" valign="top">TH2Poly&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EcalHexReadout.html#af15a164a554997823d0a6ac5479dfab6">ecalMap_</a></td></tr>
<tr class="separator:af15a164a554997823d0a6ac5479dfab6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of ECal hexagonal cell readout. </p>
<p>This is the object that does the extra geometry <em>not</em> implemented in the gdml. In order to save time during the simulation, the individual cells in the readout hexagons are not constructed individually in Geant4. This means we have to have a translation between position and cell ID which is accomplished by this class.</p>
<h2><a class="anchor" id="autotoc_md0"></a>
ORIENTATION ASSUMPTIONS:</h2>
<ul>
<li>modules are oriented flat side down.</li>
<li>cells are oriented corner side down.</li>
</ul>
<h2><a class="anchor" id="autotoc_md1"></a>
SOME GEOMETRY:</h2>
<ul>
<li>hexagons have two radii:<ul>
<li>r (half of flat-to-flat width) and R (half of corner-to-corner width).</li>
<li>r = (sqrt(3)/2)R and s = R, where s is the length of an edge.</li>
</ul>
</li>
<li>for seven ecal modules oriented flat-side-down, maximum x and y extents are:<ul>
<li>deltaY = 6r' + 2g = 3sqrt(3)R' + 2g</li>
<li>deltaX = 4R' + s' + 2g/cos(30 deg) = 5R' + 4g/sqrt(3)</li>
<li>where g is uniform gap width between modules, and primed variables correspond to modules.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
THIS GRID:</h2>
<ul>
<li>column-to-column distance in a grid such as ours is 2r = sqrt(3)R.</li>
<li>row-to-row distance is 1.5R (easy to observe that twice that distance = 3R)</li>
</ul>
<p>The cell radius is calculated from the total number of center-to-corner cell radii that span the module height. This count can have fractional counts to account for the fractions of cell radii at the module edges. </p>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00058">58</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac3e0433bb3af65620929cc881ed110eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3e0433bb3af65620929cc881ed110eb">&#9670;&nbsp;</a></span>EcalHexReadout()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::EcalHexReadout::EcalHexReadout </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classldmx_1_1Parameters.html">Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Class constructor.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ps</td><td><a class="el" href="classldmx_1_1Parameters.html">Parameters</a> to configure the <a class="el" href="classldmx_1_1EcalHexReadout.html" title="Implementation of ECal hexagonal cell readout.">EcalHexReadout</a> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8cxx_source.html#l00014">14</a> of file <a class="el" href="EcalHexReadout_8cxx_source.html">EcalHexReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                                                       {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#aabdd321c511fa6728a4d22a376eeae14">layerZPositions_</a> = ps.getParameter&lt;std::vector&lt;double&gt;&gt;(<span class="stringliteral">&quot;layerZPositions&quot;</span>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#a3d6cf2d6aa9ed38913936445e031fa0a">ecalFrontZ_</a>   = ps.getParameter&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;ecalFrontZ&quot;</span>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>      = ps.getParameter&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;moduleMinR&quot;</span>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#aa8283a781129c83d72b4b05b411b4906">gap_</a>          = ps.getParameter&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;gap&quot;</span>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#a1bbd845808c2836b6c1530c12b4e0fa4">nCellRHeight_</a> = ps.getParameter&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;nCellRHeight&quot;</span>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>      = ps.getParameter&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;verbose&quot;</span>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a> = <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>*(2/sqrt(3));</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a>   = 2*<a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>/<a class="code" href="classldmx_1_1EcalHexReadout.html#a1bbd845808c2836b6c1530c12b4e0fa4">nCellRHeight_</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a>   = (sqrt(3.)/2.)*<a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0){</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;            std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;[EcalHexReadout] Verbosity set in header to &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;     Building module map with gap &quot;</span> &lt;&lt; std::setprecision(2) &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#aa8283a781129c83d72b4b05b411b4906">gap_</a></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, nCellRHeight &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#a1bbd845808c2836b6c1530c12b4e0fa4">nCellRHeight_</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;,  min/max radii of cell &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a> &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, and module &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a> &lt;&lt; <span class="stringliteral">&quot; / &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#a05e3dc7a3e36411474327cc877cb0079">buildModuleMap</a>();</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#ab42dd6bfd06539ace4bedfa6e5c6bfad">buildCellMap</a>();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#a201ec824d6806ff70bdb716cc42cc70e">buildCellModuleMap</a>();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#ac4aeb2b9831ad98110e4984f2c6f766b">buildNeighborMaps</a>();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0){ std::cout &lt;&lt; std::endl; }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8cxx_source.html#l00064">buildCellMap()</a>, <a class="el" href="EcalHexReadout_8cxx_source.html#l00230">buildCellModuleMap()</a>, <a class="el" href="EcalHexReadout_8cxx_source.html#l00043">buildModuleMap()</a>, <a class="el" href="EcalHexReadout_8cxx_source.html#l00248">buildNeighborMaps()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00417">cellr_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00423">cellR_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00438">ecalFrontZ_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00414">gap_</a>, <a class="el" href="Parameters_8h_source.html#l00069">ldmx::Parameters::getParameter()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00441">layerZPositions_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00420">moduler_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00426">moduleR_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00435">nCellRHeight_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00411">verbose_</a>.</p>

</div>
</div>
<a id="aa2f2a9f43fbc3e02dee49ce92b4a2da0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2f2a9f43fbc3e02dee49ce92b4a2da0">&#9670;&nbsp;</a></span>~EcalHexReadout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual ldmx::EcalHexReadout::~EcalHexReadout </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Class destructor.</p>
<p>Does nothing because the stl containers clean up automatically. </p>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00074">74</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{ }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ab42dd6bfd06539ace4bedfa6e5c6bfad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab42dd6bfd06539ace4bedfa6e5c6bfad">&#9670;&nbsp;</a></span>buildCellMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalHexReadout::buildCellMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs the flat-bottomed hexagonal grid (cellID) of corner-down hexagonal cells.</p>
<p>Sets ecalMap_ with the defined bins being the ecal cells in coordinates with respect to the module center. Also sets cellPostionMap_ with the keys being the cell ID and the values being the position of the cell with respect to the module center.</p>
<h2><a class="anchor" id="autotoc_md3"></a>
Strategy</h2>
<p>Use ROOT's TH2Poly::HoneyComb method to build a large hexagonal grid, then copy the polygons from it which overlap with the module with more than one vertex.</p>
<p>A vertex between three cells is placed at the origin, then the bottom left corner of the honeycomb and the number of x and y cells across the honeycomb is calculated by continuing to decrement the grid x/y point until the module center-to-flat distance is reached.</p>
<p>The hexagons that only have one vertex outside the module hexagon leave a small space un-covered by the tiling, so the vertices adjacent to the external vertex are projected onto the module edge.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellr_</td><td>the center-to-flat cell radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellR_</td><td>the center-to-corner cell radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moduler_</td><td>the center-to-flat module radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moduleR_</td><td>the center-to-flat module radius </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ecalMap_</td><td>TH2Poly with local cell ID to local cell position mapping </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cellPostionMap_</td><td>map of local cell ID to cell center position relative to module </td></tr>
  </table>
  </dd>
</dl>
<p>STRATEGY use native ROOT HoneyComb method to build large hexagonal grid. then copy from it the polygons which cover a module.</p>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8cxx_source.html#l00064">64</a> of file <a class="el" href="EcalHexReadout_8cxx_source.html">EcalHexReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                      {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        TH2Poly gridMap;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">// make hexagonal grid [boundary is rectangle] larger than the module</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordtype">double</span> gridMinX = 0., gridMinY = 0.; <span class="comment">//start at the origin</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordtype">int</span> numXCells=0, numYCells=0;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment">//first x-cell is only a half</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        gridMinX -= <a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        numXCells++;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">while</span> ( gridMinX &gt; -1*<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a> ) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            gridMinX -= 2*<a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a>; <span class="comment">//decrement x by cell center-to-flat diameter</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            numXCells++;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">while</span> ( gridMinY &gt; -1*<a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a> ) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            <span class="comment">//decrement y by cell center-to-corner radius</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="comment">//  alternate between a full corner-to-corner diameter</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="comment">//  and a side of a cell (center-to-corner radius)</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">if</span> (numYCells%2==0) gridMinY -= 1*<a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a>; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <span class="keywordflow">else</span>                gridMinY -= 2*<a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            numYCells++;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">//only counted one half of the cells</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        numXCells *= 2;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        numYCells *= 2;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        gridMap.Honeycomb(gridMinX , gridMinY, <a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a>, numXCells , numYCells);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0){</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;            std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            std::cout &lt;&lt; std::setprecision(2)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;[buildCellMap] cell rmin: &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a> &lt;&lt; <span class="stringliteral">&quot; cell rmax: &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; (gridMinX,gridMinY) = (&quot;</span> &lt;&lt; gridMinX &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; gridMinY &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; (numXCells,numYCells) = (&quot;</span> &lt;&lt; numXCells &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; numYCells &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="comment">// copy cells lying within module boundaries to a module grid</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        TListIter next(gridMap.GetBins()); <span class="comment">// a TH2Poly is a TList of TH2PolyBin</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        TH2PolyBin *polyBin = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        TGraph * poly = 0; <span class="comment">// a polygon returned by TH2Poly is a TGraph</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordtype">int</span> ecalMapID = 0; <span class="comment">// ecalMap cell IDs go from 0 to N-1, not equal to original grid cell ID.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">while</span>( (polyBin = (TH2PolyBin*)next()) ){</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="comment">//these bins are coming from the honeycomb</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="comment">//  grid so we assume that they are regular</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="comment">//  hexagons i.e. has 6 vertices</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            poly = (TGraph*)polyBin-&gt;GetPolygon();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="comment">// decide whether to copy polygon to new map.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="comment">// use all vertices in case of cut-off edge polygons.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordtype">int</span> numVerticesInside = 0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keywordtype">double</span> vertex_x[6], vertex_y[6]; <span class="comment">//vertices of the cell</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordtype">bool</span>   isinside[6]; <span class="comment">//which vertices are inside</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2) std::cout &lt;&lt; <span class="stringliteral">&quot;[buildCellMap] Cell vertices&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0 ; i &lt; 6; i++){</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                poly-&gt;GetPoint(i,vertex_x[i],vertex_y[i]);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;     vtx # &quot;</span> &lt;&lt; i &lt;&lt; std::endl;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;     vtx x,y &quot;</span> &lt;&lt; vertex_x[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vertex_y[i] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                isinside[i] = <a class="code" href="classldmx_1_1EcalHexReadout.html#a9d22369c3704814a3c52667b1373bbe8">isInside</a>(vertex_x[i]/<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>, vertex_y[i]/<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordflow">if</span> (isinside[i]) numVerticesInside++;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">if</span>(numVerticesInside &gt; 1){</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="comment">// Include this cell if more than one of its vertices is inside the module hexagon</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordflow">if</span> ( numVerticesInside == 5 ) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    <span class="comment">// This cell is stradling the edge of the module</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <span class="comment">// and is NOT cleanly cut by module edge</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;1) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;[buildCellMap] Polygon &quot;</span> &lt;&lt; ecalMapID</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                            &lt;&lt; <span class="stringliteral">&quot; has vertices poking out of module hexagon.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                    <span class="comment">// loop through vertices</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; 6; i++ ) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                        <span class="keywordtype">int</span> up = i==5 ? 0 : i+1;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                        <span class="keywordtype">int</span> dn = i==0 ? 5 : i-1;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                        <span class="keywordflow">if</span> ( isinside[i] and (not isinside[up] or not isinside[dn]) ) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                            <span class="comment">//this vertex is inside the module hexagon and is adjacent to a vertex outside</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                            <span class="comment">// ==&gt; project this vertex onto the nearest edge of the module hexagon</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                            <span class="comment">// determine which side of hexagon we should project onto</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                            <span class="keywordtype">double</span> edge_origin_x, edge_origin_y;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                            <span class="keywordtype">double</span> edge_dest_x, edge_dest_y;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                            <span class="keywordflow">if</span> ( vertex_x[i] &lt; -<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>/2. ) {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                <span class="comment">//sloped edge on negative-x side</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                edge_origin_x = -1.*<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                edge_origin_y = 0.;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                edge_dest_x = -0.5*<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                edge_dest_y = <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( vertex_x[i] &gt; <a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>/2. ) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                <span class="comment">//sloped edge on positive-x side</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                edge_origin_x = 0.5*<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                edge_origin_y = <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                edge_dest_x = <a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                edge_dest_y = 0.;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                <span class="comment">//flat edge at top</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                edge_origin_x = 0.5*<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                edge_origin_y = <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                edge_dest_x = -0.5*<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                edge_dest_y = <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                            }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                            <span class="comment">// flip to bottom half if below x-axis</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                            <span class="keywordflow">if</span> ( vertex_y[i] &lt; 0 ) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                edge_dest_y *= -1;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                edge_origin_y *= -1;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                            }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                            <span class="comment">// get edge slope vector</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                            <span class="keywordtype">double</span> edge_slope_x = edge_dest_x - edge_origin_x;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                            <span class="keywordtype">double</span> edge_slope_y = edge_dest_y - edge_origin_y;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                            <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                std::cout &lt;&lt; <span class="stringliteral">&quot;Vertex &quot;</span> &lt;&lt; i </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot; is inside and adjacent to a vertex outside the module.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                std::cout &lt;&lt; <span class="stringliteral">&quot;Working on edge with slope (&quot;</span> &lt;&lt; edge_slope_x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; edge_slope_y &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot; and origin (&quot;</span> &lt;&lt; edge_origin_x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; edge_origin_y &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                            }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                            <span class="comment">//project vertices adjacent to the vertex outside the module onto the module edge</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                            <span class="keywordtype">double</span> projection_factor = </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                ( (vertex_x[i]-edge_origin_x)*edge_slope_x</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                + (vertex_y[i]-edge_origin_y)*edge_slope_y )</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                / (edge_slope_x*edge_slope_x + edge_slope_y*edge_slope_y);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                            vertex_x[i] = edge_origin_x + projection_factor*edge_slope_x;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                            vertex_y[i] = edge_origin_y + projection_factor*edge_slope_y;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                            <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                std::cout &lt;&lt; <span class="stringliteral">&quot;New Vertex &quot;</span> &lt;&lt; i </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                    &lt;&lt; <span class="stringliteral">&quot; : (&quot;</span> &lt;&lt; vertex_x[i] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; vertex_y[i] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                            }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        } <span class="comment">//if inside and adjacent to a vertex outside module</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    } <span class="comment">//loop through vertices</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                } <span class="comment">//if numVerticesInside is equal to 5</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="comment">//ecalMap_ needs to have its own copy of the polygon TGraph</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="comment">//  otherwise, we get a seg fault when EcalHexReadout is destructed</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="comment">//  because the polygon that was copied over from gridMap is deleted at the end of this function</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <a class="code" href="classldmx_1_1EcalHexReadout.html#af15a164a554997823d0a6ac5479dfab6">ecalMap_</a>.AddBin( 6 , vertex_x , vertex_y );</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="keywordtype">double</span> x = (polyBin-&gt;GetXMax() + polyBin-&gt;GetXMin()) / 2.;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="keywordtype">double</span> y = (polyBin-&gt;GetYMax() + polyBin-&gt;GetYMin()) / 2.;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;1) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    std::cout &lt;&lt; <span class="stringliteral">&quot;[buildCellMap] Copying poly with ID &quot;</span> &lt;&lt; polyBin-&gt;GetBinNumber()</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        &lt;&lt; <span class="stringliteral">&quot; and (x,y) (&quot;</span> &lt;&lt; std::setprecision(2) &lt;&lt; x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; y &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="comment">//save cell location as center of ENTIRE hexagon</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <a class="code" href="classldmx_1_1EcalHexReadout.html#a93ca64659ba36e91c8c214d2b6bbdaba">cellPositionMap_</a>[ecalMapID] = std::pair&lt;double,double&gt;(x,y);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                ecalMapID++; <span class="comment">//incrememnt cell ID</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            } <span class="comment">// if num vertices inside is &gt; 1</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        } <span class="comment">//loop over larger grid spanning module hexagon</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0) std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00447">cellPositionMap_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00417">cellr_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00423">cellR_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00466">ecalMap_</a>, <a class="el" href="EcalHexReadout_8cxx_source.html#l00311">isInside()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00420">moduler_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00426">moduleR_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00411">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00014">EcalHexReadout()</a>.</p>

</div>
</div>
<a id="a201ec824d6806ff70bdb716cc42cc70e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a201ec824d6806ff70bdb716cc42cc70e">&#9670;&nbsp;</a></span>buildCellModuleMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalHexReadout::buildCellModuleMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs the positions of all the cells in a layer relative to the ecal center.</p>
<p>This uses the modulePostionMap_ and cellPositionMap_ to calculate the center of all cells relative to the ecal center.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">modulePositionMap_</td><td>map of module IDs to module centers relative to ecal </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cellPositionMap_</td><td>map of cell IDs to cell centers relative to module </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8cxx_source.html#l00230">230</a> of file <a class="el" href="EcalHexReadout_8cxx_source.html">EcalHexReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                           {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0) std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;[buildCellModuleMap] Building cellModule position map&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; module : <a class="code" href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">modulePositionMap_</a>) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="keywordtype">int</span> moduleID = module.first;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordtype">double</span> moduleX = module.second.first;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="keywordtype">double</span> moduleY = module.second.second;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; cell : <a class="code" href="classldmx_1_1EcalHexReadout.html#a93ca64659ba36e91c8c214d2b6bbdaba">cellPositionMap_</a>) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="keywordtype">int</span> cellID = cell.first;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordtype">double</span> cellX = cell.second.first;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keywordtype">double</span> cellY = cell.second.second;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordtype">double</span> x = cellX+moduleX;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordtype">double</span> y = cellY+moduleY;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <a class="code" href="classldmx_1_1EcalHexReadout.html#ad3bd1214a3836bc6a8e8fe4547e0fc8d">cellModulePositionMap_</a>[EcalID(0,moduleID,cellID)] = std::pair&lt;double,double&gt;(x,y);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0) std::cout &lt;&lt; <span class="stringliteral">&quot;  contained &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#ad3bd1214a3836bc6a8e8fe4547e0fc8d">cellModulePositionMap_</a>.size() &lt;&lt; <span class="stringliteral">&quot; entries. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00450">cellModulePositionMap_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00447">cellPositionMap_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00444">modulePositionMap_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00411">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00014">EcalHexReadout()</a>.</p>

</div>
</div>
<a id="a05e3dc7a3e36411474327cc877cb0079"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e3dc7a3e36411474327cc877cb0079">&#9670;&nbsp;</a></span>buildModuleMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalHexReadout::buildModuleMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs the positions of the seven modules (moduleID) relative to the ecal center</p>
<p>Sets modulePositionMap_ using the module IDs for keys and the centers of the module hexagons for values.</p>
<p>The module IDs are set in the ecal.gdml file and are replicated here.</p><ul>
<li>0 for center module</li>
<li>1 on top (12 o'clock)</li>
<li>clockwise till 6 at 11 o'clock</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">gap_</td><td>separation between module flat-sides </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">moduler_</td><td>center-to-flat module radius </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">modulePositionMap_</td><td>map of module IDs to module centers relative to ecal </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8cxx_source.html#l00043">43</a> of file <a class="el" href="EcalHexReadout_8cxx_source.html">EcalHexReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                       {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            std::cout </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                &lt;&lt; std::endl </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;[buildModuleMap] Building module position map for module min r of &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;    and gap of &quot;</span> &lt;&lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#aa8283a781129c83d72b4b05b411b4906">gap_</a></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                &lt;&lt; std::endl;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="comment">// module IDs are 0 for ecal center, 1 at 12 o&#39;clock, and clockwise till 6 at 11 o&#39;clock.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="keywordtype">double</span> C_PI = 3.14159265358979323846; <span class="comment">// or TMath::Pi(), #define, atan(), ...</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">modulePositionMap_</a>[0] = std::pair&lt;double,double&gt;(0.,0.);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">id</span> = 1 ; <span class="keywordtype">id</span> &lt; 7 ; <span class="keywordtype">id</span>++){</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keywordtype">double</span> x = (2.*<a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>+<a class="code" href="classldmx_1_1EcalHexReadout.html#aa8283a781129c83d72b4b05b411b4906">gap_</a>)*sin( (<span class="keywordtype">id</span>-1)*(C_PI/3.) );</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordtype">double</span> y = (2.*<a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>+<a class="code" href="classldmx_1_1EcalHexReadout.html#aa8283a781129c83d72b4b05b411b4906">gap_</a>)*cos( (<span class="keywordtype">id</span>-1)*(C_PI/3.) );</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <a class="code" href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">modulePositionMap_</a>[id] = std::pair&lt;double,double&gt;(x,y);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2) std::cout &lt;&lt; TString::Format(<span class="stringliteral">&quot;   id %d is at (%.2f, %.2f)&quot;</span>,<span class="keywordtype">id</span>,x,y) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0) std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00414">gap_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00444">modulePositionMap_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00420">moduler_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00411">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00014">EcalHexReadout()</a>.</p>

</div>
</div>
<a id="ac4aeb2b9831ad98110e4984f2c6f766b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4aeb2b9831ad98110e4984f2c6f766b">&#9670;&nbsp;</a></span>buildNeighborMaps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalHexReadout::buildNeighborMaps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Construts NNMap and NNNMap</p>
<p>Since this only occurs once during processing, we can be wasteful. We do a nested loop over the entire cellular position map and calculate neighbors by seeing which cells are within multiples of the cellular radius of each other.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellModulePostionMap_</td><td>map of cells to cell centers relative to ecal </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NNMap_</td><td>map of cell IDs to list of cell IDs that are its nearest neighbors </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">NNNMap_</td><td>map of cell IDs to list of cell IDs that are its next-to-nearest neighbors </td></tr>
  </table>
  </dd>
</dl>
<p>STRATEGY Neighbors may include from other modules. All this is precomputed. So we can be wasteful here. Gaps may be nonzero, so we simply apply an anulus requirement (r &lt; point &lt;= r+dr) using total x,y positions relative to the ecal center (cell+module positions). This makes the routine portable to future cell layouts. Note that the module centers already take into account a nonzero gap. The number of neighbors is not simple because: edges, and that module edges have cutoff cells. (NN) Center within [1*cellr_, 3*cellr_] (NNN) Center within [3*cellr_, 4.5*cellr_] Chosen b/c in ideal case, centers are at 2*cell_ (NN), and at 3*cellR_=3.46*cellr_ and 4*cellr_ (NNN).</p>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8cxx_source.html#l00248">248</a> of file <a class="el" href="EcalHexReadout_8cxx_source.html">EcalHexReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                          {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#a910aa8077878771e6b264ce5c804409c">NNMap_</a>.clear();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="classldmx_1_1EcalHexReadout.html#a769854d7fb0c67df7e56f7a73c9bf207">NNNMap_</a>.clear();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; centerChannel : <a class="code" href="classldmx_1_1EcalHexReadout.html#ad3bd1214a3836bc6a8e8fe4547e0fc8d">cellModulePositionMap_</a>) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            EcalID centerID = centerChannel.first;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordtype">double</span> centerX = centerChannel.second.first;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordtype">double</span> centerY = centerChannel.second.second;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; probeChannel : <a class="code" href="classldmx_1_1EcalHexReadout.html#ad3bd1214a3836bc6a8e8fe4547e0fc8d">cellModulePositionMap_</a>) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                EcalID probeID = probeChannel.first;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <span class="keywordtype">double</span> probeX = probeChannel.second.first;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordtype">double</span> probeY = probeChannel.second.second;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordtype">double</span> dist = sqrt( (probeX-centerX)*(probeX-centerX) + (probeY-centerY)*(probeY-centerY) );</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keywordflow">if</span>(      dist &gt; 1*<a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a>  &amp;&amp; dist &lt;= 3.*<a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a>)  { <a class="code" href="classldmx_1_1EcalHexReadout.html#a910aa8077878771e6b264ce5c804409c">NNMap_</a>[centerID].push_back(probeID); }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>( dist &gt; 3.*<a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a> &amp;&amp; dist &lt;= 4.5*<a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a>) {<a class="code" href="classldmx_1_1EcalHexReadout.html#a769854d7fb0c67df7e56f7a73c9bf207">NNNMap_</a>[centerID].push_back(probeID); }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;1) std::cout &lt;&lt; TString::Format(<span class="stringliteral">&quot;Found %d NN and %d NNN for cellModuleID &quot;</span>,<span class="keywordtype">int</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#a910aa8077878771e6b264ce5c804409c">NNMap_</a>[centerID].size()), <span class="keywordtype">int</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#a769854d7fb0c67df7e56f7a73c9bf207">NNNMap_</a>[centerID].size()))</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                     &lt;&lt; centerID &lt;&lt; TString::Format(<span class="stringliteral">&quot; with x,y (%.2f,%.2f)&quot;</span>, centerX, centerY) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2){</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordtype">double</span> specialX = 0.5*<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a> - 0.5*<a class="code" href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">cellr_</a>; <span class="comment">// center of cell which is upper-right corner of center module</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordtype">double</span> specialY = <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a> - 0.5*<a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            EcalID specialCellModuleID = <a class="code" href="classldmx_1_1EcalHexReadout.html#a5293b7b33e0eea806b797069a7ca1ffb">getCellModuleID</a>(specialX,specialY);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;The neighbors of the bin in the upper-right corner of the center module, with cellModuleID &quot;</span> </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                      &lt;&lt; specialCellModuleID &lt;&lt; <span class="stringliteral">&quot; include &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> centerNN : <a class="code" href="classldmx_1_1EcalHexReadout.html#a910aa8077878771e6b264ce5c804409c">NNMap_</a>.at(specialCellModuleID)){</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot; NN &quot;</span> &lt;&lt; centerNN</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            &lt;&lt; TString::Format(<span class="stringliteral">&quot; (x,y) (%.2f, %.2f)&quot;</span>,<a class="code" href="classldmx_1_1EcalHexReadout.html#a1f2b9f3ed6994ffb2716ad5d15ed9e67">getCellCenterAbsolute</a>(centerNN).first,<a class="code" href="classldmx_1_1EcalHexReadout.html#a1f2b9f3ed6994ffb2716ad5d15ed9e67">getCellCenterAbsolute</a>(centerNN).second) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keywordflow">for</span>(<span class="keyword">auto</span> centerNNN : <a class="code" href="classldmx_1_1EcalHexReadout.html#a769854d7fb0c67df7e56f7a73c9bf207">NNNMap_</a>.at(specialCellModuleID)){</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;          std::cout &lt;&lt; <span class="stringliteral">&quot; NNN &quot;</span> &lt;&lt; centerNNN</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            &lt;&lt; TString::Format(<span class="stringliteral">&quot; (x,y) (%.2f, %.2f)&quot;</span>,<a class="code" href="classldmx_1_1EcalHexReadout.html#a1f2b9f3ed6994ffb2716ad5d15ed9e67">getCellCenterAbsolute</a>(centerNNN).first,<a class="code" href="classldmx_1_1EcalHexReadout.html#a1f2b9f3ed6994ffb2716ad5d15ed9e67">getCellCenterAbsolute</a>(centerNNN).second) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            std::cout &lt;&lt; TString::Format(<span class="stringliteral">&quot;This bin is a distance of %.2f away from a module edge. Decision isEdge %d.&quot;</span>,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                         <a class="code" href="classldmx_1_1EcalHexReadout.html#aba0999d9c878a1ac5746d1b1f8cd7856">distanceToEdge</a>(specialCellModuleID),<a class="code" href="classldmx_1_1EcalHexReadout.html#a7ae3be71cc7980920b64eccf59b0c27d">isEdgeCell</a>(specialCellModuleID)) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;0) std::cout &lt;&lt; std::endl;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00450">cellModulePositionMap_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00417">cellr_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00423">cellR_</a>, <a class="el" href="EcalHexReadout_8cxx_source.html#l00298">distanceToEdge()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00208">getCellCenterAbsolute()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00192">getCellModuleID()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00230">isEdgeCell()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00420">moduler_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00426">moduleR_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00453">NNMap_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00456">NNNMap_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00411">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00014">EcalHexReadout()</a>.</p>

</div>
</div>
<a id="a7f0f75f6681b73e09cee4268710c55a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f0f75f6681b73e09cee4268710c55a5">&#9670;&nbsp;</a></span>buildTriggerGroup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalHexReadout::buildTriggerGroup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructs list of trigger groups.</p>
<p>The list of trigger groups uses the index as the cell ID and the value as the ID of the trigger group.</p>
<p>For the ECal, cells are grouped into 3x3 "squares" and integrated over for the trigger. This function builds a list for finding which trigger group a cell is in. </p>

</div>
</div>
<a id="aba0999d9c878a1ac5746d1b1f8cd7856"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba0999d9c878a1ac5746d1b1f8cd7856">&#9670;&nbsp;</a></span>distanceToEdge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalHexReadout::distanceToEdge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>cellModuleID</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Distance to module edge, and whether cell is on edge of module.</p>
<p>@TODO Use <a class="el" href="classldmx_1_1EcalHexReadout.html#a2825ec01b21a6f697bf03c3d98fb304a">getNN()</a>/getNNN() + <a class="el" href="classldmx_1_1EcalHexReadout.html#a7ae3be71cc7980920b64eccf59b0c27d">isEdgeCell()</a> to expand functionality.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellModuleID</td><td>EcalId where all we care about is module and cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>distance to edge of the module </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8cxx_source.html#l00298">298</a> of file <a class="el" href="EcalHexReadout_8cxx_source.html">EcalHexReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                                                                   {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// https://math.stackexchange.com/questions/1210572/find-the-distance-to-the-edge-of-a-hexagon</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordtype">int</span> cellID = cellModuleID.cell();</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        std::pair&lt;double,double&gt; cellLocation = <a class="code" href="classldmx_1_1EcalHexReadout.html#a523f77a4dad9737cf2679d2994b748c6">getCellCenterRelative</a>(cellID);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordtype">double</span> x = fabs(cellLocation.first); <span class="comment">// bring to first quadrant</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordtype">double</span> y = fabs(cellLocation.second);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordtype">double</span> r = sqrt(x*x+y*y);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordtype">double</span> theta = (r &gt; 1E-3) ? fabs(std::atan(y/x)) : 0;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span>(x &lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>/2.) <span class="keywordflow">return</span> (<a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a> - y); <span class="comment">// closest line is straight vertical to top edge</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordtype">double</span> dist = sqrt(3.)*<a class="code" href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">moduleR_</a>/(std::sin(theta) + sqrt(3.)*std::cos(theta));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">return</span> dist;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalID_8h_source.html#l00096">ldmx::EcalID::cell()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00173">getCellCenterRelative()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00420">moduler_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00426">moduleR_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00248">buildNeighborMaps()</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00230">isEdgeCell()</a>.</p>

</div>
</div>
<a id="a9e179626757c116ccc8dc85e825fbf66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e179626757c116ccc8dc85e825fbf66">&#9670;&nbsp;</a></span>getCellAbsolutePosition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::EcalHexReadout::getCellAbsolutePosition </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get entire real space position for the cell with the input raw ID</p>
<p>Inputs x,y,z will be set to the calculated position</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classldmx_1_1EcalHexReadout.html#a1f2b9f3ed6994ffb2716ad5d15ed9e67">getCellCenterAbsolute</a> and <a class="el" href="classldmx_1_1EcalHexReadout.html#a53eb62b5d96ad24072aff1a1752e0bad">getZPosition</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td><a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> for the cell we want the position of </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">x</td><td>set to x-coordinate of cell center </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">y</td><td>set to y-coordinate of cell center </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">z</td><td>set to z-coordinate of cell center </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00088">88</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                                                                             {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                std::pair&lt;double,double&gt; xy = this-&gt;<a class="code" href="classldmx_1_1EcalHexReadout.html#a1f2b9f3ed6994ffb2716ad5d15ed9e67">getCellCenterAbsolute</a>( EcalID(0,<span class="keywordtype">id</span>.module(),<span class="keywordtype">id</span>.cell()) );</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                x = xy.first;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                y = xy.second;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                z = <a class="code" href="classldmx_1_1EcalHexReadout.html#a53eb62b5d96ad24072aff1a1752e0bad">getZPosition</a>(<span class="keywordtype">id</span>.layer());</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00208">getCellCenterAbsolute()</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00104">getZPosition()</a>.</p>

</div>
</div>
<a id="a1f2b9f3ed6994ffb2716ad5d15ed9e67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f2b9f3ed6994ffb2716ad5d15ed9e67">&#9670;&nbsp;</a></span>getCellCenterAbsolute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt;double,double&gt; ldmx::EcalHexReadout::getCellCenterAbsolute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>cellModuleID</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a cell center XY position relative to ecal center from a combined cellModuleID.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::out_of_range</td><td>if <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> isn't created with valid cell or module IDs.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cellModuleID</td><td><a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> where all we care about is module and cell </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The XY position of the center of the cell. </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00208">208</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                                                    {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1EcalHexReadout.html#ad3bd1214a3836bc6a8e8fe4547e0fc8d">cellModulePositionMap_</a>.at(EcalID(0,cellModuleID.module(),cellModuleID.cell()));</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalID_8h_source.html#l00096">ldmx::EcalID::cell()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00450">cellModulePositionMap_</a>, and <a class="el" href="EcalID_8h_source.html#l00063">ldmx::EcalID::module()</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00248">buildNeighborMaps()</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00088">getCellAbsolutePosition()</a>.</p>

</div>
</div>
<a id="a523f77a4dad9737cf2679d2994b748c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a523f77a4dad9737cf2679d2994b748c6">&#9670;&nbsp;</a></span>getCellCenterRelative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt;double,double&gt; ldmx::EcalHexReadout::getCellCenterRelative </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cellID</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a cell center XY position relative to module center from a cell ID.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classldmx_1_1Exception.html" title="Standard base exception class with some useful output information.">Exception</a></td><td>if invalid cell ID is input.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cellID</td><td>The cell ID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The (x,y) position of the center of the cell. </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00173">173</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                                           {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                <span class="comment">// this map search is probably just as fine as the TList search for the cell in ecalMap.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="comment">//   wonder why TH2Poly-&gt;GetBin(ID) doesn&#39;t exist. plus the map is useful by itself.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keyword">auto</span> search = <a class="code" href="classldmx_1_1EcalHexReadout.html#a93ca64659ba36e91c8c214d2b6bbdaba">cellPositionMap_</a>.find(cellID);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                <span class="keywordflow">if</span>(search == <a class="code" href="classldmx_1_1EcalHexReadout.html#a93ca64659ba36e91c8c214d2b6bbdaba">cellPositionMap_</a>.end()) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    EXCEPTION_RAISE( <span class="stringliteral">&quot;InvalidCellID&quot;</span> , <span class="stringliteral">&quot;Cell &quot;</span> + std::to_string(cellID) + <span class="stringliteral">&quot; is not valid.&quot;</span> );</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">return</span> search-&gt;second;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00447">cellPositionMap_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00298">distanceToEdge()</a>.</p>

</div>
</div>
<a id="a1b24c37eeb6ad660963022e4758b92c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b24c37eeb6ad660963022e4758b92c5">&#9670;&nbsp;</a></span>getCellIDRelative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ldmx::EcalHexReadout::getCellIDRelative </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a cell ID from an XY position relative to module center.</p>
<p>This is where invalid (x,y) from external calls will end up failing and need error handling.</p>
<dl class="section note"><dt>Note</dt><dd>One option for assigning dead material is to do it here. If the input (x,y) relative to the module is close enough to the edge (for example), we could return a special cell ID (-1 for example) that signals that this hit is in a dead region.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Any X position [mm] </td></tr>
    <tr><td class="paramname">y</td><td>Any Y position [mm] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>local cell ID to the module </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00154">154</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                                            {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordtype">int</span> bin = <a class="code" href="classldmx_1_1EcalHexReadout.html#af15a164a554997823d0a6ac5479dfab6">ecalMap_</a>.FindBin(x,y)-1; <span class="comment">// NB FindBin indices starts from 1, our maps start from 0</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keywordflow">if</span>(bin &lt; 0) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    TString error_msg = TString(<span class="stringliteral">&quot;[EcalHexReadout::getCellIDRelative] Relative coordinates are outside module hexagon!&quot;</span>) + </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                        TString::Format(<span class="stringliteral">&quot; Is the gap used by EcalHexReadout (%.2f mm) and the minimum module radius (%.2f mm)&quot;</span>,<a class="code" href="classldmx_1_1EcalHexReadout.html#aa8283a781129c83d72b4b05b411b4906">gap_</a>,<a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>) +</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                        TString::Format(<span class="stringliteral">&quot; the same as hexagon_gap and Hex_radius in ecal.gdml? Received (x,y) = (%.2f,%.2f).&quot;</span>,x,y);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                    EXCEPTION_RAISE( <span class="stringliteral">&quot;InvalidArg&quot;</span> , error_msg.Data() );</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="keywordflow">return</span> bin;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00466">ecalMap_</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00414">gap_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00420">moduler_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8h_source.html#l00192">getCellModuleID()</a>.</p>

</div>
</div>
<a id="a5293b7b33e0eea806b797069a7ca1ffb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5293b7b33e0eea806b797069a7ca1ffb">&#9670;&nbsp;</a></span>getCellModuleID()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a> ldmx::EcalHexReadout::getCellModuleID </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a combined cellModule ID from an XY position relative to ecal center.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classldmx_1_1EcalHexReadout.html#a1b24c37eeb6ad660963022e4758b92c5">getCellIDRelative</a> and <a class="el" href="classldmx_1_1EcalHexReadout.html#ab5b455834faccba33f2a2235b9888c81">getModuleID</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Any X position [mm] </td></tr>
    <tr><td class="paramname">y</td><td>Any Y position [mm] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>an <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> that has the correct module and cell information while layer is set to zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00192">192</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                                             {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                <span class="keywordtype">int</span> moduleID = <a class="code" href="classldmx_1_1EcalHexReadout.html#ab5b455834faccba33f2a2235b9888c81">getModuleID</a>(x,y);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordtype">double</span> relX = x - <a class="code" href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">modulePositionMap_</a>.at(moduleID).first;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordtype">double</span> relY = y - <a class="code" href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">modulePositionMap_</a>.at(moduleID).second;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordtype">int</span> cellID = <a class="code" href="classldmx_1_1EcalHexReadout.html#a1b24c37eeb6ad660963022e4758b92c5">getCellIDRelative</a>(relX,relY);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordflow">return</span> EcalID(0,moduleID,cellID);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00154">getCellIDRelative()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00126">getModuleID()</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00444">modulePositionMap_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00248">buildNeighborMaps()</a>.</p>

</div>
</div>
<a id="ad5fc46d98284ea1d0f370b8b4f9a216f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5fc46d98284ea1d0f370b8b4f9a216f">&#9670;&nbsp;</a></span>getCellModulePositionMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::map&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>,std::pair&lt;double,double&gt; &gt;&amp; ldmx::EcalHexReadout::getCellModulePositionMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a const reference to the full cell-module position map. </p>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00306">306</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                                                                          {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1EcalHexReadout.html#ad3bd1214a3836bc6a8e8fe4547e0fc8d">cellModulePositionMap_</a>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00450">cellModulePositionMap_</a>.</p>

</div>
</div>
<a id="a8a7054d9c8f5a227daf3ee4b0557edb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a7054d9c8f5a227daf3ee4b0557edb7">&#9670;&nbsp;</a></span>getCellPolyMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2Poly* ldmx::EcalHexReadout::getCellPolyMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a reference to the TH2Poly used for Cell IDs.</p>
<dl class="section note"><dt>Note</dt><dd>This is only helpful in the use case where you want to print the cell ID &lt;-&gt; cell position map. DO NOT USE THIS OTHERWISE.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to member variable ecalMap_ </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00319">319</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{ <span class="keywordflow">return</span> &amp;<a class="code" href="classldmx_1_1EcalHexReadout.html#af15a164a554997823d0a6ac5479dfab6">ecalMap_</a>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00466">ecalMap_</a>.</p>

</div>
</div>
<a id="ae75265eb71219cc63ea25fb6b4081180"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae75265eb71219cc63ea25fb6b4081180">&#9670;&nbsp;</a></span>getCellPositionMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::map&lt;int,std::pair&lt;double,double&gt; &gt;&amp; ldmx::EcalHexReadout::getCellPositionMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a const reference to the cell center position map. </p>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00299">299</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                                                 {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1EcalHexReadout.html#a93ca64659ba36e91c8c214d2b6bbdaba">cellPositionMap_</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00447">cellPositionMap_</a>.</p>

</div>
</div>
<a id="a4c26f03d3d7029a3aace3745b9ef1ab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c26f03d3d7029a3aace3745b9ef1ab6">&#9670;&nbsp;</a></span>getModuleCenter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt;double,double&gt; ldmx::EcalHexReadout::getModuleCenter </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>moduleID</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a module center position relative to the ecal center [mm]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">moduleID</td><td>id of the module </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>(x,y) coordinate pair for center of module </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00115">115</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                                                       {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">modulePositionMap_</a>.at(moduleID);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00444">modulePositionMap_</a>.</p>

</div>
</div>
<a id="ab5b455834faccba33f2a2235b9888c81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b455834faccba33f2a2235b9888c81">&#9670;&nbsp;</a></span>getModuleID()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ldmx::EcalHexReadout::getModuleID </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get a module ID from an XY position relative to the ecal center [mm]</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>x-coordinate for test position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>y-coordinate for test position </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>module ID that coordinate (x,y) is in </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00126">126</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                                      {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                <span class="keywordtype">int</span> bestID = -1;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <span class="keywordtype">double</span> bestDist = 1E6;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordflow">for</span>(<span class="keyword">auto</span> <span class="keyword">const</span>&amp; module : <a class="code" href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">modulePositionMap_</a>) {  </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    <span class="keywordtype">int</span> mID   = module.first;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    <span class="keywordtype">double</span> mX = module.second.first;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    <span class="keywordtype">double</span> mY = module.second.second;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    <span class="keywordtype">double</span> dist = sqrt( (x-mX)*(x-mX) + (y-mY)*(y-mY) );</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">if</span>(dist &lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">moduler_</a>) <span class="keywordflow">return</span> mID;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    <span class="keywordflow">if</span>(dist &lt; bestDist) { bestID = mID; bestDist = dist; }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                <span class="keywordflow">return</span> bestID;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00444">modulePositionMap_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00420">moduler_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8h_source.html#l00192">getCellModuleID()</a>.</p>

</div>
</div>
<a id="a2825ec01b21a6f697bf03c3d98fb304a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2825ec01b21a6f697bf03c3d98fb304a">&#9670;&nbsp;</a></span>getNN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&gt; ldmx::EcalHexReadout::getNN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the Nearest Neighbors of the input ID</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>id to get </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>list of <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> that are the inputs nearest neighbors </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00250">250</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                                     {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keyword">auto</span> list = <a class="code" href="classldmx_1_1EcalHexReadout.html#a910aa8077878771e6b264ce5c804409c">NNMap_</a>.at(EcalID(0,<span class="keywordtype">id</span>.module(),<span class="keywordtype">id</span>.cell()));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; flat : list) <span class="keywordtype">id</span> = EcalID(<span class="keywordtype">id</span>.layer(),flat.module(),flat.cell());</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">return</span> list;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00453">NNMap_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8h_source.html#l00263">isNN()</a>.</p>

</div>
</div>
<a id="a4b8d8ccd4c0f4253a6c70aba413b1b27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b8d8ccd4c0f4253a6c70aba413b1b27">&#9670;&nbsp;</a></span>getNNN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&gt; ldmx::EcalHexReadout::getNNN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the Next-to-Nearest Neighbors of the input ID</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>id to get </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>list of <a class="el" href="classldmx_1_1EcalID.html" title="Extension of DetectorID providing access to ECal layers and cell numbers in a hex grid.">EcalID</a> that are the inputs next-to-nearest neighbors </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00276">276</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                                      {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <span class="keyword">auto</span> list = <a class="code" href="classldmx_1_1EcalHexReadout.html#a769854d7fb0c67df7e56f7a73c9bf207">NNNMap_</a>.at(EcalID(0,<span class="keywordtype">id</span>.module(),<span class="keywordtype">id</span>.cell()));</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; flat : list) <span class="keywordtype">id</span> = EcalID(<span class="keywordtype">id</span>.layer(),flat.module(),flat.cell());</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="keywordflow">return</span> list;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00456">NNNMap_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8h_source.html#l00289">isNNN()</a>.</p>

</div>
</div>
<a id="a53eb62b5d96ad24072aff1a1752e0bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53eb62b5d96ad24072aff1a1752e0bad">&#9670;&nbsp;</a></span>getZPosition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalHexReadout::getZPosition </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layer</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the z-coordinate given the layer id</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">layer</td><td>int layer id </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>z-coordinate of the input sensitive layer </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00104">104</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                                 {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1EcalHexReadout.html#a3d6cf2d6aa9ed38913936445e031fa0a">ecalFrontZ_</a> + <a class="code" href="classldmx_1_1EcalHexReadout.html#aabdd321c511fa6728a4d22a376eeae14">layerZPositions_</a>.at(layer);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00438">ecalFrontZ_</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00441">layerZPositions_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8h_source.html#l00088">getCellAbsolutePosition()</a>.</p>

</div>
</div>
<a id="a7ae3be71cc7980920b64eccf59b0c27d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ae3be71cc7980920b64eccf59b0c27d">&#9670;&nbsp;</a></span>isEdgeCell()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalHexReadout::isEdgeCell </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>cellModuleID</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if input cell is on the edge of a module.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classldmx_1_1EcalHexReadout.html#aba0999d9c878a1ac5746d1b1f8cd7856">distanceToEdge</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cellModuleID</td><td>EcalId where all we care about is module and cell return true if distance to edge is less than max cell radius </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00230">230</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                                       {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="keywordflow">return</span> (<a class="code" href="classldmx_1_1EcalHexReadout.html#aba0999d9c878a1ac5746d1b1f8cd7856">distanceToEdge</a>(cellModuleID) &lt; <a class="code" href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">cellR_</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00423">cellR_</a>, and <a class="el" href="EcalHexReadout_8cxx_source.html#l00298">distanceToEdge()</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00248">buildNeighborMaps()</a>.</p>

</div>
</div>
<a id="a9d22369c3704814a3c52667b1373bbe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d22369c3704814a3c52667b1373bbe8">&#9670;&nbsp;</a></span>isInside()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalHexReadout::isInside </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>normX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>normY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines if point (x,y), already normed to max hexagon radius, lies within a hexagon. Corners are (1,0) and (0.5,sqrt(3)/2). Uses "&lt;", not "&lt;=".</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">normX</td><td>X-coordinate relative to module hexagon divided by maximum hexagon radius </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">normY</td><td>Y-coordinate relative to module hexagon divided by maximum hexagon radius </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if (normX,normY) is within the hexagon centered at the origin with maximum radius 1. </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8cxx_source.html#l00311">311</a> of file <a class="el" href="EcalHexReadout_8cxx_source.html">EcalHexReadout.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                                                  {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2) std::cout &lt;&lt; TString::Format(<span class="stringliteral">&quot;[isInside] Checking if normXY=(%.2f,%.2f) is inside.&quot;</span>,normX,normY) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        normX = fabs(normX), normY = fabs(normY);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordtype">double</span> xvec = -1,  yvec = -1./sqrt(3);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordtype">double</span> xref = 0.5, yref = sqrt(3)/2.;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">if</span>( (normX &gt; 1.) || (normY &gt; yref) ){</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2) std::cout &lt;&lt; <span class="stringliteral">&quot;[isInside]   they are outside quadrant.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordtype">double</span> dotProd = (xvec*(normX-xref) + yvec*(normY-yref));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">verbose_</a>&gt;2) std::cout &lt;&lt; TString::Format(<span class="stringliteral">&quot;[isInside] they are inside quadrant. Dot product (&gt;0 is inside): %.2f &quot;</span>, dotProd) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">return</span> (dotProd &gt; 0.);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00411">verbose_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00064">buildCellMap()</a>.</p>

</div>
</div>
<a id="a1d10081ac0818753db568097c765a4d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d10081ac0818753db568097c765a4d8">&#9670;&nbsp;</a></span>isNN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalHexReadout::isNN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>centroid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>probe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if the probe id is one of the nearest neightbors of the centroid id</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">probe</td><td>id to check if it is nearest neighbor </td></tr>
    <tr><td class="paramname">centroid</td><td>id that is center of neighbors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if probe ID is a nearest neighbor of the centroid </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00263">263</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                                           {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">for</span> ( <span class="keyword">auto</span>&amp; <span class="keywordtype">id</span> : <a class="code" href="classldmx_1_1EcalHexReadout.html#a2825ec01b21a6f697bf03c3d98fb304a">getNN</a>(centroid) ) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> == probe ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                } </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00250">getNN()</a>.</p>

</div>
</div>
<a id="a21bde7564d75c3b1b2fb83ffdf5ac1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21bde7564d75c3b1b2fb83ffdf5ac1cd">&#9670;&nbsp;</a></span>isNNN()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::EcalHexReadout::isNNN </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>centroid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classldmx_1_1EcalID.html">EcalID</a>&#160;</td>
          <td class="paramname"><em>probe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if the probe id is one of the next-to-nearest neightbors of the centroid id</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">probe</td><td>id to check if it is a next-to-nearest neighbor </td></tr>
    <tr><td class="paramname">centroid</td><td>id that is center of neighbors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if probe ID is a next-to-nearest neighbor of the centroid </dd></dl>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00289">289</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                                            {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="keywordflow">for</span> ( <span class="keyword">auto</span>&amp; <span class="keywordtype">id</span> : <a class="code" href="classldmx_1_1EcalHexReadout.html#a4b8d8ccd4c0f4253a6c70aba413b1b27">getNNN</a>(centroid) ) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    <span class="keywordflow">if</span> ( <span class="keywordtype">id</span> == probe ) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                } </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="EcalHexReadout_8h_source.html#l00276">getNNN()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="af15a164a554997823d0a6ac5479dfab6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af15a164a554997823d0a6ac5479dfab6">&#9670;&nbsp;</a></span>ecalMap_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TH2Poly ldmx::EcalHexReadout::ecalMap_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Honeycomb Binning from ROOT</p>
<p>Needs to be mutable because ROOT doesn't have good const handling </p>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00466">466</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00064">buildCellMap()</a>, <a class="el" href="EcalHexReadout_8h_source.html#l00154">getCellIDRelative()</a>, and <a class="el" href="EcalHexReadout_8h_source.html#l00319">getCellPolyMap()</a>.</p>

</div>
</div>
<a id="a1bbd845808c2836b6c1530c12b4e0fa4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1bbd845808c2836b6c1530c12b4e0fa4">&#9670;&nbsp;</a></span>nCellRHeight_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::EcalHexReadout::nCellRHeight_ {0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of cell center-to-corner radii (one side of the cell) from the bottom to the top of the module</p>
<p>Could be fractional depending on how many fractions of a radii are spanning between the center of the top/bottom cell row and the edge of the module </p>

<p class="definition">Definition at line <a class="el" href="EcalHexReadout_8h_source.html#l00435">435</a> of file <a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalHexReadout_8cxx_source.html#l00014">EcalHexReadout()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>DetDescr/include/DetDescr/<a class="el" href="EcalHexReadout_8h_source.html">EcalHexReadout.h</a></li>
<li>DetDescr/src/<a class="el" href="EcalHexReadout_8cxx_source.html">EcalHexReadout.cxx</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a53eb62b5d96ad24072aff1a1752e0bad"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a53eb62b5d96ad24072aff1a1752e0bad">ldmx::EcalHexReadout::getZPosition</a></div><div class="ttdeci">double getZPosition(int layer) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00104">EcalHexReadout.h:104</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a201ec824d6806ff70bdb716cc42cc70e"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a201ec824d6806ff70bdb716cc42cc70e">ldmx::EcalHexReadout::buildCellModuleMap</a></div><div class="ttdeci">void buildCellModuleMap()</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8cxx_source.html#l00230">EcalHexReadout.cxx:230</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a9d22369c3704814a3c52667b1373bbe8"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a9d22369c3704814a3c52667b1373bbe8">ldmx::EcalHexReadout::isInside</a></div><div class="ttdeci">bool isInside(double normX, double normY) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8cxx_source.html#l00311">EcalHexReadout.cxx:311</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a1bbd845808c2836b6c1530c12b4e0fa4"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a1bbd845808c2836b6c1530c12b4e0fa4">ldmx::EcalHexReadout::nCellRHeight_</a></div><div class="ttdeci">double nCellRHeight_</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00435">EcalHexReadout.h:435</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_abe8818450ac613540a84aca91c808fe8"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#abe8818450ac613540a84aca91c808fe8">ldmx::EcalHexReadout::moduler_</a></div><div class="ttdeci">double moduler_</div><div class="ttdoc">Center-to-Flat Radius of module hexagon [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00420">EcalHexReadout.h:420</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a1481095039b9283d620827b825ca06b1"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a1481095039b9283d620827b825ca06b1">ldmx::EcalHexReadout::cellR_</a></div><div class="ttdeci">double cellR_</div><div class="ttdoc">Center-to-Corner Radius of cell hexagon [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00423">EcalHexReadout.h:423</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_ad3bd1214a3836bc6a8e8fe4547e0fc8d"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#ad3bd1214a3836bc6a8e8fe4547e0fc8d">ldmx::EcalHexReadout::cellModulePositionMap_</a></div><div class="ttdeci">std::map&lt; EcalID, std::pair&lt; double, double &gt; &gt; cellModulePositionMap_</div><div class="ttdoc">Position of cell centers relative to world geometry (uses ID with real cell and module and layer as z...</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00450">EcalHexReadout.h:450</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_ac4aeb2b9831ad98110e4984f2c6f766b"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#ac4aeb2b9831ad98110e4984f2c6f766b">ldmx::EcalHexReadout::buildNeighborMaps</a></div><div class="ttdeci">void buildNeighborMaps()</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8cxx_source.html#l00248">EcalHexReadout.cxx:248</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a1f2b9f3ed6994ffb2716ad5d15ed9e67"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a1f2b9f3ed6994ffb2716ad5d15ed9e67">ldmx::EcalHexReadout::getCellCenterAbsolute</a></div><div class="ttdeci">std::pair&lt; double, double &gt; getCellCenterAbsolute(EcalID cellModuleID) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00208">EcalHexReadout.h:208</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a523f77a4dad9737cf2679d2994b748c6"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a523f77a4dad9737cf2679d2994b748c6">ldmx::EcalHexReadout::getCellCenterRelative</a></div><div class="ttdeci">std::pair&lt; double, double &gt; getCellCenterRelative(int cellID) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00173">EcalHexReadout.h:173</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a05e3dc7a3e36411474327cc877cb0079"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a05e3dc7a3e36411474327cc877cb0079">ldmx::EcalHexReadout::buildModuleMap</a></div><div class="ttdeci">void buildModuleMap()</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8cxx_source.html#l00043">EcalHexReadout.cxx:43</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a93ca64659ba36e91c8c214d2b6bbdaba"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a93ca64659ba36e91c8c214d2b6bbdaba">ldmx::EcalHexReadout::cellPositionMap_</a></div><div class="ttdeci">std::map&lt; int, std::pair&lt; double, double &gt; &gt; cellPositionMap_</div><div class="ttdoc">Position of cell centers relative to module (uses cell ID as key)</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00447">EcalHexReadout.h:447</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_acbf95653cded8772299056d5ea557105"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#acbf95653cded8772299056d5ea557105">ldmx::EcalHexReadout::moduleR_</a></div><div class="ttdeci">double moduleR_</div><div class="ttdoc">Center-to-Corner Radius of module hexagon [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00426">EcalHexReadout.h:426</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_aeac683d8c4aa534f55488f2dbff4d511"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#aeac683d8c4aa534f55488f2dbff4d511">ldmx::EcalHexReadout::verbose_</a></div><div class="ttdeci">int verbose_</div><div class="ttdoc">verbosity, not configurable but helpful if developing</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00411">EcalHexReadout.h:411</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a3d6cf2d6aa9ed38913936445e031fa0a"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a3d6cf2d6aa9ed38913936445e031fa0a">ldmx::EcalHexReadout::ecalFrontZ_</a></div><div class="ttdeci">double ecalFrontZ_</div><div class="ttdoc">Front of ECal relative to world geometry [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00438">EcalHexReadout.h:438</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_aabdd321c511fa6728a4d22a376eeae14"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#aabdd321c511fa6728a4d22a376eeae14">ldmx::EcalHexReadout::layerZPositions_</a></div><div class="ttdeci">std::vector&lt; double &gt; layerZPositions_</div><div class="ttdoc">The layer Z postions are with respect to the front of the ECal [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00441">EcalHexReadout.h:441</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a2825ec01b21a6f697bf03c3d98fb304a"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a2825ec01b21a6f697bf03c3d98fb304a">ldmx::EcalHexReadout::getNN</a></div><div class="ttdeci">std::vector&lt; EcalID &gt; getNN(EcalID id) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00250">EcalHexReadout.h:250</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a4b8d8ccd4c0f4253a6c70aba413b1b27"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a4b8d8ccd4c0f4253a6c70aba413b1b27">ldmx::EcalHexReadout::getNNN</a></div><div class="ttdeci">std::vector&lt; EcalID &gt; getNNN(EcalID id) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00276">EcalHexReadout.h:276</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_ab5b455834faccba33f2a2235b9888c81"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#ab5b455834faccba33f2a2235b9888c81">ldmx::EcalHexReadout::getModuleID</a></div><div class="ttdeci">int getModuleID(double x, double y) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00126">EcalHexReadout.h:126</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a910aa8077878771e6b264ce5c804409c"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a910aa8077878771e6b264ce5c804409c">ldmx::EcalHexReadout::NNMap_</a></div><div class="ttdeci">std::map&lt; EcalID, std::vector&lt; EcalID &gt; &gt; NNMap_</div><div class="ttdoc">Map of cell ID to neighboring cells (uses ID with real cell and module and layer as zero for key)</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00453">EcalHexReadout.h:453</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a769854d7fb0c67df7e56f7a73c9bf207"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a769854d7fb0c67df7e56f7a73c9bf207">ldmx::EcalHexReadout::NNNMap_</a></div><div class="ttdeci">std::map&lt; EcalID, std::vector&lt; EcalID &gt; &gt; NNNMap_</div><div class="ttdoc">Map of cell ID to neighbors of neighbor cells (uses ID with real cell and module and layer as zero fo...</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00456">EcalHexReadout.h:456</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_ab42dd6bfd06539ace4bedfa6e5c6bfad"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#ab42dd6bfd06539ace4bedfa6e5c6bfad">ldmx::EcalHexReadout::buildCellMap</a></div><div class="ttdeci">void buildCellMap()</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8cxx_source.html#l00064">EcalHexReadout.cxx:64</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a1b24c37eeb6ad660963022e4758b92c5"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a1b24c37eeb6ad660963022e4758b92c5">ldmx::EcalHexReadout::getCellIDRelative</a></div><div class="ttdeci">int getCellIDRelative(double x, double y) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00154">EcalHexReadout.h:154</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a7ae3be71cc7980920b64eccf59b0c27d"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a7ae3be71cc7980920b64eccf59b0c27d">ldmx::EcalHexReadout::isEdgeCell</a></div><div class="ttdeci">bool isEdgeCell(EcalID cellModuleID) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00230">EcalHexReadout.h:230</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_af15a164a554997823d0a6ac5479dfab6"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#af15a164a554997823d0a6ac5479dfab6">ldmx::EcalHexReadout::ecalMap_</a></div><div class="ttdeci">TH2Poly ecalMap_</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00466">EcalHexReadout.h:466</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_aa411a6f3c759da91bd9ddda4ba1decb9"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#aa411a6f3c759da91bd9ddda4ba1decb9">ldmx::EcalHexReadout::cellr_</a></div><div class="ttdeci">double cellr_</div><div class="ttdoc">Center-to-Flat Radius of cell hexagon [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00417">EcalHexReadout.h:417</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_aba0999d9c878a1ac5746d1b1f8cd7856"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#aba0999d9c878a1ac5746d1b1f8cd7856">ldmx::EcalHexReadout::distanceToEdge</a></div><div class="ttdeci">double distanceToEdge(EcalID cellModuleID) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8cxx_source.html#l00298">EcalHexReadout.cxx:298</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_af6982db29300d9015cc04a7cbda3986c"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#af6982db29300d9015cc04a7cbda3986c">ldmx::EcalHexReadout::modulePositionMap_</a></div><div class="ttdeci">std::map&lt; int, std::pair&lt; double, double &gt; &gt; modulePositionMap_</div><div class="ttdoc">Postion of module centers relative to world geometry (uses module ID as key)</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00444">EcalHexReadout.h:444</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_aa8283a781129c83d72b4b05b411b4906"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#aa8283a781129c83d72b4b05b411b4906">ldmx::EcalHexReadout::gap_</a></div><div class="ttdeci">double gap_</div><div class="ttdoc">Gap between module flat sides [mm].</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00414">EcalHexReadout.h:414</a></div></div>
<div class="ttc" id="aclassldmx_1_1EcalHexReadout_html_a5293b7b33e0eea806b797069a7ca1ffb"><div class="ttname"><a href="classldmx_1_1EcalHexReadout.html#a5293b7b33e0eea806b797069a7ca1ffb">ldmx::EcalHexReadout::getCellModuleID</a></div><div class="ttdeci">EcalID getCellModuleID(double x, double y) const</div><div class="ttdef"><b>Definition:</b> <a href="EcalHexReadout_8h_source.html#l00192">EcalHexReadout.h:192</a></div></div>
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>