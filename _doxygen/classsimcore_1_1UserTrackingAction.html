<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.4"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: simcore::UserTrackingAction Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>simcore</b></li><li class="navelem"><a class="el" href="classsimcore_1_1UserTrackingAction.html">UserTrackingAction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classsimcore_1_1UserTrackingAction-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">simcore::UserTrackingAction Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of user tracking action.  
 <a href="classsimcore_1_1UserTrackingAction.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a126930d48e6a757f66bc8c4a149c7c87"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#a126930d48e6a757f66bc8c4a149c7c87">UserTrackingAction</a> ()</td></tr>
<tr class="separator:a126930d48e6a757f66bc8c4a149c7c87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7570fe4b624ccc777a1dfa1cb9805736"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#a7570fe4b624ccc777a1dfa1cb9805736">~UserTrackingAction</a> ()</td></tr>
<tr class="separator:a7570fe4b624ccc777a1dfa1cb9805736"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafb6a8edd8424efe0f0b947a21b1f028"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#aafb6a8edd8424efe0f0b947a21b1f028">PreUserTrackingAction</a> (const G4Track *aTrack)</td></tr>
<tr class="separator:aafb6a8edd8424efe0f0b947a21b1f028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ae902628d57aac26d44ff6d68eb3989"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#a4ae902628d57aac26d44ff6d68eb3989">PostUserTrackingAction</a> (const G4Track *aTrack)</td></tr>
<tr class="separator:a4ae902628d57aac26d44ff6d68eb3989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae575d192cc53a95e0c5b89747ec34de9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsimcore_1_1TrackMap.html">TrackMap</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#ae575d192cc53a95e0c5b89747ec34de9">getTrackMap</a> ()</td></tr>
<tr class="separator:ae575d192cc53a95e0c5b89747ec34de9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa116d231924299819bb1a29ba420673"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#aaa116d231924299819bb1a29ba420673">registerAction</a> (<a class="el" href="classsimcore_1_1UserAction.html">UserAction</a> *trackingAction)</td></tr>
<tr class="separator:aaa116d231924299819bb1a29ba420673"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a6efd3dfb00ba46fb8c0bf2292e09f0d9"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classsimcore_1_1UserTrackingAction.html">UserTrackingAction</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#a6efd3dfb00ba46fb8c0bf2292e09f0d9">getUserTrackingAction</a> ()</td></tr>
<tr class="separator:a6efd3dfb00ba46fb8c0bf2292e09f0d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae07ddbce260623ec715e20d88b34930c"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classsimcore_1_1UserAction.html">UserAction</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#ae07ddbce260623ec715e20d88b34930c">trackingActions_</a></td></tr>
<tr class="memdesc:ae07ddbce260623ec715e20d88b34930c"><td class="mdescLeft">&#160;</td><td class="mdescRight">custom user actions to be called before and after processing a track  <a href="classsimcore_1_1UserTrackingAction.html#ae07ddbce260623ec715e20d88b34930c">More...</a><br /></td></tr>
<tr class="separator:ae07ddbce260623ec715e20d88b34930c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5738593dd452d8b3b053829bd7be6fee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsimcore_1_1TrackMap.html">TrackMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1UserTrackingAction.html#a5738593dd452d8b3b053829bd7be6fee">trackMap_</a></td></tr>
<tr class="separator:a5738593dd452d8b3b053829bd7be6fee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Implementation of user tracking action. </p>
<p >Here, we manage the interaction between our track storage machinery (<a class="el" href="classsimcore_1_1TrackMap.html" title="Defines a map of particle ancestry and particles to be saved.">TrackMap</a>) and Geant4's tracking manager (G4TrackingManager). </p>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8h_source.html#l00036">36</a> of file <a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a126930d48e6a757f66bc8c4a149c7c87" name="a126930d48e6a757f66bc8c4a149c7c87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a126930d48e6a757f66bc8c4a149c7c87">&#9670;&nbsp;</a></span>UserTrackingAction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">simcore::UserTrackingAction::UserTrackingAction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Class constructor. </p>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8h_source.html#l00041">41</a> of file <a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7570fe4b624ccc777a1dfa1cb9805736" name="a7570fe4b624ccc777a1dfa1cb9805736"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7570fe4b624ccc777a1dfa1cb9805736">&#9670;&nbsp;</a></span>~UserTrackingAction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual simcore::UserTrackingAction::~UserTrackingAction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Class destructor. </p>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8h_source.html#l00046">46</a> of file <a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae575d192cc53a95e0c5b89747ec34de9" name="ae575d192cc53a95e0c5b89747ec34de9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae575d192cc53a95e0c5b89747ec34de9">&#9670;&nbsp;</a></span>getTrackMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsimcore_1_1TrackMap.html">TrackMap</a> * simcore::UserTrackingAction::getTrackMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Get a pointer to the current <a class="el" href="classsimcore_1_1TrackMap.html" title="Defines a map of particle ancestry and particles to be saved.">TrackMap</a> for the event. </p><dl class="section return"><dt>Returns</dt><dd>A pointer to the current <a class="el" href="classsimcore_1_1TrackMap.html" title="Defines a map of particle ancestry and particles to be saved.">TrackMap</a> for the event. </dd></dl>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8h_source.html#l00110">110</a> of file <a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  110</span>{ <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="classsimcore_1_1UserTrackingAction.html#a5738593dd452d8b3b053829bd7be6fee">trackMap_</a>; }</div>
<div class="ttc" id="aclasssimcore_1_1UserTrackingAction_html_a5738593dd452d8b3b053829bd7be6fee"><div class="ttname"><a href="classsimcore_1_1UserTrackingAction.html#a5738593dd452d8b3b053829bd7be6fee">simcore::UserTrackingAction::trackMap_</a></div><div class="ttdeci">TrackMap trackMap_</div><div class="ttdef"><b>Definition:</b> <a href="UserTrackingAction_8h_source.html#l00135">UserTrackingAction.h:135</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="UserTrackingAction_8h_source.html#l00135">trackMap_</a>.</p>

<p class="reference">Referenced by <a class="el" href="UserEventAction_8cxx_source.html#l00024">simcore::UserEventAction::BeginOfEventAction()</a>, <a class="el" href="RootPersistencyManager_8cxx_source.html#l00089">simcore::persist::RootPersistencyManager::buildEvent()</a>, <a class="el" href="DecayChildrenKeeper_8cxx_source.html#l00026">biasing::utility::DecayChildrenKeeper::PostUserTrackingAction()</a>, <a class="el" href="RootPersistencyManager_8cxx_source.html#l00204">simcore::persist::RootPersistencyManager::writeCalorimeterHitsCollection()</a>, and <a class="el" href="EcalHitIO_8cxx_source.html#l00019">simcore::EcalHitIO::writeHitsCollection()</a>.</p>

</div>
</div>
<a id="a6efd3dfb00ba46fb8c0bf2292e09f0d9" name="a6efd3dfb00ba46fb8c0bf2292e09f0d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6efd3dfb00ba46fb8c0bf2292e09f0d9">&#9670;&nbsp;</a></span>getUserTrackingAction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classsimcore_1_1UserTrackingAction.html">UserTrackingAction</a> * simcore::UserTrackingAction::getUserTrackingAction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Get a pointer to the current <a class="el" href="classsimcore_1_1UserTrackingAction.html" title="Implementation of user tracking action.">UserTrackingAction</a> from the G4RunManager. </p><dl class="section return"><dt>Returns</dt><dd>A pointer to the current <a class="el" href="classsimcore_1_1UserTrackingAction.html" title="Implementation of user tracking action.">UserTrackingAction</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8h_source.html#l00116">116</a> of file <a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  116</span>                                                     {</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><a class="code hl_function" href="classsimcore_1_1UserTrackingAction.html#a126930d48e6a757f66bc8c4a149c7c87">UserTrackingAction</a>*<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span>G4UserTrackingAction*<span class="keyword">&gt;</span>(</div>
<div class="line"><span class="lineno">  118</span>        G4RunManager::GetRunManager()-&gt;GetUserTrackingAction()));</div>
<div class="line"><span class="lineno">  119</span>  }</div>
<div class="ttc" id="aclasssimcore_1_1UserTrackingAction_html_a126930d48e6a757f66bc8c4a149c7c87"><div class="ttname"><a href="classsimcore_1_1UserTrackingAction.html#a126930d48e6a757f66bc8c4a149c7c87">simcore::UserTrackingAction::UserTrackingAction</a></div><div class="ttdeci">UserTrackingAction()</div><div class="ttdef"><b>Definition:</b> <a href="UserTrackingAction_8h_source.html#l00041">UserTrackingAction.h:41</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="UserEventAction_8cxx_source.html#l00024">simcore::UserEventAction::BeginOfEventAction()</a>, <a class="el" href="RootPersistencyManager_8cxx_source.html#l00089">simcore::persist::RootPersistencyManager::buildEvent()</a>, <a class="el" href="DecayChildrenKeeper_8cxx_source.html#l00026">biasing::utility::DecayChildrenKeeper::PostUserTrackingAction()</a>, <a class="el" href="RootPersistencyManager_8cxx_source.html#l00204">simcore::persist::RootPersistencyManager::writeCalorimeterHitsCollection()</a>, and <a class="el" href="EcalHitIO_8cxx_source.html#l00019">simcore::EcalHitIO::writeHitsCollection()</a>.</p>

</div>
</div>
<a id="a4ae902628d57aac26d44ff6d68eb3989" name="a4ae902628d57aac26d44ff6d68eb3989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ae902628d57aac26d44ff6d68eb3989">&#9670;&nbsp;</a></span>PostUserTrackingAction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simcore::UserTrackingAction::PostUserTrackingAction </td>
          <td>(</td>
          <td class="paramtype">const G4Track *&#160;</td>
          <td class="paramname"><em>aTrack</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Implementation of post-tracking action.</p>
<p >We start by calling any other tracking actions' PostUserTrackingAction methods.</p>
<p >If the track should be saved (it's save flag is set to true) and it is being stopped, then we save it in the track map.</p>
<dl class="section note"><dt>Note</dt><dd>This is where we make the final decision on if a particle should be saved into the output file.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classsimcore_1_1TrackMap.html#a987632720c8a4dcd34438445e48ecaa0">TrackMap::save</a> for how a G4Track is translated into our output SimParticle object.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aTrack</td><td>The Geant4 track. </td></tr>
  </table>
  </dd>
</dl>
<p >If a track is to-be saved and it is being killed, save the track into the map. This is where a track is chosen to be put into the output particle map. If its save flag is true <b>for any reason</b> at this point, then it will be in the output map.</p>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8cxx_source.html#l00067">67</a> of file <a class="el" href="UserTrackingAction_8cxx_source.html">UserTrackingAction.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span>                                                                    {</div>
<div class="line"><span class="lineno">   68</span>  <span class="comment">// Activate user tracking actions</span></div>
<div class="line"><span class="lineno">   69</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; trackingAction : <a class="code hl_variable" href="classsimcore_1_1UserTrackingAction.html#ae07ddbce260623ec715e20d88b34930c">trackingActions_</a>)</div>
<div class="line"><span class="lineno">   70</span>    trackingAction-&gt;PostUserTrackingAction(track);</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   79</span>  <span class="keyword">auto</span> track_info{<a class="code hl_function" href="classsimcore_1_1UserTrackInformation.html#a05d99ef5ad9cc9e31abcfb5505bc2b9e">UserTrackInformation::get</a>(track)};</div>
<div class="line"><span class="lineno">   80</span>  <span class="keywordflow">if</span> (track_info-&gt;getSaveFlag() and</div>
<div class="line"><span class="lineno">   81</span>      track-&gt;GetTrackStatus() == G4TrackStatus::fStopAndKill) {</div>
<div class="line"><span class="lineno">   82</span>    <a class="code hl_variable" href="classsimcore_1_1UserTrackingAction.html#a5738593dd452d8b3b053829bd7be6fee">trackMap_</a>.<a class="code hl_function" href="classsimcore_1_1TrackMap.html#a987632720c8a4dcd34438445e48ecaa0">save</a>(track);</div>
<div class="line"><span class="lineno">   83</span>  }</div>
<div class="line"><span class="lineno">   84</span>}</div>
<div class="ttc" id="aclasssimcore_1_1TrackMap_html_a987632720c8a4dcd34438445e48ecaa0"><div class="ttname"><a href="classsimcore_1_1TrackMap.html#a987632720c8a4dcd34438445e48ecaa0">simcore::TrackMap::save</a></div><div class="ttdeci">void save(const G4Track *track)</div><div class="ttdef"><b>Definition:</b> <a href="TrackMap_8cxx_source.html#l00032">TrackMap.cxx:32</a></div></div>
<div class="ttc" id="aclasssimcore_1_1UserTrackInformation_html_a05d99ef5ad9cc9e31abcfb5505bc2b9e"><div class="ttname"><a href="classsimcore_1_1UserTrackInformation.html#a05d99ef5ad9cc9e31abcfb5505bc2b9e">simcore::UserTrackInformation::get</a></div><div class="ttdeci">static UserTrackInformation * get(const G4Track *track)</div><div class="ttdef"><b>Definition:</b> <a href="UserTrackInformation_8cxx_source.html#l00010">UserTrackInformation.cxx:10</a></div></div>
<div class="ttc" id="aclasssimcore_1_1UserTrackingAction_html_ae07ddbce260623ec715e20d88b34930c"><div class="ttname"><a href="classsimcore_1_1UserTrackingAction.html#ae07ddbce260623ec715e20d88b34930c">simcore::UserTrackingAction::trackingActions_</a></div><div class="ttdeci">std::vector&lt; UserAction * &gt; trackingActions_</div><div class="ttdoc">custom user actions to be called before and after processing a track</div><div class="ttdef"><b>Definition:</b> <a href="UserTrackingAction_8h_source.html#l00132">UserTrackingAction.h:132</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="UserTrackInformation_8cxx_source.html#l00010">simcore::UserTrackInformation::get()</a>, <a class="el" href="TrackMap_8cxx_source.html#l00032">simcore::TrackMap::save()</a>, <a class="el" href="UserTrackingAction_8h_source.html#l00132">trackingActions_</a>, and <a class="el" href="UserTrackingAction_8h_source.html#l00135">trackMap_</a>.</p>

</div>
</div>
<a id="aafb6a8edd8424efe0f0b947a21b1f028" name="aafb6a8edd8424efe0f0b947a21b1f028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafb6a8edd8424efe0f0b947a21b1f028">&#9670;&nbsp;</a></span>PreUserTrackingAction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simcore::UserTrackingAction::PreUserTrackingAction </td>
          <td>(</td>
          <td class="paramtype">const G4Track *&#160;</td>
          <td class="paramname"><em>aTrack</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Implementation of pre-tracking action.</p>
<p >This is called whenever a track is going to start being processed.</p>
<dl class="section note"><dt>Note</dt><dd>A track could go through this function more than once in an event if it is suspended.</dd></dl>
<p>We first check if we have seen this track before by looking inside of our track map.</p>
<p >If we have seen it before, then we simply give the track to our PreUserTrackingActions.</p>
<p >If we haven't seen it before, then we must do some setup.</p><ul>
<li>Make an instance of <a class="el" href="classsimcore_1_1UserTrackInformation.html">UserTrackInformation</a> and attach it to the track after setting the initial momentum and vertex volume.</li>
<li>Using the gen status of the track and the region the track was produced in, decide if we will store the track by default. (Other user tracking actions can change the save flag in the track information.)</li>
</ul>
<p >We choose to store the track by default if any of the following are true about the track</p><ul>
<li>it is a primary (gen status is one)</li>
<li>it was created in a region without region info</li>
<li>it was created in a region where the 'StoreSecondaries' flag was set to true.</li>
</ul>
<p >No matter what, we insert the track into the track map for book-keeping.</p>
<p >Finally, before we wrap up, we call any other tracking actions' 'PreUserTrackingAction' methods.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">aTrack</td><td>The Geant4 track. </td></tr>
  </table>
  </dd>
</dl>
<p >Always save a particle if any of the following are true it has gen status == 1 (primary) it is in a region without region info it is in a region that is marked to store secondaries DON'T change the save-status even if these are false The track's save-status is false by default when the track-info is constructed and the track's save-status could have been modified by a user action <b>prior</b> to the track being processed for the first time. For example, this happens if the user wants to save the secondaries of a particular track.</p>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8cxx_source.html#l00018">18</a> of file <a class="el" href="UserTrackingAction_8cxx_source.html">UserTrackingAction.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   18</span>                                                                   {</div>
<div class="line"><span class="lineno">   19</span>  <span class="keywordflow">if</span> (not <a class="code hl_variable" href="classsimcore_1_1UserTrackingAction.html#a5738593dd452d8b3b053829bd7be6fee">trackMap_</a>.<a class="code hl_function" href="classsimcore_1_1TrackMap.html#a07e01d1ed897706a15a59fc7ecd42873">contains</a>(track)) {</div>
<div class="line"><span class="lineno">   20</span>    <span class="comment">// New Track</span></div>
<div class="line"><span class="lineno">   21</span>    </div>
<div class="line"><span class="lineno">   22</span>    <span class="comment">// get track information and initialize our new track</span></div>
<div class="line"><span class="lineno">   23</span>    <span class="comment">//  this will create a new track info object if it doesn&#39;t exist</span></div>
<div class="line"><span class="lineno">   24</span>    <span class="keyword">auto</span> track_info{<a class="code hl_function" href="classsimcore_1_1UserTrackInformation.html#a05d99ef5ad9cc9e31abcfb5505bc2b9e">UserTrackInformation::get</a>(track)};</div>
<div class="line"><span class="lineno">   25</span>    track_info-&gt;<a class="code hl_function" href="classsimcore_1_1UserTrackInformation.html#a64fc969470f9d22ddfb725403f585e1a">initialize</a>(track);</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>    <span class="comment">// Get the region info for where the track was created (could be NULL)</span></div>
<div class="line"><span class="lineno">   28</span>    <span class="keyword">auto</span> regionInfo = (UserRegionInformation*)track-&gt;GetLogicalVolumeAtVertex()</div>
<div class="line"><span class="lineno">   29</span>                          -&gt;GetRegion()</div>
<div class="line"><span class="lineno">   30</span>                          -&gt;GetUserInformation();</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>    <span class="comment">// Get the gen status if track was primary</span></div>
<div class="line"><span class="lineno">   33</span>    <span class="keywordtype">int</span> curGenStatus = -1;</div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordflow">if</span> (track-&gt;GetDynamicParticle()-&gt;GetPrimaryParticle()) {</div>
<div class="line"><span class="lineno">   35</span>      <span class="keyword">auto</span> primaryInfo = <span class="keyword">dynamic_cast&lt;</span>UserPrimaryParticleInformation*<span class="keyword">&gt;</span>(</div>
<div class="line"><span class="lineno">   36</span>          track-&gt;GetDynamicParticle()</div>
<div class="line"><span class="lineno">   37</span>              -&gt;GetPrimaryParticle()</div>
<div class="line"><span class="lineno">   38</span>              -&gt;GetUserInformation());</div>
<div class="line"><span class="lineno">   39</span>      curGenStatus = primaryInfo-&gt;getHepEvtStatus();</div>
<div class="line"><span class="lineno">   40</span>    }</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">if</span> (curGenStatus == 1 or !regionInfo or regionInfo-&gt;getStoreSecondaries()) {</div>
<div class="line"><span class="lineno">   55</span>      track_info-&gt;setSaveFlag(<span class="keyword">true</span>); </div>
<div class="line"><span class="lineno">   56</span>    }</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// insert this track into the event&#39;s track map</span></div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_variable" href="classsimcore_1_1UserTrackingAction.html#a5738593dd452d8b3b053829bd7be6fee">trackMap_</a>.<a class="code hl_function" href="classsimcore_1_1TrackMap.html#ada353df3b799ca06e53601d7c0eed577">insert</a>(track);</div>
<div class="line"><span class="lineno">   60</span>  }</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>  <span class="comment">// Activate user tracking actions</span></div>
<div class="line"><span class="lineno">   63</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; trackingAction : <a class="code hl_variable" href="classsimcore_1_1UserTrackingAction.html#ae07ddbce260623ec715e20d88b34930c">trackingActions_</a>)</div>
<div class="line"><span class="lineno">   64</span>    trackingAction-&gt;PreUserTrackingAction(track);</div>
<div class="line"><span class="lineno">   65</span>}</div>
<div class="ttc" id="aclasssimcore_1_1TrackMap_html_a07e01d1ed897706a15a59fc7ecd42873"><div class="ttname"><a href="classsimcore_1_1TrackMap.html#a07e01d1ed897706a15a59fc7ecd42873">simcore::TrackMap::contains</a></div><div class="ttdeci">bool contains(const G4Track *track) const</div><div class="ttdef"><b>Definition:</b> <a href="TrackMap_8h_source.html#l00040">TrackMap.h:40</a></div></div>
<div class="ttc" id="aclasssimcore_1_1TrackMap_html_ada353df3b799ca06e53601d7c0eed577"><div class="ttname"><a href="classsimcore_1_1TrackMap.html#ada353df3b799ca06e53601d7c0eed577">simcore::TrackMap::insert</a></div><div class="ttdeci">void insert(const G4Track *track)</div><div class="ttdef"><b>Definition:</b> <a href="TrackMap_8cxx_source.html#l00009">TrackMap.cxx:9</a></div></div>
<div class="ttc" id="aclasssimcore_1_1UserTrackInformation_html_a64fc969470f9d22ddfb725403f585e1a"><div class="ttname"><a href="classsimcore_1_1UserTrackInformation.html#a64fc969470f9d22ddfb725403f585e1a">simcore::UserTrackInformation::initialize</a></div><div class="ttdeci">void initialize(const G4Track *track)</div><div class="ttdef"><b>Definition:</b> <a href="UserTrackInformation_8cxx_source.html#l00017">UserTrackInformation.cxx:17</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackMap_8h_source.html#l00040">simcore::TrackMap::contains()</a>, <a class="el" href="UserTrackInformation_8cxx_source.html#l00010">simcore::UserTrackInformation::get()</a>, <a class="el" href="UserPrimaryParticleInformation_8h_source.html#l00042">simcore::UserPrimaryParticleInformation::getHepEvtStatus()</a>, <a class="el" href="UserTrackInformation_8cxx_source.html#l00017">simcore::UserTrackInformation::initialize()</a>, <a class="el" href="TrackMap_8cxx_source.html#l00009">simcore::TrackMap::insert()</a>, <a class="el" href="UserTrackingAction_8h_source.html#l00132">trackingActions_</a>, and <a class="el" href="UserTrackingAction_8h_source.html#l00135">trackMap_</a>.</p>

</div>
</div>
<a id="aaa116d231924299819bb1a29ba420673" name="aaa116d231924299819bb1a29ba420673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa116d231924299819bb1a29ba420673">&#9670;&nbsp;</a></span>registerAction()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void simcore::UserTrackingAction::registerAction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classsimcore_1_1UserAction.html">UserAction</a> *&#160;</td>
          <td class="paramname"><em>trackingAction</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Register a user action of type RunAction with this class.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">action</td><td>User action of type RunAction </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8h_source.html#l00126">126</a> of file <a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  126</span>                                                  {</div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_variable" href="classsimcore_1_1UserTrackingAction.html#ae07ddbce260623ec715e20d88b34930c">trackingActions_</a>.push_back(trackingAction);</div>
<div class="line"><span class="lineno">  128</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="UserTrackingAction_8h_source.html#l00132">trackingActions_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae07ddbce260623ec715e20d88b34930c" name="ae07ddbce260623ec715e20d88b34930c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae07ddbce260623ec715e20d88b34930c">&#9670;&nbsp;</a></span>trackingActions_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classsimcore_1_1UserAction.html">UserAction</a>*&gt; simcore::UserTrackingAction::trackingActions_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>custom user actions to be called before and after processing a track </p>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8h_source.html#l00132">132</a> of file <a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="UserTrackingAction_8cxx_source.html#l00067">PostUserTrackingAction()</a>, <a class="el" href="UserTrackingAction_8cxx_source.html#l00018">PreUserTrackingAction()</a>, and <a class="el" href="UserTrackingAction_8h_source.html#l00126">registerAction()</a>.</p>

</div>
</div>
<a id="a5738593dd452d8b3b053829bd7be6fee" name="a5738593dd452d8b3b053829bd7be6fee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5738593dd452d8b3b053829bd7be6fee">&#9670;&nbsp;</a></span>trackMap_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classsimcore_1_1TrackMap.html">TrackMap</a> simcore::UserTrackingAction::trackMap_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Stores parentage information for all tracks in the event. </p>

<p class="definition">Definition at line <a class="el" href="UserTrackingAction_8h_source.html#l00135">135</a> of file <a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="UserTrackingAction_8h_source.html#l00110">getTrackMap()</a>, <a class="el" href="UserTrackingAction_8cxx_source.html#l00067">PostUserTrackingAction()</a>, and <a class="el" href="UserTrackingAction_8cxx_source.html#l00018">PreUserTrackingAction()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>SimCore/include/SimCore/<a class="el" href="UserTrackingAction_8h_source.html">UserTrackingAction.h</a></li>
<li>SimCore/src/SimCore/<a class="el" href="UserTrackingAction_8cxx_source.html">UserTrackingAction.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>