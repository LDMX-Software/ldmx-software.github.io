<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.5"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: g4db::G4DarkBreMModel Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceg4db.html">g4db</a></li><li class="navelem"><a class="el" href="classg4db_1_1G4DarkBreMModel.html">G4DarkBreMModel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classg4db_1_1G4DarkBreMModel-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">g4db::G4DarkBreMModel Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a011b206417fc234c5f8c726be0c54faa"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faa">ScalingMethod</a> { <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">ForwardOnly</a> = 1
, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2">CMScaling</a> = 2
, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaaec0fc0100c4fc1ce4eea230c3dc10360">Undefined</a> = 3
 }</td></tr>
<tr class="separator:a011b206417fc234c5f8c726be0c54faa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bde7a6a38770c17ae3056a7a3e587af"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587af">XsecMethod</a> { <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">Full</a> = 1
, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">Improved</a> = 2
, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae723f214b18bf2adabfe484d4c65517d">HyperImproved</a> = 3
, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb">Auto</a> = 4
 }</td></tr>
<tr class="separator:a8bde7a6a38770c17ae3056a7a3e587af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad4038fb4f46ba16a2bfb829c5c81ea8c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#ad4038fb4f46ba16a2bfb829c5c81ea8c">G4DarkBreMModel</a> (const std::string &amp;library_path, bool muons, double threshold=0.0, double epsilon=1.0, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faa">ScalingMethod</a> sm=<a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">ScalingMethod::ForwardOnly</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587af">XsecMethod</a> xm=<a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb">XsecMethod::Auto</a>, double max_R_for_full=50.0, int aprime_lhe_id=622, bool load_library=true)</td></tr>
<tr class="separator:ad4038fb4f46ba16a2bfb829c5c81ea8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2ef7fbd9b88c050c8d04a226d906f81"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#ab2ef7fbd9b88c050c8d04a226d906f81">~G4DarkBreMModel</a> ()=default</td></tr>
<tr class="separator:ab2ef7fbd9b88c050c8d04a226d906f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2405e26a0cbdacf5c5f86173f3273e9a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a2405e26a0cbdacf5c5f86173f3273e9a">PrintInfo</a> () const</td></tr>
<tr class="separator:a2405e26a0cbdacf5c5f86173f3273e9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb47b4204cc4536334d9ccf9f8cb845f"><td class="memItemLeft" align="right" valign="top">virtual G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aeb47b4204cc4536334d9ccf9f8cb845f">ComputeCrossSectionPerAtom</a> (G4double lepton_ke, G4double atomicA, G4double atomicZ)</td></tr>
<tr class="separator:aeb47b4204cc4536334d9ccf9f8cb845f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea0e3784c4faff89fe84a53360f0951b"><td class="memItemLeft" align="right" valign="top">G4ThreeVector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aea0e3784c4faff89fe84a53360f0951b">scale</a> (double incident_energy, double lepton_mass)</td></tr>
<tr class="separator:aea0e3784c4faff89fe84a53360f0951b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af55e733c9b510ed0ced469afce610909"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#af55e733c9b510ed0ced469afce610909">GenerateChange</a> (G4ParticleChange &amp;particleChange, const G4Track &amp;track, const G4Step &amp;step)</td></tr>
<tr class="separator:af55e733c9b510ed0ced469afce610909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classg4db_1_1PrototypeModel"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classg4db_1_1PrototypeModel')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classg4db_1_1PrototypeModel.html">g4db::PrototypeModel</a></td></tr>
<tr class="memitem:ae2308897ed541c06804cab2a0a5049b6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#ae2308897ed541c06804cab2a0a5049b6">PrototypeModel</a> (bool muons)</td></tr>
<tr class="separator:ae2308897ed541c06804cab2a0a5049b6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae11ef65b539948079f2ccd0607bd3fe6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top"><a id="ae11ef65b539948079f2ccd0607bd3fe6" name="ae11ef65b539948079f2ccd0607bd3fe6"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><b>~PrototypeModel</b> ()=default</td></tr>
<tr class="memdesc:ae11ef65b539948079f2ccd0607bd3fe6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor, nothing on purpose. <br /></td></tr>
<tr class="separator:ae11ef65b539948079f2ccd0607bd3fe6 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05293e494288dec73e465fe0d30695eb inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#a05293e494288dec73e465fe0d30695eb">SetVerboseLevel</a> (int l)</td></tr>
<tr class="separator:a05293e494288dec73e465fe0d30695eb inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36ab543a94d5b8477022a82d05dba47 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#ae36ab543a94d5b8477022a82d05dba47">GetVerboseLevel</a> () const</td></tr>
<tr class="separator:ae36ab543a94d5b8477022a82d05dba47 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eb0ae8e1eeab01ac45f6a469919e422 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#a6eb0ae8e1eeab01ac45f6a469919e422">DarkBremOffMuons</a> () const</td></tr>
<tr class="separator:a6eb0ae8e1eeab01ac45f6a469919e422 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ceaa69cebb5968017b2a7c7e031e444 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#a5ceaa69cebb5968017b2a7c7e031e444">PrintInfo</a> () const =0</td></tr>
<tr class="separator:a5ceaa69cebb5968017b2a7c7e031e444 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae99722026388d768ba95bff9938fdf00 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">virtual G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#ae99722026388d768ba95bff9938fdf00">ComputeCrossSectionPerAtom</a> (G4double leptonKE, G4double atomicA, G4double atomicZ)=0</td></tr>
<tr class="separator:ae99722026388d768ba95bff9938fdf00 inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5023399bd69f3b9bc2ba611766ed069e inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#a5023399bd69f3b9bc2ba611766ed069e">GenerateChange</a> (G4ParticleChange &amp;particleChange, const G4Track &amp;track, const G4Step &amp;step)=0</td></tr>
<tr class="separator:a5023399bd69f3b9bc2ba611766ed069e inherit pub_methods_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5a6f5c8034689f581fd0c71f00e92edf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a5a6f5c8034689f581fd0c71f00e92edf">SetMadGraphDataLibrary</a> (const std::string &amp;path)</td></tr>
<tr class="separator:a5a6f5c8034689f581fd0c71f00e92edf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d43e129542b8392ff62d502d94894b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a97d43e129542b8392ff62d502d94894b">MakePlaceholders</a> ()</td></tr>
<tr class="separator:a97d43e129542b8392ff62d502d94894b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4ceed0b1888e8fdfd95b602bb771188"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structg4db_1_1OutgoingKinematics.html">OutgoingKinematics</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aa4ceed0b1888e8fdfd95b602bb771188">sample</a> (double incident_energy)</td></tr>
<tr class="separator:aa4ceed0b1888e8fdfd95b602bb771188"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:abaa436c1010f810fd563ff8d20df79ac"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">maxIterations_</a> {10000}</td></tr>
<tr class="separator:abaa436c1010f810fd563ff8d20df79ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a007e7af570949793604ada78c23508b5"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">threshold_</a></td></tr>
<tr class="separator:a007e7af570949793604ada78c23508b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9be5e8ea125fb12656415cde4ad6ce"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">epsilon_</a></td></tr>
<tr class="separator:a7a9be5e8ea125fb12656415cde4ad6ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36d578e5138bdba7aa44827555e0b09d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a36d578e5138bdba7aa44827555e0b09d">aprime_lhe_id_</a></td></tr>
<tr class="separator:a36d578e5138bdba7aa44827555e0b09d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affa7c9e1679f3e9b59a17aac12299137"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faa">ScalingMethod</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#affa7c9e1679f3e9b59a17aac12299137">scaling_method_</a></td></tr>
<tr class="separator:affa7c9e1679f3e9b59a17aac12299137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e687dc02358e48f90db39f1a180754d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587af">XsecMethod</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a></td></tr>
<tr class="separator:a5e687dc02358e48f90db39f1a180754d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d97e48c82feb83feae73a44bd1eb326"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a2d97e48c82feb83feae73a44bd1eb326">method_name_</a></td></tr>
<tr class="separator:a2d97e48c82feb83feae73a44bd1eb326"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa87a280a39e044f0053332e442729480"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aa87a280a39e044f0053332e442729480">library_path_</a></td></tr>
<tr class="separator:aa87a280a39e044f0053332e442729480"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4edd04498cddac54f2831e20514ca069"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a4edd04498cddac54f2831e20514ca069">alwaysCreateNewLepton_</a> {true}</td></tr>
<tr class="separator:a4edd04498cddac54f2831e20514ca069"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a466770b569c7cc2952dbff5a1f38de5c"><td class="memItemLeft" align="right" valign="top">std::map&lt; double, std::vector&lt; <a class="el" href="structg4db_1_1OutgoingKinematics.html">OutgoingKinematics</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">madGraphData_</a></td></tr>
<tr class="separator:a466770b569c7cc2952dbff5a1f38de5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d7f8e9c841d4b2990172567ae87745c"><td class="memItemLeft" align="right" valign="top">std::map&lt; double, unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">currentDataPoints_</a></td></tr>
<tr class="separator:a5d7f8e9c841d4b2990172567ae87745c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classg4db_1_1PrototypeModel"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classg4db_1_1PrototypeModel')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classg4db_1_1PrototypeModel.html">g4db::PrototypeModel</a></td></tr>
<tr class="memitem:a1b3c9e9bb255805a434ba7cf99edd961 inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#a1b3c9e9bb255805a434ba7cf99edd961">muons_</a></td></tr>
<tr class="memdesc:a1b3c9e9bb255805a434ba7cf99edd961 inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="mdescLeft">&#160;</td><td class="mdescRight">whether muons (true) or electrons (false) are dark bremming  <a href="classg4db_1_1PrototypeModel.html#a1b3c9e9bb255805a434ba7cf99edd961">More...</a><br /></td></tr>
<tr class="separator:a1b3c9e9bb255805a434ba7cf99edd961 inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a730ea81c1402e907fba494da8ac5581b inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classg4db_1_1PrototypeModel.html#a730ea81c1402e907fba494da8ac5581b">verbose_level_</a> {0}</td></tr>
<tr class="memdesc:a730ea81c1402e907fba494da8ac5581b inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="mdescLeft">&#160;</td><td class="mdescRight">verbose level for this model  <a href="classg4db_1_1PrototypeModel.html#a730ea81c1402e907fba494da8ac5581b">More...</a><br /></td></tr>
<tr class="separator:a730ea81c1402e907fba494da8ac5581b inherit pro_attribs_classg4db_1_1PrototypeModel"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Geant4 implementation of the model for a particle undergoing a dark brem where we use an imported event library to decide the outgoing kinematics.</p>
<p >This is where all the heavy lifting in terms of calculating cross sections and actually having a lepton do a dark brem occurs. This model depends on several configurable parameters which should be studied for your specific use case in order to better tune this model to your lepton/incident energy/ target material situation. </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00025">25</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="a011b206417fc234c5f8c726be0c54faa" name="a011b206417fc234c5f8c726be0c54faa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a011b206417fc234c5f8c726be0c54faa">&#9670;&#160;</a></span>ScalingMethod</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faa">g4db::G4DarkBreMModel::ScalingMethod</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Possible methods to use the dark brem events from the imported library inside of this model. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b" name="a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b"></a>ForwardOnly&#160;</td><td class="fielddoc"><p >Use actual lepton energy and get pT from LHE (such that <picture><source srcset="form_13_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T^2+m_l^2 &lt; E_{acc}^2$" src="form_13.png"/></picture>)</p>
<p >Scales the energy so that the fraction of kinetic energy is constant, keeping the <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T$" src="form_11.png"/></picture> constant.</p>
<p >If the <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T$" src="form_11.png"/></picture> is larger than the new energy, that event is skipped, and a new one is taken from the file. If the loaded library does not fully represent the range of incident energies being seen by the simulation, this will occur frequently.</p>
<p >With only the kinetic energy fraction and <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T$" src="form_11.png"/></picture>, the sign of the longitudinal momentum <picture><source srcset="form_14_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_z$" src="form_14.png"/></picture> is undetermined. This method simply chooses the <picture><source srcset="form_14_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_z$" src="form_14.png"/></picture> of the recoil lepton to always be positive. </p>
</td></tr>
<tr><td class="fieldname"><a id="a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2" name="a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2"></a>CMScaling&#160;</td><td class="fielddoc"><p >Boost LHE vertex momenta to the actual lepton energy</p>
<p >The scaling is done via two boosts.</p><ol type="1">
<li>Boost out of the center-of-momentum (CoM) frame read in along with the MadGraph event library.</li>
<li>Boost into approximately) the incident lepton energy frame by constructing a "new" CoM frame using the actual CoM frame's transverse momentum and lowering the <picture><source srcset="form_14_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_z$" src="form_14.png"/></picture> and energy of the CoM by the difference between the input incident energy and the sampled incident energy.</li>
</ol>
<p >After these boosts, the energy of the recoil and its <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T$" src="form_11.png"/></picture> are extracted. </p>
</td></tr>
<tr><td class="fieldname"><a id="a011b206417fc234c5f8c726be0c54faaaec0fc0100c4fc1ce4eea230c3dc10360" name="a011b206417fc234c5f8c726be0c54faaaec0fc0100c4fc1ce4eea230c3dc10360"></a>Undefined&#160;</td><td class="fielddoc"><p >Use LHE vertex as is</p>
<p >We simply copy the read-in recoil energy's energy, momentum, and <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T$" src="form_11.png"/></picture>. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00033">33</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   33</span>                           {</div>
<div class="line"><span class="lineno">   50</span>    <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">ForwardOnly</a> = 1,</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   67</span>    <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2">CMScaling</a> = 2,</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaaec0fc0100c4fc1ce4eea230c3dc10360">Undefined</a> = 3</div>
<div class="line"><span class="lineno">   74</span>  };</div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2">g4db::G4DarkBreMModel::ScalingMethod::CMScaling</a></div><div class="ttdeci">@ CMScaling</div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">g4db::G4DarkBreMModel::ScalingMethod::ForwardOnly</a></div><div class="ttdeci">@ ForwardOnly</div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a011b206417fc234c5f8c726be0c54faaaec0fc0100c4fc1ce4eea230c3dc10360"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaaec0fc0100c4fc1ce4eea230c3dc10360">g4db::G4DarkBreMModel::ScalingMethod::Undefined</a></div><div class="ttdeci">@ Undefined</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bde7a6a38770c17ae3056a7a3e587af" name="a8bde7a6a38770c17ae3056a7a3e587af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bde7a6a38770c17ae3056a7a3e587af">&#9670;&#160;</a></span>XsecMethod</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum class <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587af">g4db::G4DarkBreMModel::XsecMethod</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">strong</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Possible methods for calculating the xsec using the WW approximation technique.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespaceg4db.html#abeae992b175580d08a51d8ea7d1a8c45">flux_factor_chi_numerical</a> for how the flux factor is calculated Here, we refer to the flux factor as <picture><source srcset="form_0_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\chi(x,\theta)$" src="form_0.png"/></picture>. </dd>
<dd>
<a class="el" href="namespaceg4db.html#a6c0369bb92bc1335f0b5d7b99dbd1fe0">integrate</a> for how the numerical integrations are performed</dd></dl>
<p>As the methods are related, they share many variable definitions.</p>
<p class="formulaDsp">
<picture><source srcset="form_1_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation}
\tilde{u} = -xE_0^2\theta^2 - m_A^2\frac{1-x}{x} - m_\ell^2x
\end{equation}" src="form_1.png"/></picture>
</p>
<ul>
<li><picture><source srcset="form_2_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$x_{max} = 1 - \max(m_A,m_\ell)/E_0$" src="form_2.png"/></picture> is the upper limit on the x integration</li>
<li><picture><source srcset="form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$E_0$" src="form_3.png"/></picture> is the incoming lepton's energy in GeV</li>
<li><picture><source srcset="form_4_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$m_\ell$" src="form_4.png"/></picture> is the lepton's mass in GeV</li>
<li><picture><source srcset="form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$m_A$" src="form_5.png"/></picture> is the dark photon's mass in GeV</li>
<li><picture><source srcset="form_6_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\alpha_{EW} = 1/137$" src="form_6.png"/></picture> is the fine-structure constant</li>
<li><picture><source srcset="form_7_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\epsilon$" src="form_7.png"/></picture> is the dark photon mixsing strength with the standard photon</li>
<li><picture><source srcset="form_8_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$pb/GeV = 3.894\times10^8$" src="form_8.png"/></picture> is the conversion from GeV to pico-barns</li>
</ul>
<p >The integrand limits for <picture><source srcset="form_9_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\chi$" src="form_9.png"/></picture> are calculated as  </p><p class="formulaDsp">
<picture><source srcset="form_10_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation}
t_{min} = \left(\frac{\tilde{u}}{2E_0(1-x)}\right)^2 \qquad t_{max} = E_0^2
\end{equation}" src="form_10.png"/></picture>
</p>
 <table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75" name="a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75"></a>Full&#160;</td><td class="fielddoc"><p >use the full WW approximation</p>
<p >This is the 2D integration of a differential cross section including evaluating the flux factor chi numerically at each sampled x and theta. This effectively means we perform a 3D numerical integration when using this method.</p>
<p >It is slow but very faithful to the sampled MadGraph total cross section for high (&gt; 200 GeV) incident energies.</p>
<p class="formulaDsp">
<picture><source srcset="form_15_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation}
\sigma = \frac{pb}{GeV} \int_0^{x_{max}} \int_0^{0.3} \frac{d\sigma}{dx d\theta} d\theta~dx
\end{equation}" src="form_15.png"/></picture>
</p>
  <p class="formulaDsp">
<picture><source srcset="form_16_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation}
\frac{d\sigma}{dx~d\cos\theta} = 2 \alpha_{EW}^3\epsilon^2 \sqrt{x^2E_0^2 - m_A^2}E_0(1-x) 
    \frac{\chi(x,\theta)}{\tilde{u}^2} \mathcal{A}^2
\end{equation}" src="form_16.png"/></picture>
</p>
  <p class="formulaDsp">
<picture><source srcset="form_17_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation}
\mathcal{A}^2 = 2\frac{2-2x+x^2}{1-x}+\frac{4(m_A^2+2m_\ell^2)}{\tilde{u}^2}(\tilde{u}x + m_A^2(1-x) + m_\ell^2x^2)
\end{equation}" src="form_17.png"/></picture>
</p>
 </td></tr>
<tr><td class="fieldname"><a id="a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe" name="a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe"></a>Improved&#160;</td><td class="fielddoc"><p >assume <picture><source srcset="form_18_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\theta=0$" src="form_18.png"/></picture> in the integrand</p>
<p >This reduces one of the dimensions of the numerical integration, allowing the theta integration to be done analytically and so we only have a numerical integration over x and t</p>
<p class="formulaDsp">
<picture><source srcset="form_19_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation}
\sigma = \frac{pb}{GeV} \int_0^{x_{max}} \chi(x,\theta=0) \frac{d\sigma}{dx} dx
\end{equation}" src="form_19.png"/></picture>
</p>
  <p class="formulaDsp">
<picture><source srcset="form_20_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation}
\frac{d\sigma}{dx}(x) = 4 \alpha_{EW}^3\epsilon^2 \sqrt{1-\frac{m_A^2}{E_0^2}}\frac{1-x+x^2/3}{m_A^2(1-x)/x+m_\ell^2x}
\end{equation}" src="form_20.png"/></picture>
</p>
 </td></tr>
<tr><td class="fieldname"><a id="a8bde7a6a38770c17ae3056a7a3e587afae723f214b18bf2adabfe484d4c65517d" name="a8bde7a6a38770c17ae3056a7a3e587afae723f214b18bf2adabfe484d4c65517d"></a>HyperImproved&#160;</td><td class="fielddoc"><p >only calculate the flux factor once</p>
<p >This simplifies the numerical integration even further by calculating the flux factor chi only at <picture><source srcset="form_21_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$(x=1, \theta=0)$" src="form_21.png"/></picture> and then using that value everywhere in the integration of the differential cross section over x.</p>
<p class="formulaDsp">
<picture><source srcset="form_22_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaDsp" alt="\begin{equation}
\sigma = \frac{pb}{GeV} \chi(x=1,\theta=0) \int_0^{x_{max}} \frac{d\sigma}{dx} dx
\end{equation}" src="form_22.png"/></picture>
</p>
<p >where <picture><source srcset="form_23_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$d\sigma/dx$" src="form_23.png"/></picture> is the same as Improved. Since this uses the maximum value of <picture><source srcset="form_9_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\chi$" src="form_9.png"/></picture> for all values of <picture><source srcset="form_9_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$\chi$" src="form_9.png"/></picture>, we modify the upper limit of integration to avoid making this overestimate too much of an overestimate. Instead of <picture><source srcset="form_24_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$t_{max}=E_0^2$" src="form_24.png"/></picture> we use <picture><source srcset="form_25_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$t_{max}=m_A^2+m_\ell^2$" src="form_25.png"/></picture>. </p>
</td></tr>
<tr><td class="fieldname"><a id="a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb" name="a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb"></a>Auto&#160;</td><td class="fielddoc"><p >the default cross section calculation</p>
<p >This requires its own enum variant since it is determined by the <picture><source srcset="form_26_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$R = m_A/m_\ell$" src="form_26.png"/></picture> ratio as configured by other parameters.</p>
<p >If <picture><source srcset="form_27_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$R &lt; R_{max}$" src="form_27.png"/></picture>, Full is used while Improved is used otherwise. These boarders were determine qualitatively by looking at a series of cross section plots comparing all of these methods.</p>
<p >The parameter <picture><source srcset="form_28_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$R_{max}$" src="form_28.png"/></picture> is configurable in <a class="el" href="classg4db_1_1G4DarkBreMModel.html#ad4038fb4f46ba16a2bfb829c5c81ea8c">G4DarkBreMModel::G4DarkBreMModel</a> as max_R_for_full. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00105">105</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  105</span>                        {</div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">Full</a> = 1,</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">Improved</a> = 2,</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  164</span>    <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae723f214b18bf2adabfe484d4c65517d">HyperImproved</a> = 3,</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  179</span>    <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb">Auto</a> = 4</div>
<div class="line"><span class="lineno">  180</span>  };</div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb">g4db::G4DarkBreMModel::XsecMethod::Auto</a></div><div class="ttdeci">@ Auto</div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">g4db::G4DarkBreMModel::XsecMethod::Full</a></div><div class="ttdeci">@ Full</div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">g4db::G4DarkBreMModel::XsecMethod::Improved</a></div><div class="ttdeci">@ Improved</div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a8bde7a6a38770c17ae3056a7a3e587afae723f214b18bf2adabfe484d4c65517d"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae723f214b18bf2adabfe484d4c65517d">g4db::G4DarkBreMModel::XsecMethod::HyperImproved</a></div><div class="ttdeci">@ HyperImproved</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad4038fb4f46ba16a2bfb829c5c81ea8c" name="ad4038fb4f46ba16a2bfb829c5c81ea8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4038fb4f46ba16a2bfb829c5c81ea8c">&#9670;&#160;</a></span>G4DarkBreMModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">g4db::G4DarkBreMModel::G4DarkBreMModel </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>library_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>muons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>epsilon</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faa">ScalingMethod</a>&#160;</td>
          <td class="paramname"><em>sm</em> = <code><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">ScalingMethod::ForwardOnly</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587af">XsecMethod</a>&#160;</td>
          <td class="paramname"><em>xm</em> = <code><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb">XsecMethod::Auto</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>max_R_for_full</em> = <code>50.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>aprime_lhe_id</em> = <code>622</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>load_library</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Set the parameters for this model.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">library_path</td><td>full path to MG library The library path is immediately passed to <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a5a6f5c8034689f581fd0c71f00e92edf">G4DarkBreMModel::SetMadGraphDataLibrary</a> which simply calls <a class="el" href="namespaceg4db.html#a35fb2e67c162103f16baf7a5463d235d">g4db::parseLibrary</a> (where you should look for the specification options of a dark brem library). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">muons</td><td>true if using muons, false for electrons </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">threshold</td><td>minimum energy lepton needs to have to dark brem [GeV] (overwritten by twice the A' mass if it is less so that it kinematically makes sense). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">epsilon</td><td>dark photon mixing strength </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sm</td><td><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faa">G4DarkBreMModel::ScalingMethod</a> on how to scale the events in the library </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xm</td><td><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587af">G4DarkBreMModel::XsecMethod</a> on calculating the total cross section </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_R_for_full</td><td>maximum value of R where Full will still be used <b>Only used with</b> <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb">G4DarkBreMModel::XsecMethod::Auto</a> (go there for context) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aprime_lhe_id</td><td>PDG ID number for the dark photon in the LHE files being loaded for the library. <b>Only used if parsing LHE files.</b> </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">load_library</td><td>only used in cross section executable where it is known that the library will not be used during program run </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00141">141</a> of file <a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  151</span>    : <a class="code hl_function" href="classg4db_1_1PrototypeModel.html#ae2308897ed541c06804cab2a0a5049b6">PrototypeModel</a>(muons), <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">maxIterations_</a>{10000}, </div>
<div class="line"><span class="lineno">  152</span>      <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">threshold_</a>{std::max(threshold, 2.*<a class="code hl_function" href="classG4APrime.html#a1836c6a175d89e8244410f7a1ddd99ce">G4APrime::APrime</a>()-&gt;GetPDGMass()/CLHEP::GeV)},</div>
<div class="line"><span class="lineno">  153</span>      <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">epsilon_</a>{epsilon}, <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a36d578e5138bdba7aa44827555e0b09d">aprime_lhe_id_</a>{aprime_lhe_id},</div>
<div class="line"><span class="lineno">  154</span>      <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#affa7c9e1679f3e9b59a17aac12299137">scaling_method_</a>{scaling_method}, <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a>{xsec_method},</div>
<div class="line"><span class="lineno">  155</span>      <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#aa87a280a39e044f0053332e442729480">library_path_</a>{library_path} {</div>
<div class="line"><span class="lineno">  156</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb">XsecMethod::Auto</a>) {</div>
<div class="line"><span class="lineno">  157</span>    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> MA = <a class="code hl_function" href="classG4APrime.html#a1836c6a175d89e8244410f7a1ddd99ce">G4APrime::APrime</a>()-&gt;GetPDGMass() / GeV;</div>
<div class="line"><span class="lineno">  158</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> lepton_mass{(<a class="code hl_variable" href="classg4db_1_1PrototypeModel.html#a1b3c9e9bb255805a434ba7cf99edd961">muons_</a> </div>
<div class="line"><span class="lineno">  159</span>       ? G4MuonMinus::MuonMinus()-&gt;GetPDGMass() </div>
<div class="line"><span class="lineno">  160</span>       : G4Electron::Electron()-&gt;GetPDGMass()</div>
<div class="line"><span class="lineno">  161</span>      ) / GeV};</div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordtype">double</span> mass_ratio = MA/lepton_mass;</div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">if</span> (mass_ratio &lt; max_R_for_full) {</div>
<div class="line"><span class="lineno">  164</span>      <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a> = <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">XsecMethod::Full</a>;</div>
<div class="line"><span class="lineno">  165</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  166</span>      <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a> = <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">XsecMethod::Improved</a>;</div>
<div class="line"><span class="lineno">  167</span>    }</div>
<div class="line"><span class="lineno">  168</span>  }</div>
<div class="line"><span class="lineno">  169</span>  <span class="keywordflow">if</span> (load_library) <a class="code hl_function" href="classg4db_1_1G4DarkBreMModel.html#a5a6f5c8034689f581fd0c71f00e92edf">SetMadGraphDataLibrary</a>(<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#aa87a280a39e044f0053332e442729480">library_path_</a>);</div>
<div class="line"><span class="lineno">  170</span>}</div>
<div class="ttc" id="aclassG4APrime_html_a1836c6a175d89e8244410f7a1ddd99ce"><div class="ttname"><a href="classG4APrime.html#a1836c6a175d89e8244410f7a1ddd99ce">G4APrime::APrime</a></div><div class="ttdeci">static G4APrime * APrime()</div><div class="ttdef"><b>Definition:</b> <a href="G4APrime_8cxx_source.html#l00015">G4APrime.cxx:15</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a007e7af570949793604ada78c23508b5"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">g4db::G4DarkBreMModel::threshold_</a></div><div class="ttdeci">double threshold_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00346">G4DarkBreMModel.h:346</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a36d578e5138bdba7aa44827555e0b09d"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a36d578e5138bdba7aa44827555e0b09d">g4db::G4DarkBreMModel::aprime_lhe_id_</a></div><div class="ttdeci">int aprime_lhe_id_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00364">G4DarkBreMModel.h:364</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a5a6f5c8034689f581fd0c71f00e92edf"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a5a6f5c8034689f581fd0c71f00e92edf">g4db::G4DarkBreMModel::SetMadGraphDataLibrary</a></div><div class="ttdeci">void SetMadGraphDataLibrary(const std::string &amp;path)</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8cxx_source.html#l00497">G4DarkBreMModel.cxx:497</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a5e687dc02358e48f90db39f1a180754d"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">g4db::G4DarkBreMModel::xsec_method_</a></div><div class="ttdeci">XsecMethod xsec_method_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00374">G4DarkBreMModel.h:374</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a7a9be5e8ea125fb12656415cde4ad6ce"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">g4db::G4DarkBreMModel::epsilon_</a></div><div class="ttdeci">double epsilon_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00355">G4DarkBreMModel.h:355</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_aa87a280a39e044f0053332e442729480"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#aa87a280a39e044f0053332e442729480">g4db::G4DarkBreMModel::library_path_</a></div><div class="ttdeci">std::string library_path_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00384">G4DarkBreMModel.h:384</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_abaa436c1010f810fd563ff8d20df79ac"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">g4db::G4DarkBreMModel::maxIterations_</a></div><div class="ttdeci">unsigned int maxIterations_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00338">G4DarkBreMModel.h:338</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_affa7c9e1679f3e9b59a17aac12299137"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#affa7c9e1679f3e9b59a17aac12299137">g4db::G4DarkBreMModel::scaling_method_</a></div><div class="ttdeci">ScalingMethod scaling_method_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00369">G4DarkBreMModel.h:369</a></div></div>
<div class="ttc" id="aclassg4db_1_1PrototypeModel_html_a1b3c9e9bb255805a434ba7cf99edd961"><div class="ttname"><a href="classg4db_1_1PrototypeModel.html#a1b3c9e9bb255805a434ba7cf99edd961">g4db::PrototypeModel::muons_</a></div><div class="ttdeci">bool muons_</div><div class="ttdoc">whether muons (true) or electrons (false) are dark bremming</div><div class="ttdef"><b>Definition:</b> <a href="PrototypeModel_8h_source.html#l00119">PrototypeModel.h:119</a></div></div>
<div class="ttc" id="aclassg4db_1_1PrototypeModel_html_ae2308897ed541c06804cab2a0a5049b6"><div class="ttname"><a href="classg4db_1_1PrototypeModel.html#ae2308897ed541c06804cab2a0a5049b6">g4db::PrototypeModel::PrototypeModel</a></div><div class="ttdeci">PrototypeModel(bool muons)</div><div class="ttdef"><b>Definition:</b> <a href="PrototypeModel_8h_source.html#l00039">PrototypeModel.h:39</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4APrime_8cxx_source.html#l00015">G4APrime::APrime()</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afa06b9281e396db002010bde1de57262eb">Auto</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">Full</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">Improved</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00384">library_path_</a>, <a class="el" href="PrototypeModel_8h_source.html#l00119">g4db::PrototypeModel::muons_</a>, <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00497">SetMadGraphDataLibrary()</a>, and <a class="el" href="G4DarkBreMModel_8h_source.html#l00374">xsec_method_</a>.</p>

</div>
</div>
<a id="ab2ef7fbd9b88c050c8d04a226d906f81" name="ab2ef7fbd9b88c050c8d04a226d906f81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2ef7fbd9b88c050c8d04a226d906f81">&#9670;&#160;</a></span>~G4DarkBreMModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual g4db::G4DarkBreMModel::~G4DarkBreMModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Destructor </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aeb47b4204cc4536334d9ccf9f8cb845f" name="aeb47b4204cc4536334d9ccf9f8cb845f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb47b4204cc4536334d9ccf9f8cb845f">&#9670;&#160;</a></span>ComputeCrossSectionPerAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double g4db::G4DarkBreMModel::ComputeCrossSectionPerAtom </td>
          <td>(</td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>lepton_ke</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>atomicA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>atomicZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Calculates the cross section per atom in GEANT4 internal units.</p>
<p >The estimate for the total cross section given the material and the lepton's energy is done using an implementation of the WW approximation using Boost's Math Quadrature library to numerically calculate the integrals.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587af">XsecMethod</a> for the different methods of calculating the cross section.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lepton_ke</td><td>kinetic energy of incoming particle </td></tr>
    <tr><td class="paramname">atomicZ</td><td>atomic number of atom </td></tr>
    <tr><td class="paramname">atomicA</td><td>atomic mass of atom </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>cross section (0. if outside energy cuts) </dd></dl>

<p>Implements <a class="el" href="classg4db_1_1PrototypeModel.html#ae99722026388d768ba95bff9938fdf00">g4db::PrototypeModel</a>.</p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00197">197</a> of file <a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  198</span>                                                {</div>
<div class="line"><span class="lineno">  199</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> MA = <a class="code hl_function" href="classG4APrime.html#a1836c6a175d89e8244410f7a1ddd99ce">G4APrime::APrime</a>()-&gt;GetPDGMass() / GeV;</div>
<div class="line"><span class="lineno">  200</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> MA2 = MA*MA;</div>
<div class="line"><span class="lineno">  201</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> alphaEW = 1.0 / 137.0;</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> lepton_mass{</div>
<div class="line"><span class="lineno">  204</span>    (<a class="code hl_variable" href="classg4db_1_1PrototypeModel.html#a1b3c9e9bb255805a434ba7cf99edd961">muons_</a> ? G4MuonMinus::MuonMinus()-&gt;GetPDGMass() : G4Electron::Electron()-&gt;GetPDGMass()) / GeV};</div>
<div class="line"><span class="lineno">  205</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> lepton_mass_sq{lepton_mass*lepton_mass};</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>  <span class="comment">// the cross section is zero if the lepton does not have enough</span></div>
<div class="line"><span class="lineno">  208</span>  <span class="comment">// energy to create an A&#39;</span></div>
<div class="line"><span class="lineno">  209</span>  <span class="comment">// the threshold_ can also be set by the user to a higher value</span></div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">// to prevent dark-brem within inaccessible regions of phase</span></div>
<div class="line"><span class="lineno">  211</span>  <span class="comment">// space</span></div>
<div class="line"><span class="lineno">  212</span>  <span class="keywordflow">if</span> (lepton_ke &lt; keV or lepton_ke &lt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">threshold_</a>*GeV) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  <span class="comment">// Change energy to GeV.</span></div>
<div class="line"><span class="lineno">  215</span>  <span class="keywordtype">double</span> lepton_e = lepton_ke/GeV + lepton_mass;</div>
<div class="line"><span class="lineno">  216</span>  <span class="keywordtype">double</span> lepton_e_sq = lepton_e*lepton_e;</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>  <span class="comment">// deduce integral bounds</span></div>
<div class="line"><span class="lineno">  219</span>  <span class="keywordtype">double</span> xmin = 0;</div>
<div class="line"><span class="lineno">  220</span>  <span class="keywordtype">double</span> xmax = 1 - std::max(lepton_mass,MA) / lepton_e;</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>  <span class="keywordtype">double</span> integrated_xsec{-1};</div>
<div class="line"><span class="lineno">  223</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">XsecMethod::Full</a>) {</div>
<div class="line"><span class="lineno">  224</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  225</span><span class="comment">     * max recoil angle of A&#39;</span></div>
<div class="line"><span class="lineno">  226</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno">  227</span><span class="comment">     * The wide angle A&#39; are produced at a negligible rate</span></div>
<div class="line"><span class="lineno">  228</span><span class="comment">     * so we enforce a hard-coded cut-off to stay within</span></div>
<div class="line"><span class="lineno">  229</span><span class="comment">     * the small-angle regime.</span></div>
<div class="line"><span class="lineno">  230</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno">  231</span><span class="comment">     * We choose the same cutoff as DMG4.</span></div>
<div class="line"><span class="lineno">  232</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordtype">double</span> theta_max{0.3};</div>
<div class="line"><span class="lineno">  234</span>    </div>
<div class="line"><span class="lineno">  235</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  236</span><span class="comment">     * Differential cross section with respect to x and theta</span></div>
<div class="line"><span class="lineno">  237</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno">  238</span><span class="comment">     * Equation (16) from Appendix A of https://arxiv.org/pdf/2101.12192.pdf</span></div>
<div class="line"><span class="lineno">  239</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno">  240</span><span class="comment">     * This `auto` represents a lambda-expression function, inheriting many</span></div>
<div class="line"><span class="lineno">  241</span><span class="comment">     * pre-calculated constants (like lepton_e and chi) while also calculating</span></div>
<div class="line"><span class="lineno">  242</span><span class="comment">     * the variables dependent on the integration variables. The return value</span></div>
<div class="line"><span class="lineno">  243</span><span class="comment">     * of this function is a double since it is calculated by arithmetic</span></div>
<div class="line"><span class="lineno">  244</span><span class="comment">     * operations on doubles.</span></div>
<div class="line"><span class="lineno">  245</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  246</span>    <span class="keyword">auto</span> diff_cross = [&amp;](<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> theta) {</div>
<div class="line"><span class="lineno">  247</span>      <span class="keywordflow">if</span> (x*lepton_e &lt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">threshold_</a>) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  248</span>  </div>
<div class="line"><span class="lineno">  249</span>      <span class="keywordtype">double</span> theta_sq = theta*theta;</div>
<div class="line"><span class="lineno">  250</span>      <span class="keywordtype">double</span> x_sq = x*x;</div>
<div class="line"><span class="lineno">  251</span>  </div>
<div class="line"><span class="lineno">  252</span>      <span class="keywordtype">double</span> utilde = -x*lepton_e_sq*theta_sq - MA2*(1.-x)/x - lepton_mass_sq*x;</div>
<div class="line"><span class="lineno">  253</span>      <span class="keywordtype">double</span> utilde_sq = utilde*utilde;</div>
<div class="line"><span class="lineno">  254</span>  </div>
<div class="line"><span class="lineno">  255</span>      <span class="comment">// non-zero theta and non-zero m_l</span></div>
<div class="line"><span class="lineno">  256</span>      <span class="keywordtype">double</span> tmin = utilde_sq/(4.0*lepton_e_sq*(1.0-x)*(1.0-x));</div>
<div class="line"><span class="lineno">  257</span>      <span class="comment">// maximum t kinematically limited to the incident lepton energy</span></div>
<div class="line"><span class="lineno">  258</span>      <span class="keywordtype">double</span> tmax = lepton_e_sq;</div>
<div class="line"><span class="lineno">  259</span>  </div>
<div class="line"><span class="lineno">  260</span>      <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  261</span><span class="comment">       * The chi integrand limits given by</span></div>
<div class="line"><span class="lineno">  262</span><span class="comment">       *</span></div>
<div class="line"><span class="lineno">  263</span><span class="comment">       * Eqs (3.20) and (A6) of</span></div>
<div class="line"><span class="lineno">  264</span><span class="comment">       * https://journals.aps.org/prd/pdf/10.1103/PhysRevD.8.3109</span></div>
<div class="line"><span class="lineno">  265</span><span class="comment">       * OR</span></div>
<div class="line"><span class="lineno">  266</span><span class="comment">       * Eqs (3.2) and (3.6) of </span></div>
<div class="line"><span class="lineno">  267</span><span class="comment">       * https://journals.aps.org/rmp/pdf/10.1103/RevModPhys.46.815</span></div>
<div class="line"><span class="lineno">  268</span><span class="comment">       *</span></div>
<div class="line"><span class="lineno">  269</span><span class="comment">       * to be</span></div>
<div class="line"><span class="lineno">  270</span><span class="comment">       *</span></div>
<div class="line"><span class="lineno">  271</span><span class="comment">       * tmax = m^2(1+l)^2</span></div>
<div class="line"><span class="lineno">  272</span><span class="comment">       * tmin = m^2 tmax / (2*E*x*(1-x))^2</span></div>
<div class="line"><span class="lineno">  273</span><span class="comment">       *</span></div>
<div class="line"><span class="lineno">  274</span><span class="comment">       * where</span></div>
<div class="line"><span class="lineno">  275</span><span class="comment">       *</span></div>
<div class="line"><span class="lineno">  276</span><span class="comment">       *  l = E^2x^2theta^2/m^2</span></div>
<div class="line"><span class="lineno">  277</span><span class="comment">       *  m is mass of dark photon</span></div>
<div class="line"><span class="lineno">  278</span><span class="comment">       *  E is the incident lepton energy</span></div>
<div class="line"><span class="lineno">  279</span><span class="comment">       * </span></div>
<div class="line"><span class="lineno">  280</span><span class="comment">       * were investigated in an attempt to control the numerical integration</span></div>
<div class="line"><span class="lineno">  281</span><span class="comment">       * of chi in the hopes that cutting the integral away from odd places</span></div>
<div class="line"><span class="lineno">  282</span><span class="comment">       * would be able to avoid the funky business. This was not successful,</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">       * but we are leaving them here in case a typo is found in the future</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">       * or the search is chosen to resume.</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">      double el = lepton_e_sq*x_sq*theta_sq/MA2;</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">      double tmax = MA2*pow(1 + el,2);</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">      double tmin = MA2*tmax / pow(2*lepton_e*x*(1-x),2);</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">       */</span></div>
<div class="line"><span class="lineno">  289</span>    </div>
<div class="line"><span class="lineno">  290</span>      <span class="comment">// require 0 &lt; tmin &lt; tmax to procede</span></div>
<div class="line"><span class="lineno">  291</span>      <span class="keywordflow">if</span> (tmin &lt; 0) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  292</span>      <span class="keywordflow">if</span> (tmax &lt; tmin) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  293</span>    </div>
<div class="line"><span class="lineno">  294</span>      <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">       * numerically integrate to calculate chi ourselves</span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">       */</span></div>
<div class="line"><span class="lineno">  297</span>      <span class="keywordtype">double</span> chi = <a class="code hl_function" href="namespaceg4db.html#abeae992b175580d08a51d8ea7d1a8c45">flux_factor_chi_numerical</a>(A,Z, tmin, tmax);</div>
<div class="line"><span class="lineno">  298</span>      </div>
<div class="line"><span class="lineno">  299</span>      <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">       * Amplitude squared is taken from </span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">       * Equation (17) from Appendix A of https://arxiv.org/pdf/2101.12192.pdf</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">       * with X = V</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">       */</span></div>
<div class="line"><span class="lineno">  304</span>      <span class="keywordtype">double</span> factor1 = 2.0*(2.0 - 2.*x + x_sq)/(1. - x);</div>
<div class="line"><span class="lineno">  305</span>      <span class="keywordtype">double</span> factor2 = 4.0*(MA2 + 2.0*lepton_mass_sq)/utilde_sq;</div>
<div class="line"><span class="lineno">  306</span>      <span class="keywordtype">double</span> factor3 = utilde*x + MA2*(1. - x) + lepton_mass_sq*x_sq;</div>
<div class="line"><span class="lineno">  307</span>      <span class="keywordtype">double</span> amplitude_sq = factor1 + factor2*factor3;</div>
<div class="line"><span class="lineno">  308</span>  </div>
<div class="line"><span class="lineno">  309</span>      <span class="keywordflow">return</span> 2.*pow(<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">epsilon_</a>,2.)*pow(alphaEW,3.)</div>
<div class="line"><span class="lineno">  310</span>               *sqrt(x_sq*lepton_e_sq - MA2)*lepton_e*(1.-x)</div>
<div class="line"><span class="lineno">  311</span>               *(chi/utilde_sq)*amplitude_sq*sin(theta);</div>
<div class="line"><span class="lineno">  312</span>    };</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    integrated_xsec = <a class="code hl_function" href="namespaceg4db.html#a6c0369bb92bc1335f0b5d7b99dbd1fe0">integrate</a>(</div>
<div class="line"><span class="lineno">  315</span>        [&amp;](<span class="keywordtype">double</span> x) {</div>
<div class="line"><span class="lineno">  316</span>          <span class="keyword">auto</span> theta_integrand = [&amp;](<span class="keywordtype">double</span> theta) {</div>
<div class="line"><span class="lineno">  317</span>            <span class="keywordflow">return</span> diff_cross(x, theta);</div>
<div class="line"><span class="lineno">  318</span>          };</div>
<div class="line"><span class="lineno">  319</span>          <span class="keywordflow">return</span> <a class="code hl_function" href="namespaceg4db.html#a6c0369bb92bc1335f0b5d7b99dbd1fe0">integrate</a>(theta_integrand, 0., theta_max);</div>
<div class="line"><span class="lineno">  320</span>        }, xmin, xmax);</div>
<div class="line"><span class="lineno">  321</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">XsecMethod::Improved</a>) {</div>
<div class="line"><span class="lineno">  322</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">     * do the theta integral analytically by neglecting</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">     * all theta terms in the integrand.</span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  326</span>    integrated_xsec = <a class="code hl_function" href="namespaceg4db.html#a6c0369bb92bc1335f0b5d7b99dbd1fe0">integrate</a>(</div>
<div class="line"><span class="lineno">  327</span>        [&amp;](<span class="keywordtype">double</span> x) {</div>
<div class="line"><span class="lineno">  328</span>          <span class="keywordflow">if</span> (x*lepton_e &lt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">threshold_</a>) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  329</span>          <span class="keywordtype">double</span> utilde = -MA2*(1.-x)/x -lepton_mass_sq*x;</div>
<div class="line"><span class="lineno">  330</span>          <span class="keywordtype">double</span> utilde_sq = utilde*utilde;</div>
<div class="line"><span class="lineno">  331</span>          <span class="comment">// non-zero theta and non-zero m_l</span></div>
<div class="line"><span class="lineno">  332</span>          <span class="keywordtype">double</span> tmin = utilde_sq/(4.0*lepton_e_sq*(1.0-x)*(1.0-x));</div>
<div class="line"><span class="lineno">  333</span>          <span class="comment">// maximum t kinematically limited to the incident lepton energy</span></div>
<div class="line"><span class="lineno">  334</span>          <span class="keywordtype">double</span> tmax = lepton_e_sq;</div>
<div class="line"><span class="lineno">  335</span>          <span class="comment">// require 0 &lt; tmin &lt; tmax to procede</span></div>
<div class="line"><span class="lineno">  336</span>          <span class="keywordflow">if</span> (tmin &lt; 0) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  337</span>          <span class="keywordflow">if</span> (tmax &lt; tmin) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  338</span>          <span class="keywordtype">double</span> chi = <a class="code hl_function" href="namespaceg4db.html#abeae992b175580d08a51d8ea7d1a8c45">flux_factor_chi_numerical</a>(A,Z,tmin,tmax);</div>
<div class="line"><span class="lineno">  339</span>          <span class="keywordtype">double</span> beta = sqrt(1 - MA2/lepton_e_sq),</div>
<div class="line"><span class="lineno">  340</span>                 nume = 1. - x + x*x/3.,</div>
<div class="line"><span class="lineno">  341</span>                 deno = MA2*(1-x)/x + lepton_mass_sq;</div>
<div class="line"><span class="lineno">  342</span>          <span class="keywordflow">return</span> 4*pow(<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">epsilon_</a>,2)*pow(alphaEW,3)*chi*beta*nume/deno;</div>
<div class="line"><span class="lineno">  343</span>        }, xmin, xmax);</div>
<div class="line"><span class="lineno">  344</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae723f214b18bf2adabfe484d4c65517d">XsecMethod::HyperImproved</a>) {</div>
<div class="line"><span class="lineno">  345</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  346</span><span class="comment">     * calculate chi once at x=1, theta=0 and then use it</span></div>
<div class="line"><span class="lineno">  347</span><span class="comment">     * everywhere in the integration over dsigma/dx</span></div>
<div class="line"><span class="lineno">  348</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno">  349</span><span class="comment">     * cut off the integration earlier than the lepton energy squared</span></div>
<div class="line"><span class="lineno">  350</span><span class="comment">     * so that this overestimate isn&#39;t too much of an overestimate.</span></div>
<div class="line"><span class="lineno">  351</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordtype">double</span> chi_hiww = <a class="code hl_function" href="namespaceg4db.html#abeae992b175580d08a51d8ea7d1a8c45">flux_factor_chi_numerical</a>(A,Z,</div>
<div class="line"><span class="lineno">  353</span>        MA2*MA2/(4*lepton_e_sq),MA2+lepton_mass_sq);</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>    integrated_xsec = <a class="code hl_function" href="namespaceg4db.html#a6c0369bb92bc1335f0b5d7b99dbd1fe0">integrate</a>(</div>
<div class="line"><span class="lineno">  356</span>        [&amp;](<span class="keywordtype">double</span> x) {</div>
<div class="line"><span class="lineno">  357</span>          <span class="keywordflow">if</span> (x*lepton_e &lt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">threshold_</a>) <span class="keywordflow">return</span> 0.;</div>
<div class="line"><span class="lineno">  358</span>          <span class="keywordtype">double</span> beta = sqrt(1 - MA2/lepton_e_sq),</div>
<div class="line"><span class="lineno">  359</span>                 nume = 1. - x + x*x/3.,</div>
<div class="line"><span class="lineno">  360</span>                 deno = MA2*(1-x)/x + lepton_mass_sq;</div>
<div class="line"><span class="lineno">  361</span>          <span class="keywordflow">return</span> 4*pow(<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">epsilon_</a>,2)*pow(alphaEW,3)*chi_hiww*beta*nume/deno;</div>
<div class="line"><span class="lineno">  362</span>        }, xmin, xmax);</div>
<div class="line"><span class="lineno">  363</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Unrecognized XsecMethod, should be set using the enum class.&quot;</span>);</div>
<div class="line"><span class="lineno">  365</span>  }</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>  <span class="keyword">static</span> <span class="keyword">const</span> G4double GeVtoPb = 3.894E08;</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  370</span><span class="comment">   * The integrated_xsec should be the correct value, we are just</span></div>
<div class="line"><span class="lineno">  371</span><span class="comment">   * converting it to Geant4&#39;s pb units here</span></div>
<div class="line"><span class="lineno">  372</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  373</span>  G4double cross = integrated_xsec * GeVtoPb * CLHEP::picobarn;</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>  <span class="keywordflow">if</span> (cross &lt; 0.) <span class="keywordflow">return</span> 0.;  <span class="comment">// safety check all the math</span></div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>  <span class="keywordflow">return</span> cross;</div>
<div class="line"><span class="lineno">  378</span>}</div>
<div class="ttc" id="anamespaceg4db_html_a6c0369bb92bc1335f0b5d7b99dbd1fe0"><div class="ttname"><a href="namespaceg4db.html#a6c0369bb92bc1335f0b5d7b99dbd1fe0">g4db::integrate</a></div><div class="ttdeci">static double integrate(IntegrandFunction F, double low, double high)</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8cxx_source.html#l00054">G4DarkBreMModel.cxx:54</a></div></div>
<div class="ttc" id="anamespaceg4db_html_abeae992b175580d08a51d8ea7d1a8c45"><div class="ttname"><a href="namespaceg4db.html#abeae992b175580d08a51d8ea7d1a8c45">g4db::flux_factor_chi_numerical</a></div><div class="ttdeci">static double flux_factor_chi_numerical(G4double A, G4double Z, double tmin, double tmax)</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8cxx_source.html#l00094">G4DarkBreMModel.cxx:94</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4APrime_8cxx_source.html#l00015">G4APrime::APrime()</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00355">epsilon_</a>, <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00094">g4db::flux_factor_chi_numerical()</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">Full</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae723f214b18bf2adabfe484d4c65517d">HyperImproved</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">Improved</a>, <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00054">g4db::integrate()</a>, <a class="el" href="PrototypeModel_8h_source.html#l00119">g4db::PrototypeModel::muons_</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00346">threshold_</a>, and <a class="el" href="G4DarkBreMModel_8h_source.html#l00374">xsec_method_</a>.</p>

</div>
</div>
<a id="af55e733c9b510ed0ced469afce610909" name="af55e733c9b510ed0ced469afce610909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af55e733c9b510ed0ced469afce610909">&#9670;&#160;</a></span>GenerateChange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void g4db::G4DarkBreMModel::GenerateChange </td>
          <td>(</td>
          <td class="paramtype">G4ParticleChange &amp;&#160;</td>
          <td class="paramname"><em>particleChange</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4Track &amp;&#160;</td>
          <td class="paramname"><em>track</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4Step &amp;&#160;</td>
          <td class="paramname"><em>step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Simulates the emission of a dark photon + lepton</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aea0e3784c4faff89fe84a53360f0951b">scale</a> for how the event library is sampled and scaled to the incident lepton's actual energy</dd></dl>
<p>After calling scale, we rotate the outgoing lepton's momentum to the frame of the incident particle and then calculate the dark photon's momentum such that three-momentum is conserved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">particleChange</td><td>structure holding changes to make to particle track </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">track</td><td>current track being processesed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">step</td><td>current step of the track </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classg4db_1_1PrototypeModel.html#a5023399bd69f3b9bc2ba611766ed069e">g4db::PrototypeModel</a>.</p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00448">448</a> of file <a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  450</span>                        {</div>
<div class="line"><span class="lineno">  451</span>  <span class="comment">// mass of incident lepton </span></div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordtype">double</span> Ml = track.GetDefinition()-&gt;GetPDGMass() / CLHEP::GeV;</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>  <span class="comment">// convert to energy units in LHE files [GeV]</span></div>
<div class="line"><span class="lineno">  455</span>  G4double incidentEnergy = step.GetPostStepPoint()-&gt;GetTotalEnergy()/CLHEP::GeV;</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>  G4ThreeVector recoilMomentum = <a class="code hl_function" href="classg4db_1_1G4DarkBreMModel.html#aea0e3784c4faff89fe84a53360f0951b">scale</a>(incidentEnergy, Ml);</div>
<div class="line"><span class="lineno">  458</span>  recoilMomentum.rotateUz(track.GetMomentumDirection());</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>  <span class="comment">// create g4dynamicparticle object for the dark photon.</span></div>
<div class="line"><span class="lineno">  461</span>  <span class="comment">// define its 3-momentum so we conserve 3-momentum with primary and recoil</span></div>
<div class="line"><span class="lineno">  462</span>  <span class="comment">// lepton NOTE: does _not_ take nucleus recoil into account</span></div>
<div class="line"><span class="lineno">  463</span>  G4ThreeVector darkPhotonMomentum =</div>
<div class="line"><span class="lineno">  464</span>      track.GetMomentum() - recoilMomentum;</div>
<div class="line"><span class="lineno">  465</span>  G4DynamicParticle *dphoton =</div>
<div class="line"><span class="lineno">  466</span>      <span class="keyword">new</span> G4DynamicParticle(<a class="code hl_function" href="classG4APrime.html#a1836c6a175d89e8244410f7a1ddd99ce">G4APrime::APrime</a>(), darkPhotonMomentum);</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>  <span class="comment">// stop tracking and create new secondary instead of primary</span></div>
<div class="line"><span class="lineno">  469</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a4edd04498cddac54f2831e20514ca069">alwaysCreateNewLepton_</a>) {</div>
<div class="line"><span class="lineno">  470</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  471</span><span class="comment">     * Create a new lepton in order to make it easier to extract </span></div>
<div class="line"><span class="lineno">  472</span><span class="comment">     * the outgoing sim-level dark brem kinematics.</span></div>
<div class="line"><span class="lineno">  473</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  474</span>    G4DynamicParticle *el = <span class="keyword">new</span> G4DynamicParticle(</div>
<div class="line"><span class="lineno">  475</span>        track.GetDefinition(), recoilMomentum);</div>
<div class="line"><span class="lineno">  476</span>    particleChange.SetNumberOfSecondaries(2);</div>
<div class="line"><span class="lineno">  477</span>    particleChange.AddSecondary(dphoton);</div>
<div class="line"><span class="lineno">  478</span>    particleChange.AddSecondary(el);</div>
<div class="line"><span class="lineno">  479</span>    particleChange.ProposeTrackStatus(fStopAndKill);</div>
<div class="line"><span class="lineno">  480</span>    <span class="comment">// continue tracking</span></div>
<div class="line"><span class="lineno">  481</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  482</span>    <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  483</span><span class="comment">     * just have primary lose energy (don&#39;t rename to different track ID)</span></div>
<div class="line"><span class="lineno">  484</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno">  485</span><span class="comment">     * This branch is untested and so we are not sure if it works as expected.</span></div>
<div class="line"><span class="lineno">  486</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno">  487</span>    particleChange.SetNumberOfSecondaries(1);</div>
<div class="line"><span class="lineno">  488</span>    particleChange.AddSecondary(dphoton);</div>
<div class="line"><span class="lineno">  489</span>    particleChange.ProposeMomentumDirection(recoilMomentum.unit());</div>
<div class="line"><span class="lineno">  490</span>    <span class="keywordtype">double</span> recoil_energy = sqrt(recoilMomentum.mag2()+Ml*Ml);</div>
<div class="line"><span class="lineno">  491</span>    <span class="comment">// energy of primary recoiling</span></div>
<div class="line"><span class="lineno">  492</span>    G4double finalKE = recoil_energy - Ml;</div>
<div class="line"><span class="lineno">  493</span>    particleChange.ProposeEnergy(finalKE);</div>
<div class="line"><span class="lineno">  494</span>  }</div>
<div class="line"><span class="lineno">  495</span>}</div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a4edd04498cddac54f2831e20514ca069"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a4edd04498cddac54f2831e20514ca069">g4db::G4DarkBreMModel::alwaysCreateNewLepton_</a></div><div class="ttdeci">bool alwaysCreateNewLepton_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00394">G4DarkBreMModel.h:394</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_aea0e3784c4faff89fe84a53360f0951b"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#aea0e3784c4faff89fe84a53360f0951b">g4db::G4DarkBreMModel::scale</a></div><div class="ttdeci">G4ThreeVector scale(double incident_energy, double lepton_mass)</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8cxx_source.html#l00380">G4DarkBreMModel.cxx:380</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4DarkBreMModel_8h_source.html#l00394">alwaysCreateNewLepton_</a>, <a class="el" href="G4APrime_8cxx_source.html#l00015">G4APrime::APrime()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00380">scale()</a>.</p>

</div>
</div>
<a id="a97d43e129542b8392ff62d502d94894b" name="a97d43e129542b8392ff62d502d94894b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97d43e129542b8392ff62d502d94894b">&#9670;&#160;</a></span>MakePlaceholders()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void g4db::G4DarkBreMModel::MakePlaceholders </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Fill vector of currentDataPoints_ with the same number of items as the madgraph data.</p>
<p >Randomly choose a starting point so that the simulation run isn't dependent on the order of the events as written in the LHE library. The random starting position is uniformly chosen using G4Uniform() so. The sample function will loop from the last event parsed back to the first event parsed so that the starting position does not matter.</p>
<p >In this function, we also update maxIterations_ so that it is equal to the smallest entry in the library (with a maximum of 10k). This saves time in the situation where an incorrect library was accidentally used and the simulation is looping through events attempting to find one that can fit its criteria. </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00531">531</a> of file <a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  531</span>                                       {</div>
<div class="line"><span class="lineno">  532</span>  <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">currentDataPoints_</a>.clear();</div>
<div class="line"><span class="lineno">  533</span>  <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">maxIterations_</a> = 10000;</div>
<div class="line"><span class="lineno">  534</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;iter : <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">madGraphData_</a>) {</div>
<div class="line"><span class="lineno">  535</span>    <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">currentDataPoints_</a>[iter.first] = int(G4UniformRand() * iter.second.size());</div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordflow">if</span> (iter.second.size() &lt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">maxIterations_</a>)</div>
<div class="line"><span class="lineno">  537</span>      <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">maxIterations_</a> = iter.second.size();</div>
<div class="line"><span class="lineno">  538</span>  }</div>
<div class="line"><span class="lineno">  539</span>}</div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a466770b569c7cc2952dbff5a1f38de5c"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">g4db::G4DarkBreMModel::madGraphData_</a></div><div class="ttdeci">std::map&lt; double, std::vector&lt; OutgoingKinematics &gt; &gt; madGraphData_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00403">G4DarkBreMModel.h:403</a></div></div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a5d7f8e9c841d4b2990172567ae87745c"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">g4db::G4DarkBreMModel::currentDataPoints_</a></div><div class="ttdeci">std::map&lt; double, unsigned int &gt; currentDataPoints_</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8h_source.html#l00414">G4DarkBreMModel.h:414</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4DarkBreMModel_8h_source.html#l00414">currentDataPoints_</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00403">madGraphData_</a>, and <a class="el" href="G4DarkBreMModel_8h_source.html#l00338">maxIterations_</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00497">SetMadGraphDataLibrary()</a>.</p>

</div>
</div>
<a id="a2405e26a0cbdacf5c5f86173f3273e9a" name="a2405e26a0cbdacf5c5f86173f3273e9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2405e26a0cbdacf5c5f86173f3273e9a">&#9670;&#160;</a></span>PrintInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void g4db::G4DarkBreMModel::PrintInfo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Print the configuration of this model </p>

<p>Implements <a class="el" href="classg4db_1_1PrototypeModel.html#a5ceaa69cebb5968017b2a7c7e031e444">g4db::PrototypeModel</a>.</p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00172">172</a> of file <a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  172</span>                                      {</div>
<div class="line"><span class="lineno">  173</span>  G4cout &lt;&lt; <span class="stringliteral">&quot; Dark Brem Vertex Library Model&quot;</span> &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  174</span>  G4cout &lt;&lt; <span class="stringliteral">&quot;   Threshold [GeV]: &quot;</span> &lt;&lt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a007e7af570949793604ada78c23508b5">threshold_</a> &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  175</span>  G4cout &lt;&lt; <span class="stringliteral">&quot;   Epsilon:         &quot;</span> &lt;&lt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a7a9be5e8ea125fb12656415cde4ad6ce">epsilon_</a> &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  176</span>  G4cout &lt;&lt; <span class="stringliteral">&quot;   Scaling Method:  &quot;</span>;</div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#affa7c9e1679f3e9b59a17aac12299137">scaling_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">ScalingMethod::ForwardOnly</a>) {</div>
<div class="line"><span class="lineno">  178</span>    G4cout &lt;&lt; <span class="stringliteral">&quot;ForwardOnly&quot;</span>;</div>
<div class="line"><span class="lineno">  179</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#affa7c9e1679f3e9b59a17aac12299137">scaling_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2">ScalingMethod::CMScaling</a>) {</div>
<div class="line"><span class="lineno">  180</span>    G4cout &lt;&lt; <span class="stringliteral">&quot;CMScaling&quot;</span>;</div>
<div class="line"><span class="lineno">  181</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  182</span>    G4cout &lt;&lt; <span class="stringliteral">&quot;Undefined&quot;</span>;</div>
<div class="line"><span class="lineno">  183</span>  }</div>
<div class="line"><span class="lineno">  184</span>  G4cout &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  185</span>  G4cout &lt;&lt; <span class="stringliteral">&quot;   Xsec Method:     &quot;</span>;</div>
<div class="line"><span class="lineno">  186</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">XsecMethod::Full</a>) {</div>
<div class="line"><span class="lineno">  187</span>    G4cout &lt;&lt; <span class="stringliteral">&quot;Full&quot;</span>;</div>
<div class="line"><span class="lineno">  188</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5e687dc02358e48f90db39f1a180754d">xsec_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">XsecMethod::Improved</a>) {</div>
<div class="line"><span class="lineno">  189</span>    G4cout &lt;&lt; <span class="stringliteral">&quot;Improved&quot;</span>;</div>
<div class="line"><span class="lineno">  190</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  191</span>    G4cout &lt;&lt; <span class="stringliteral">&quot;HyperImproved&quot;</span>;</div>
<div class="line"><span class="lineno">  192</span>  }</div>
<div class="line"><span class="lineno">  193</span>  G4cout &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  194</span>  G4cout &lt;&lt; <span class="stringliteral">&quot;   Vertex Library:  &quot;</span> &lt;&lt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#aa87a280a39e044f0053332e442729480">library_path_</a> &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  195</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2">CMScaling</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00355">epsilon_</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">ForwardOnly</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afabbd47109890259c0127154db1af26c75">Full</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587afae17310830c72d17857bf7df1ddf80dfe">Improved</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00384">library_path_</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00369">scaling_method_</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00346">threshold_</a>, and <a class="el" href="G4DarkBreMModel_8h_source.html#l00374">xsec_method_</a>.</p>

<p class="reference">Referenced by <a class="el" href="scale_8cxx_source.html#l00056">main()</a>.</p>

</div>
</div>
<a id="aa4ceed0b1888e8fdfd95b602bb771188" name="aa4ceed0b1888e8fdfd95b602bb771188"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4ceed0b1888e8fdfd95b602bb771188">&#9670;&#160;</a></span>sample()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structg4db_1_1OutgoingKinematics.html">OutgoingKinematics</a> g4db::G4DarkBreMModel::sample </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>incident_energy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Returns MadGraph data given an energy [GeV].</p>
<p >Gets the energy fraction and <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T$" src="form_11.png"/></picture> from the imported LHE data. incident_energy should be in GeV, returns the sample outgoing kinematics.</p>
<p >Samples from the closest imported incident energy <em>above</em> the given value (this helps avoid biasing issues).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">incident_energy</td><td>energy of particle undergoing dark brem [GeV] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>sample outgoing kinematics </dd></dl>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00542">542</a> of file <a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  542</span>                                              {</div>
<div class="line"><span class="lineno">  543</span>  <span class="comment">// Cycle through imported beam energies until the closest one above is found,</span></div>
<div class="line"><span class="lineno">  544</span>  <span class="comment">// or the max is reached.</span></div>
<div class="line"><span class="lineno">  545</span>  <span class="keywordtype">double</span> samplingE = 0.;</div>
<div class="line"><span class="lineno">  546</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;keyVal : <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">currentDataPoints_</a>) {</div>
<div class="line"><span class="lineno">  547</span>    samplingE = keyVal.first;  <span class="comment">// move samplingE up</span></div>
<div class="line"><span class="lineno">  548</span>    <span class="comment">// check if went under the sampling energy</span></div>
<div class="line"><span class="lineno">  549</span>    <span class="comment">//  the map is sorted by key, so we can be done right after E0 goes under</span></div>
<div class="line"><span class="lineno">  550</span>    <span class="comment">//  samplingE</span></div>
<div class="line"><span class="lineno">  551</span>    <span class="keywordflow">if</span> (incident_energy &lt; samplingE) <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  552</span>  }</div>
<div class="line"><span class="lineno">  553</span>  <span class="comment">// now samplingE is the closest energy above E0 or the maximum energy imported</span></div>
<div class="line"><span class="lineno">  554</span>  <span class="comment">// from mad graph</span></div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>  <span class="comment">// Need to loop around if we hit the end, in case our random</span></div>
<div class="line"><span class="lineno">  557</span>  <span class="comment">// starting position happens to be late enough in the file</span></div>
<div class="line"><span class="lineno">  558</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">currentDataPoints_</a>.at(samplingE) &gt;= <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">madGraphData_</a>.at(samplingE).size()) {</div>
<div class="line"><span class="lineno">  559</span>    <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">currentDataPoints_</a>[samplingE] = 0;</div>
<div class="line"><span class="lineno">  560</span>  }</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>  <span class="comment">// increment the current index _after_ getting its entry from</span></div>
<div class="line"><span class="lineno">  563</span>  <span class="comment">// the in-memory library</span></div>
<div class="line"><span class="lineno">  564</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">madGraphData_</a>.at(samplingE).at(<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a5d7f8e9c841d4b2990172567ae87745c">currentDataPoints_</a>[samplingE]++);</div>
<div class="line"><span class="lineno">  565</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4DarkBreMModel_8h_source.html#l00414">currentDataPoints_</a>, and <a class="el" href="G4DarkBreMModel_8h_source.html#l00403">madGraphData_</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00380">scale()</a>.</p>

</div>
</div>
<a id="aea0e3784c4faff89fe84a53360f0951b" name="aea0e3784c4faff89fe84a53360f0951b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea0e3784c4faff89fe84a53360f0951b">&#9670;&#160;</a></span>scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4ThreeVector g4db::G4DarkBreMModel::scale </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>incident_energy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lepton_mass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Scale one of the MG events in our library to the input incident lepton energy.</p>
<p >This is also helpful for testing the scaling procedure in its own executable separate from the Geant4 infrastructure.</p>
<dl class="section note"><dt>Note</dt><dd>The vector returned is relative to the incident lepton as if it came in along the z-axis.</dd></dl>
<p>Gets an energy fraction and transverse momentum ( <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T$" src="form_11.png"/></picture>) from the loaded library of MadGraph events using the entry in the library with the nearest incident energy above the actual input incident energy.</p>
<p >The scaling of this energy fraction and <picture><source srcset="form_11_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$p_T$" src="form_11.png"/></picture> to the actual lepton energy depends on the input <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faa">G4DarkBreMModel::ScalingMethod</a>. In all cases, the azimuthal angle is chosen uniformly between 0 and <picture><source srcset="form_12_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$2\pi$" src="form_12.png"/></picture>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">incident_energy</td><td>incident total energy of the lepton [GeV] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lepton_mass</td><td>mass of incident lepton [GeV] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>G4ThreeVector representing the recoil lepton's outgoing momentum </dd></dl>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00380">380</a> of file <a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  380</span>                                                                               {</div>
<div class="line"><span class="lineno">  381</span>  <span class="comment">// mass A&#39; in GeV</span></div>
<div class="line"><span class="lineno">  382</span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> MA = <a class="code hl_function" href="classG4APrime.html#a1836c6a175d89e8244410f7a1ddd99ce">G4APrime::APrime</a>()-&gt;GetPDGMass() / CLHEP::GeV;</div>
<div class="line"><span class="lineno">  383</span>  OutgoingKinematics data = <a class="code hl_function" href="classg4db_1_1G4DarkBreMModel.html#aa4ceed0b1888e8fdfd95b602bb771188">sample</a>(incident_energy);</div>
<div class="line"><span class="lineno">  384</span>  <span class="keywordtype">double</span> EAcc = (data.lepton.e() - lepton_mass) *</div>
<div class="line"><span class="lineno">  385</span>                    ((incident_energy - lepton_mass - MA) / (data.E - lepton_mass - MA))</div>
<div class="line"><span class="lineno">  386</span>                + lepton_mass;</div>
<div class="line"><span class="lineno">  387</span>  <span class="keywordtype">double</span> Pt = data.lepton.perp();</div>
<div class="line"><span class="lineno">  388</span>  <span class="keywordtype">double</span> P = sqrt(EAcc * EAcc - lepton_mass * lepton_mass);</div>
<div class="line"><span class="lineno">  389</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#affa7c9e1679f3e9b59a17aac12299137">scaling_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">ScalingMethod::ForwardOnly</a>) {</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">while</span> (Pt * Pt + lepton_mass * lepton_mass &gt; EAcc * EAcc) {</div>
<div class="line"><span class="lineno">  392</span>      <span class="comment">// Skip events until the transverse energy is less than the total energy.</span></div>
<div class="line"><span class="lineno">  393</span>      i++;</div>
<div class="line"><span class="lineno">  394</span>      data = <a class="code hl_function" href="classg4db_1_1G4DarkBreMModel.html#aa4ceed0b1888e8fdfd95b602bb771188">sample</a>(incident_energy);</div>
<div class="line"><span class="lineno">  395</span>      EAcc = (data.lepton.e() - lepton_mass) *</div>
<div class="line"><span class="lineno">  396</span>                 ((incident_energy - lepton_mass - MA) / (data.E - lepton_mass - MA))</div>
<div class="line"><span class="lineno">  397</span>             + lepton_mass;</div>
<div class="line"><span class="lineno">  398</span>      Pt = data.lepton.perp();</div>
<div class="line"><span class="lineno">  399</span>      P = sqrt(EAcc * EAcc - lepton_mass * lepton_mass);</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>      <span class="keywordflow">if</span> (i &gt; <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#abaa436c1010f810fd563ff8d20df79ac">maxIterations_</a>) {</div>
<div class="line"><span class="lineno">  402</span>        std::cerr</div>
<div class="line"><span class="lineno">  403</span>            &lt;&lt; <span class="stringliteral">&quot;Could not produce a realistic vertex with library energy &quot;</span></div>
<div class="line"><span class="lineno">  404</span>            &lt;&lt; data.lepton.e() &lt;&lt; <span class="stringliteral">&quot; GeV.\n&quot;</span></div>
<div class="line"><span class="lineno">  405</span>            &lt;&lt; <span class="stringliteral">&quot;Consider expanding your libary of A&#39; vertices to include a &quot;</span></div>
<div class="line"><span class="lineno">  406</span>               <span class="stringliteral">&quot;beam energy closer to &quot;</span></div>
<div class="line"><span class="lineno">  407</span>            &lt;&lt; incident_energy &lt;&lt; <span class="stringliteral">&quot; GeV.&quot;</span></div>
<div class="line"><span class="lineno">  408</span>            &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  409</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  410</span>      }</div>
<div class="line"><span class="lineno">  411</span>    }</div>
<div class="line"><span class="lineno">  412</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#affa7c9e1679f3e9b59a17aac12299137">scaling_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2">ScalingMethod::CMScaling</a>) {</div>
<div class="line"><span class="lineno">  413</span>    CLHEP::HepLorentzVector el(data.lepton.px(), data.lepton.py(), data.lepton.pz(),</div>
<div class="line"><span class="lineno">  414</span>                               data.lepton.e());</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordtype">double</span> ediff = data.E - incident_energy;</div>
<div class="line"><span class="lineno">  416</span>    CLHEP::HepLorentzVector newcm(data.centerMomentum.px(), data.centerMomentum.py(),</div>
<div class="line"><span class="lineno">  417</span>                                  data.centerMomentum.pz() - ediff,</div>
<div class="line"><span class="lineno">  418</span>                                  data.centerMomentum.e() - ediff);</div>
<div class="line"><span class="lineno">  419</span>    el.boost(-1. * data.centerMomentum.boostVector());</div>
<div class="line"><span class="lineno">  420</span>    el.boost(newcm.boostVector());</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordtype">double</span> newE = (data.lepton.e() - lepton_mass) *</div>
<div class="line"><span class="lineno">  422</span>                      ((incident_energy - lepton_mass - MA) / (data.E - lepton_mass - MA)) +</div>
<div class="line"><span class="lineno">  423</span>                  lepton_mass;</div>
<div class="line"><span class="lineno">  424</span>    el.setE(newE);</div>
<div class="line"><span class="lineno">  425</span>    EAcc = el.e();</div>
<div class="line"><span class="lineno">  426</span>    Pt = el.perp();</div>
<div class="line"><span class="lineno">  427</span>    P = el.vect().mag();</div>
<div class="line"><span class="lineno">  428</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#affa7c9e1679f3e9b59a17aac12299137">scaling_method_</a> == <a class="code hl_enumvalue" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaaec0fc0100c4fc1ce4eea230c3dc10360">ScalingMethod::Undefined</a>) {</div>
<div class="line"><span class="lineno">  429</span>    EAcc = data.lepton.e();</div>
<div class="line"><span class="lineno">  430</span>    P = sqrt(EAcc * EAcc - lepton_mass * lepton_mass);</div>
<div class="line"><span class="lineno">  431</span>    Pt = data.lepton.perp();</div>
<div class="line"><span class="lineno">  432</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  433</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Unrecognized ScalingMethod, should be set by using the enum class.&quot;</span>);</div>
<div class="line"><span class="lineno">  434</span>  }</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>  <span class="comment">// outgoing lepton momentum</span></div>
<div class="line"><span class="lineno">  437</span>  G4double PhiAcc = G4UniformRand()*2*pi;</div>
<div class="line"><span class="lineno">  438</span>  G4double recoilMag = sqrt(EAcc * EAcc - lepton_mass*lepton_mass)*GeV;</div>
<div class="line"><span class="lineno">  439</span>  G4ThreeVector recoil;</div>
<div class="line"><span class="lineno">  440</span>  <span class="keywordtype">double</span> ThetaAcc = std::asin(Pt / P);</div>
<div class="line"><span class="lineno">  441</span>  recoil.set(std::sin(ThetaAcc) * std::cos(PhiAcc),</div>
<div class="line"><span class="lineno">  442</span>                             std::sin(ThetaAcc) * std::sin(PhiAcc),</div>
<div class="line"><span class="lineno">  443</span>                             std::cos(ThetaAcc));</div>
<div class="line"><span class="lineno">  444</span>  recoil.setMag(recoilMag);</div>
<div class="line"><span class="lineno">  445</span>  <span class="keywordflow">return</span> recoil;</div>
<div class="line"><span class="lineno">  446</span>}</div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_aa4ceed0b1888e8fdfd95b602bb771188"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#aa4ceed0b1888e8fdfd95b602bb771188">g4db::G4DarkBreMModel::sample</a></div><div class="ttdeci">OutgoingKinematics sample(double incident_energy)</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8cxx_source.html#l00542">G4DarkBreMModel.cxx:542</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4APrime_8cxx_source.html#l00015">G4APrime::APrime()</a>, <a class="el" href="ParseLibrary_8h_source.html#l00026">g4db::OutgoingKinematics::centerMomentum</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaa109faf01533226d9e0f6dca82500baf2">CMScaling</a>, <a class="el" href="ParseLibrary_8h_source.html#l00028">g4db::OutgoingKinematics::E</a>, <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaabaf091bcacd081bc1e0c1fc65d43e09b">ForwardOnly</a>, <a class="el" href="ParseLibrary_8h_source.html#l00024">g4db::OutgoingKinematics::lepton</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00338">maxIterations_</a>, <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00542">sample()</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00369">scaling_method_</a>, and <a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faaaec0fc0100c4fc1ce4eea230c3dc10360">Undefined</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00448">GenerateChange()</a>, and <a class="el" href="scale_8cxx_source.html#l00056">main()</a>.</p>

</div>
</div>
<a id="a5a6f5c8034689f581fd0c71f00e92edf" name="a5a6f5c8034689f581fd0c71f00e92edf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a6f5c8034689f581fd0c71f00e92edf">&#9670;&#160;</a></span>SetMadGraphDataLibrary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void g4db::G4DarkBreMModel::SetMadGraphDataLibrary </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set the library of dark brem events to be scaled.</p>
<p >This function loads the library from the on-disk file (or files).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="namespaceg4db.html#a35fb2e67c162103f16baf7a5463d235d">parseLibrary</a> for how libraries are read and what the structure of a dark brem library is</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>path to the on-disk library </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00497">497</a> of file <a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  497</span>                                                                  {</div>
<div class="line"><span class="lineno">  498</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  499</span><span class="comment">   * print status to user so they know what&#39;s happening</span></div>
<div class="line"><span class="lineno">  500</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  501</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classg4db_1_1PrototypeModel.html#ae36ab543a94d5b8477022a82d05dba47">GetVerboseLevel</a>() &gt; 0) G4cout &lt;&lt; <span class="stringliteral">&quot;[ G4DarkBreMModel ] : loading event librariy...&quot;</span> &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>  <a class="code hl_function" href="namespaceg4db.html#a35fb2e67c162103f16baf7a5463d235d">parseLibrary</a>(path, <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a36d578e5138bdba7aa44827555e0b09d">aprime_lhe_id_</a>, <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">madGraphData_</a>);</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">madGraphData_</a>.size() == 0) {</div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;BadConf : Unable to find any library entries at &#39;&quot;</span>+path+<span class="stringliteral">&quot;&#39;\n&quot;</span></div>
<div class="line"><span class="lineno">  507</span>        <span class="stringliteral">&quot;  The library is either a single CSV file or a directory of LHE files.\n&quot;</span></div>
<div class="line"><span class="lineno">  508</span>        <span class="stringliteral">&quot;  Any individual file can be compressed with `gzip`.\n&quot;</span></div>
<div class="line"><span class="lineno">  509</span>        <span class="stringliteral">&quot;  This means the valid extensions are &#39;.lhe&#39;, &#39;.lhe.gz&#39;, &#39;.csv&#39;, and &#39;.csv.gz&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  510</span>  }</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>  <a class="code hl_function" href="classg4db_1_1G4DarkBreMModel.html#a97d43e129542b8392ff62d502d94894b">MakePlaceholders</a>();  <span class="comment">// Setup the placeholder offsets for getting data.</span></div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classg4db_1_1PrototypeModel.html#ae36ab543a94d5b8477022a82d05dba47">GetVerboseLevel</a>() &gt; 0) G4cout &lt;&lt; <span class="stringliteral">&quot;[ G4DarkBreMModel ] : done&quot;</span> &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  517</span><span class="comment">   * Print out loaded MG library</span></div>
<div class="line"><span class="lineno">  518</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno">  519</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="classg4db_1_1PrototypeModel.html#ae36ab543a94d5b8477022a82d05dba47">GetVerboseLevel</a>() &gt; 1) {</div>
<div class="line"><span class="lineno">  520</span>    G4cout &lt;&lt; <span class="stringliteral">&quot;MadGraph Library of Dark Brem Events:\n&quot;</span>;</div>
<div class="line"><span class="lineno">  521</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;kV : <a class="code hl_variable" href="classg4db_1_1G4DarkBreMModel.html#a466770b569c7cc2952dbff5a1f38de5c">madGraphData_</a>) {</div>
<div class="line"><span class="lineno">  522</span>      G4cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; kV.first &lt;&lt; <span class="stringliteral">&quot; GeV Beam -&gt; &quot;</span></div>
<div class="line"><span class="lineno">  523</span>                &lt;&lt; kV.second.size() &lt;&lt; <span class="stringliteral">&quot; Events\n&quot;</span>;</div>
<div class="line"><span class="lineno">  524</span>    }</div>
<div class="line"><span class="lineno">  525</span>    G4cout &lt;&lt; G4endl;</div>
<div class="line"><span class="lineno">  526</span>  }</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  529</span>}</div>
<div class="ttc" id="aclassg4db_1_1G4DarkBreMModel_html_a97d43e129542b8392ff62d502d94894b"><div class="ttname"><a href="classg4db_1_1G4DarkBreMModel.html#a97d43e129542b8392ff62d502d94894b">g4db::G4DarkBreMModel::MakePlaceholders</a></div><div class="ttdeci">void MakePlaceholders()</div><div class="ttdef"><b>Definition:</b> <a href="G4DarkBreMModel_8cxx_source.html#l00531">G4DarkBreMModel.cxx:531</a></div></div>
<div class="ttc" id="aclassg4db_1_1PrototypeModel_html_ae36ab543a94d5b8477022a82d05dba47"><div class="ttname"><a href="classg4db_1_1PrototypeModel.html#ae36ab543a94d5b8477022a82d05dba47">g4db::PrototypeModel::GetVerboseLevel</a></div><div class="ttdeci">int GetVerboseLevel() const</div><div class="ttdef"><b>Definition:</b> <a href="PrototypeModel_8h_source.html#l00066">PrototypeModel.h:66</a></div></div>
<div class="ttc" id="anamespaceg4db_html_a35fb2e67c162103f16baf7a5463d235d"><div class="ttname"><a href="namespaceg4db.html#a35fb2e67c162103f16baf7a5463d235d">g4db::parseLibrary</a></div><div class="ttdeci">void parseLibrary(const std::string &amp;path, int aprime_lhe_id, std::map&lt; double, std::vector&lt; OutgoingKinematics &gt; &gt; &amp;lib)</div><div class="ttdef"><b>Definition:</b> <a href="ParseLibrary_8cxx_source.html#l00164">ParseLibrary.cxx:164</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4DarkBreMModel_8h_source.html#l00364">aprime_lhe_id_</a>, <a class="el" href="PrototypeModel_8h_source.html#l00066">g4db::PrototypeModel::GetVerboseLevel()</a>, <a class="el" href="G4DarkBreMModel_8h_source.html#l00403">madGraphData_</a>, <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00531">MakePlaceholders()</a>, and <a class="el" href="ParseLibrary_8cxx_source.html#l00164">g4db::parseLibrary()</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00141">G4DarkBreMModel()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4edd04498cddac54f2831e20514ca069" name="a4edd04498cddac54f2831e20514ca069"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4edd04498cddac54f2831e20514ca069">&#9670;&#160;</a></span>alwaysCreateNewLepton_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool g4db::G4DarkBreMModel::alwaysCreateNewLepton_ {true}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >should we always create a totally new lepton when we dark brem?</p>
<dl class="section note"><dt>Note</dt><dd>make this configurable? I (Tom E) can't think of a reason NOT to have it... The alternative is to allow Geant4 to decide when to make a new particle by checking if the resulting kinetic energy is below some threshold. </dd></dl>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00394">394</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00448">GenerateChange()</a>.</p>

</div>
</div>
<a id="a36d578e5138bdba7aa44827555e0b09d" name="a36d578e5138bdba7aa44827555e0b09d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36d578e5138bdba7aa44827555e0b09d">&#9670;&#160;</a></span>aprime_lhe_id_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int g4db::G4DarkBreMModel::aprime_lhe_id_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >PDG ID number for the A' (dark photon) as written in the LHE files being loaded as the dark brem event library.</p>
<p >This is only used if parsing LHE files and can be ignored if the library is being loaded from an already-constructed CSV. </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00364">364</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00497">SetMadGraphDataLibrary()</a>.</p>

</div>
</div>
<a id="a5d7f8e9c841d4b2990172567ae87745c" name="a5d7f8e9c841d4b2990172567ae87745c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d7f8e9c841d4b2990172567ae87745c">&#9670;&#160;</a></span>currentDataPoints_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;double, unsigned int&gt; g4db::G4DarkBreMModel::currentDataPoints_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Stores a map of current access points to mad graph data.</p>
<p >Maps incoming lepton energy to the index of the data vector that we will get the data from.</p>
<p >Also sorts the incoming lepton energy so that we can find the sampling energy that is closest above the actual incoming energy. </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00414">414</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00531">MakePlaceholders()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00542">sample()</a>.</p>

</div>
</div>
<a id="a7a9be5e8ea125fb12656415cde4ad6ce" name="a7a9be5e8ea125fb12656415cde4ad6ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a9be5e8ea125fb12656415cde4ad6ce">&#9670;&#160;</a></span>epsilon_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double g4db::G4DarkBreMModel::epsilon_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Epsilon value to plug into xsec calculation</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classg4db_1_1G4DarkBreMModel.html#aeb47b4204cc4536334d9ccf9f8cb845f">ComputeCrossSectionPerAtom</a> for how this is used</dd></dl>
<p>Configurable with 'epsilon' </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00355">355</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00197">ComputeCrossSectionPerAtom()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00172">PrintInfo()</a>.</p>

</div>
</div>
<a id="aa87a280a39e044f0053332e442729480" name="aa87a280a39e044f0053332e442729480"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa87a280a39e044f0053332e442729480">&#9670;&#160;</a></span>library_path_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string g4db::G4DarkBreMModel::library_path_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Full path to the vertex library used for persisting into the RunHeader </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00384">384</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00141">G4DarkBreMModel()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00172">PrintInfo()</a>.</p>

</div>
</div>
<a id="a466770b569c7cc2952dbff5a1f38de5c" name="a466770b569c7cc2952dbff5a1f38de5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a466770b569c7cc2952dbff5a1f38de5c">&#9670;&#160;</a></span>madGraphData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;double, std::vector&lt;<a class="el" href="structg4db_1_1OutgoingKinematics.html">OutgoingKinematics</a>&gt; &gt; g4db::G4DarkBreMModel::madGraphData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Storage of data from mad graph</p>
<p >Maps incoming lepton energy to various options for outgoing kinematics. This is a hefty map and is what stores <b>all</b> of the events imported from the LHE library of dark brem events. </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00403">403</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00531">MakePlaceholders()</a>, <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00542">sample()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00497">SetMadGraphDataLibrary()</a>.</p>

</div>
</div>
<a id="abaa436c1010f810fd563ff8d20df79ac" name="abaa436c1010f810fd563ff8d20df79ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abaa436c1010f810fd563ff8d20df79ac">&#9670;&#160;</a></span>maxIterations_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int g4db::G4DarkBreMModel::maxIterations_ {10000}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >maximum number of iterations to check before giving up on an event</p>
<p >This is only used in the ForwardOnly scaling method and is only reached if the event library energies are not appropriately matched with the energy range of particles that are existing in the simulation. </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00338">338</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00531">MakePlaceholders()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00380">scale()</a>.</p>

</div>
</div>
<a id="a2d97e48c82feb83feae73a44bd1eb326" name="a2d97e48c82feb83feae73a44bd1eb326"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d97e48c82feb83feae73a44bd1eb326">&#9670;&#160;</a></span>method_name_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string g4db::G4DarkBreMModel::method_name_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Name of method for persisting into the RunHeader </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00379">379</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

</div>
</div>
<a id="affa7c9e1679f3e9b59a17aac12299137" name="affa7c9e1679f3e9b59a17aac12299137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affa7c9e1679f3e9b59a17aac12299137">&#9670;&#160;</a></span>scaling_method_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a011b206417fc234c5f8c726be0c54faa">ScalingMethod</a> g4db::G4DarkBreMModel::scaling_method_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >method to scale events for this model </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00369">369</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00172">PrintInfo()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00380">scale()</a>.</p>

</div>
</div>
<a id="a007e7af570949793604ada78c23508b5" name="a007e7af570949793604ada78c23508b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a007e7af570949793604ada78c23508b5">&#9670;&#160;</a></span>threshold_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double g4db::G4DarkBreMModel::threshold_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Threshold for non-zero xsec [GeV]</p>
<p >Configurable with 'threshold'. At minimum, it is always at least twice the dark photon mass. </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00346">346</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00197">ComputeCrossSectionPerAtom()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00172">PrintInfo()</a>.</p>

</div>
</div>
<a id="a5e687dc02358e48f90db39f1a180754d" name="a5e687dc02358e48f90db39f1a180754d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e687dc02358e48f90db39f1a180754d">&#9670;&#160;</a></span>xsec_method_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classg4db_1_1G4DarkBreMModel.html#a8bde7a6a38770c17ae3056a7a3e587af">XsecMethod</a> g4db::G4DarkBreMModel::xsec_method_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >method for calculating total cross section </p>

<p class="definition">Definition at line <a class="el" href="G4DarkBreMModel_8h_source.html#l00374">374</a> of file <a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00197">ComputeCrossSectionPerAtom()</a>, <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00141">G4DarkBreMModel()</a>, and <a class="el" href="G4DarkBreMModel_8cxx_source.html#l00172">PrintInfo()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>SimCore/G4DarkBreM/include/G4DarkBreM/<a class="el" href="G4DarkBreMModel_8h_source.html">G4DarkBreMModel.h</a></li>
<li>SimCore/G4DarkBreM/src/G4DarkBreM/<a class="el" href="G4DarkBreMModel_8cxx_source.html">G4DarkBreMModel.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>