<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.1"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: ldmx::HgcrocEmulator Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>ldmx</b></li><li class="navelem"><a class="el" href="classldmx_1_1HgcrocEmulator.html">HgcrocEmulator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classldmx_1_1HgcrocEmulator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ldmx::HgcrocEmulator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Emulate the digitization procedure performed by the HGCROC.  
 <a href="classldmx_1_1HgcrocEmulator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator_1_1CompositePulse.html">CompositePulse</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af83c0eac5bcfd9c2f7b4d1757b63048c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#af83c0eac5bcfd9c2f7b4d1757b63048c">HgcrocEmulator</a> (const <a class="el" href="classframework_1_1config_1_1Parameters.html">framework::config::Parameters</a> &amp;ps)</td></tr>
<tr class="separator:af83c0eac5bcfd9c2f7b4d1757b63048c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad1bb6993c6e03552d0bc64b419c3580"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#aad1bb6993c6e03552d0bc64b419c3580">~HgcrocEmulator</a> ()</td></tr>
<tr class="separator:aad1bb6993c6e03552d0bc64b419c3580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d9b7c67e001e4387d3780e8915dff9e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a3d9b7c67e001e4387d3780e8915dff9e">hasSeed</a> () const</td></tr>
<tr class="separator:a3d9b7c67e001e4387d3780e8915dff9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c0d7365c751bb3028a3a22f677a289c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a1c0d7365c751bb3028a3a22f677a289c">seedGenerator</a> (uint64_t seed)</td></tr>
<tr class="separator:a1c0d7365c751bb3028a3a22f677a289c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d77dea1247637d36e1bacbed8bf8a86"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a0d77dea1247637d36e1bacbed8bf8a86">condition</a> (const <a class="el" href="classconditions_1_1DoubleTableCondition.html">conditions::DoubleTableCondition</a> &amp;table)</td></tr>
<tr class="separator:a0d77dea1247637d36e1bacbed8bf8a86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ceb81a1867e8523b7e2e686bb2abb0c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a0ceb81a1867e8523b7e2e686bb2abb0c">digitize</a> (const int &amp;channelID, std::vector&lt; std::pair&lt; double, double &gt;&gt; &amp;arriving_pulses, std::vector&lt; <a class="el" href="classldmx_1_1HgcrocDigiCollection_1_1Sample.html">ldmx::HgcrocDigiCollection::Sample</a> &gt; &amp;digiToAdd) const</td></tr>
<tr class="separator:a0ceb81a1867e8523b7e2e686bb2abb0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6897487befcdc0c93e93e7e2fdef1e7"><td class="memItemLeft" align="right" valign="top"><a id="aa6897487befcdc0c93e93e7e2fdef1e7"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#aa6897487befcdc0c93e93e7e2fdef1e7">gain</a> (const int &amp;channelID) const</td></tr>
<tr class="memdesc:aa6897487befcdc0c93e93e7e2fdef1e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gain for input channel. <br /></td></tr>
<tr class="separator:aa6897487befcdc0c93e93e7e2fdef1e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a445cb84888558b67adbbe9a0e1c8d58a"><td class="memItemLeft" align="right" valign="top"><a id="a445cb84888558b67adbbe9a0e1c8d58a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">pedestal</a> (const int &amp;id) const</td></tr>
<tr class="memdesc:a445cb84888558b67adbbe9a0e1c8d58a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pedestal [ADC Counts] for input channel. <br /></td></tr>
<tr class="separator:a445cb84888558b67adbbe9a0e1c8d58a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a134959bfddf791ef386543df167768cf"><td class="memItemLeft" align="right" valign="top"><a id="a134959bfddf791ef386543df167768cf"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a134959bfddf791ef386543df167768cf">readoutThreshold</a> (const int &amp;id) const</td></tr>
<tr class="memdesc:a134959bfddf791ef386543df167768cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Readout Threshold (ADC Counts) <br /></td></tr>
<tr class="separator:a134959bfddf791ef386543df167768cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a5d65be55ae8c085d964ac546f240452e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a5d65be55ae8c085d964ac546f240452e">getCondition</a> (int id, const std::string &amp;name) const</td></tr>
<tr class="separator:a5d65be55ae8c085d964ac546f240452e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:acadab969f072fdd35ad96cf5421c591d"><td class="memItemLeft" align="right" valign="top"><a id="acadab969f072fdd35ad96cf5421c591d"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#acadab969f072fdd35ad96cf5421c591d">noise_</a> {true}</td></tr>
<tr class="memdesc:acadab969f072fdd35ad96cf5421c591d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Put noise in channels, only configure to false if testing. <br /></td></tr>
<tr class="separator:acadab969f072fdd35ad96cf5421c591d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9f8424af71f659c063042c9f8ed92c9"><td class="memItemLeft" align="right" valign="top"><a id="ac9f8424af71f659c063042c9f8ed92c9"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#ac9f8424af71f659c063042c9f8ed92c9">nADCs_</a></td></tr>
<tr class="memdesc:ac9f8424af71f659c063042c9f8ed92c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Depth of ADC buffer. <br /></td></tr>
<tr class="separator:ac9f8424af71f659c063042c9f8ed92c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b2fa114003168cfc71fba8fb695ccc4"><td class="memItemLeft" align="right" valign="top"><a id="a9b2fa114003168cfc71fba8fb695ccc4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a9b2fa114003168cfc71fba8fb695ccc4">iSOI_</a></td></tr>
<tr class="memdesc:a9b2fa114003168cfc71fba8fb695ccc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Index for the Sample Of Interest in the list of digi samples. <br /></td></tr>
<tr class="separator:a9b2fa114003168cfc71fba8fb695ccc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6be20e18e89384d1bc0110807975205"><td class="memItemLeft" align="right" valign="top"><a id="aa6be20e18e89384d1bc0110807975205"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#aa6be20e18e89384d1bc0110807975205">noiseRMS_</a></td></tr>
<tr class="memdesc:aa6be20e18e89384d1bc0110807975205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Noise RMS [mV]. <br /></td></tr>
<tr class="separator:aa6be20e18e89384d1bc0110807975205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae588fd493644aa95be980753610facf4"><td class="memItemLeft" align="right" valign="top"><a id="ae588fd493644aa95be980753610facf4"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a></td></tr>
<tr class="memdesc:ae588fd493644aa95be980753610facf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time interval for chip clock [ns]. <br /></td></tr>
<tr class="separator:ae588fd493644aa95be980753610facf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac55c62728dab7aac526340223bfd7a3e"><td class="memItemLeft" align="right" valign="top"><a id="ac55c62728dab7aac526340223bfd7a3e"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#ac55c62728dab7aac526340223bfd7a3e">timingJitter_</a></td></tr>
<tr class="memdesc:ac55c62728dab7aac526340223bfd7a3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Jitter of timing mechanism in the chip [ns]. <br /></td></tr>
<tr class="separator:ac55c62728dab7aac526340223bfd7a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9f13b9b026fcb5f62223bbfede6e963"><td class="memItemLeft" align="right" valign="top"><a id="af9f13b9b026fcb5f62223bbfede6e963"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#af9f13b9b026fcb5f62223bbfede6e963">ns_</a></td></tr>
<tr class="memdesc:af9f13b9b026fcb5f62223bbfede6e963"><td class="mdescLeft">&#160;</td><td class="mdescRight">Conversion from time [ns] to counts. <br /></td></tr>
<tr class="separator:af9f13b9b026fcb5f62223bbfede6e963"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a184616af7067a167909b22ee9a5bf7ba"><td class="memItemLeft" align="right" valign="top"><a id="a184616af7067a167909b22ee9a5bf7ba"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a184616af7067a167909b22ee9a5bf7ba">rateUpSlope_</a></td></tr>
<tr class="memdesc:a184616af7067a167909b22ee9a5bf7ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate of Up Slope in Pulse Shape [1/ns]. <br /></td></tr>
<tr class="separator:a184616af7067a167909b22ee9a5bf7ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fce07d5a18d743cc5c476c2bba34ad9"><td class="memItemLeft" align="right" valign="top"><a id="a8fce07d5a18d743cc5c476c2bba34ad9"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a8fce07d5a18d743cc5c476c2bba34ad9">timeUpSlope_</a></td></tr>
<tr class="memdesc:a8fce07d5a18d743cc5c476c2bba34ad9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time of Up Slope relative to Pulse Shape Fit [ns]. <br /></td></tr>
<tr class="separator:a8fce07d5a18d743cc5c476c2bba34ad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7ac6666b0489259155ea7c7c9f7a3bc"><td class="memItemLeft" align="right" valign="top"><a id="af7ac6666b0489259155ea7c7c9f7a3bc"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#af7ac6666b0489259155ea7c7c9f7a3bc">rateDnSlope_</a></td></tr>
<tr class="memdesc:af7ac6666b0489259155ea7c7c9f7a3bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rate of Down Slope in Pulse Shape [1/ns]. <br /></td></tr>
<tr class="separator:af7ac6666b0489259155ea7c7c9f7a3bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad108f3b2bc8205c622f26ece8c4bc322"><td class="memItemLeft" align="right" valign="top"><a id="ad108f3b2bc8205c622f26ece8c4bc322"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#ad108f3b2bc8205c622f26ece8c4bc322">timeDnSlope_</a></td></tr>
<tr class="memdesc:ad108f3b2bc8205c622f26ece8c4bc322"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time of Down Slope relative to Pulse Shape Fit [ns]. <br /></td></tr>
<tr class="separator:ad108f3b2bc8205c622f26ece8c4bc322"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95ebcef891d31134b17fb4ee8df81569"><td class="memItemLeft" align="right" valign="top"><a id="a95ebcef891d31134b17fb4ee8df81569"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a95ebcef891d31134b17fb4ee8df81569">timePeak_</a></td></tr>
<tr class="memdesc:a95ebcef891d31134b17fb4ee8df81569"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time of Peak relative to pulse shape fit [ns]. <br /></td></tr>
<tr class="separator:a95ebcef891d31134b17fb4ee8df81569"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71424170e176c107011c31d6c1b1f30d"><td class="memItemLeft" align="right" valign="top"><a id="a71424170e176c107011c31d6c1b1f30d"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a71424170e176c107011c31d6c1b1f30d">hit_merge_ns_</a></td></tr>
<tr class="memdesc:a71424170e176c107011c31d6c1b1f30d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hit merging time [ns]. <br /></td></tr>
<tr class="separator:a71424170e176c107011c31d6c1b1f30d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec09162817da87f206c25a4bb0376c7"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classconditions_1_1DoubleTableCondition.html">conditions::DoubleTableCondition</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a4ec09162817da87f206c25a4bb0376c7">chipConditions_</a> {nullptr}</td></tr>
<tr class="separator:a4ec09162817da87f206c25a4bb0376c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a403cc2554201c7098ce6d9674987d"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#aa1a403cc2554201c7098ce6d9674987d">conditionNamesToIndex_</a></td></tr>
<tr class="separator:aa1a403cc2554201c7098ce6d9674987d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e01884b555cf0134cb467dce52ddaa5"><td class="memItemLeft" align="right" valign="top"><a id="a9e01884b555cf0134cb467dce52ddaa5"></a>
std::unique_ptr&lt; TRandom3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#a9e01884b555cf0134cb467dce52ddaa5">noiseInjector_</a></td></tr>
<tr class="memdesc:a9e01884b555cf0134cb467dce52ddaa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates Gaussian noise on top of real hits. <br /></td></tr>
<tr class="separator:a9e01884b555cf0134cb467dce52ddaa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad263134be06668bb251c29643ff3749e"><td class="memItemLeft" align="right" valign="top">TF1&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a></td></tr>
<tr class="separator:ad263134be06668bb251c29643ff3749e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Emulate the digitization procedure performed by the HGCROC. </p>
<p>This object emulates how the chip converts the analog signal into DIGI samples. With that in mind, the digitize method converts a set of voltages and times into the DIGI.</p>
<p>This object <em>does not</em> do everything related to subsystem information. It does <em>not</em> simulate noise within the empty channels, and it does <em>not</em> convert simulated energy depositions into voltages. These tasks depend on the detector construction, so they are left to the individual subsystem producers.</p>
<p>@TODO time phase setting relative to target t=0ns using electronic IDs</p>
<p>@TODO accurately model recovering from saturation (TOT Mode). Currently, we just have all the samples after the sample triggering TOT mode rail. </p>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8h_source.html#l00039">39</a> of file <a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af83c0eac5bcfd9c2f7b4d1757b63048c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af83c0eac5bcfd9c2f7b4d1757b63048c">&#9670;&nbsp;</a></span>HgcrocEmulator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::HgcrocEmulator::HgcrocEmulator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classframework_1_1config_1_1Parameters.html">framework::config::Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>ps</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor</p>
<p>Configures the chip emulator using the passed parameters. </p>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8cxx_source.html#l00006">6</a> of file <a class="el" href="HgcrocEmulator_8cxx_source.html">HgcrocEmulator.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;                                                                  {</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  <span class="comment">// settings of readout chip that are the same for all chips</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  <span class="comment">//  used  in actual digitization</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#acadab969f072fdd35ad96cf5421c591d">noise_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;noise&quot;</span>);</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa6be20e18e89384d1bc0110807975205">noiseRMS_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;noiseRMS&quot;</span>);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ac55c62728dab7aac526340223bfd7a3e">timingJitter_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;timingJitter&quot;</span>);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#a184616af7067a167909b22ee9a5bf7ba">rateUpSlope_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;rateUpSlope&quot;</span>);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#a8fce07d5a18d743cc5c476c2bba34ad9">timeUpSlope_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;timeUpSlope&quot;</span>);</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#af7ac6666b0489259155ea7c7c9f7a3bc">rateDnSlope_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;rateDnSlope&quot;</span>);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad108f3b2bc8205c622f26ece8c4bc322">timeDnSlope_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;timeDnSlope&quot;</span>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#a95ebcef891d31134b17fb4ee8df81569">timePeak_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;timePeak&quot;</span>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">double</span>&gt;(<span class="stringliteral">&quot;clockCycle&quot;</span>);</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ac9f8424af71f659c063042c9f8ed92c9">nADCs_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;nADCs&quot;</span>);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#a9b2fa114003168cfc71fba8fb695ccc4">iSOI_</a> = ps.<a class="code" href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">getParameter</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;iSOI&quot;</span>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <span class="comment">// Time -&gt; clock counts conversion</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="comment">//  time [ns] * ( 2^10 / max time in ns ) = clock counts</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#af9f13b9b026fcb5f62223bbfede6e963">ns_</a> = 1024. / <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#a71424170e176c107011c31d6c1b1f30d">hit_merge_ns_</a> = 0.05;  <span class="comment">// combine at 50 ps level</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="comment">// Configure the pulse shape function</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a> =</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      TF1(<span class="stringliteral">&quot;pulseFunc&quot;</span>,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;          <span class="stringliteral">&quot;[0]*((1.0+exp([1]*(-[2]+[3])))*(1.0+exp([5]*(-[6]+[3]))))/&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;          <span class="stringliteral">&quot;((1.0+exp([1]*(x-[2]+[3]-[4])))*(1.0+exp([5]*(x-[6]+[3]-[4]))))&quot;</span>,</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;          0.0, (<span class="keywordtype">double</span>)<a class="code" href="classldmx_1_1HgcrocEmulator.html#ac9f8424af71f659c063042c9f8ed92c9">nADCs_</a> * <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a>.FixParameter(0, 1.0);  <span class="comment">// amplitude is set externally</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a>.FixParameter(1, <a class="code" href="classldmx_1_1HgcrocEmulator.html#a184616af7067a167909b22ee9a5bf7ba">rateUpSlope_</a>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a>.FixParameter(2, <a class="code" href="classldmx_1_1HgcrocEmulator.html#a8fce07d5a18d743cc5c476c2bba34ad9">timeUpSlope_</a>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a>.FixParameter(3, <a class="code" href="classldmx_1_1HgcrocEmulator.html#a95ebcef891d31134b17fb4ee8df81569">timePeak_</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a>.FixParameter(4, 0);  <span class="comment">// not using time offset in this way</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a>.FixParameter(5, <a class="code" href="classldmx_1_1HgcrocEmulator.html#af7ac6666b0489259155ea7c7c9f7a3bc">rateDnSlope_</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a>.FixParameter(6, <a class="code" href="classldmx_1_1HgcrocEmulator.html#ad108f3b2bc8205c622f26ece8c4bc322">timeDnSlope_</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
<div class="ttc" id="aclassframework_1_1config_1_1Parameters_html_a18206b7c01007dd706abce7e5505eae1"><div class="ttname"><a href="classframework_1_1config_1_1Parameters.html#a18206b7c01007dd706abce7e5505eae1">framework::config::Parameters::getParameter</a></div><div class="ttdeci">T getParameter(const std::string &amp;name) const</div><div class="ttdef"><b>Definition:</b> <a href="Parameters_8h_source.html#l00089">Parameters.h:89</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a184616af7067a167909b22ee9a5bf7ba"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a184616af7067a167909b22ee9a5bf7ba">ldmx::HgcrocEmulator::rateUpSlope_</a></div><div class="ttdeci">double rateUpSlope_</div><div class="ttdoc">Rate of Up Slope in Pulse Shape [1/ns].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00348">HgcrocEmulator.h:348</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a71424170e176c107011c31d6c1b1f30d"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a71424170e176c107011c31d6c1b1f30d">ldmx::HgcrocEmulator::hit_merge_ns_</a></div><div class="ttdeci">double hit_merge_ns_</div><div class="ttdoc">Hit merging time [ns].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00363">HgcrocEmulator.h:363</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a8fce07d5a18d743cc5c476c2bba34ad9"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a8fce07d5a18d743cc5c476c2bba34ad9">ldmx::HgcrocEmulator::timeUpSlope_</a></div><div class="ttdeci">double timeUpSlope_</div><div class="ttdoc">Time of Up Slope relative to Pulse Shape Fit [ns].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00351">HgcrocEmulator.h:351</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a95ebcef891d31134b17fb4ee8df81569"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a95ebcef891d31134b17fb4ee8df81569">ldmx::HgcrocEmulator::timePeak_</a></div><div class="ttdeci">double timePeak_</div><div class="ttdoc">Time of Peak relative to pulse shape fit [ns].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00360">HgcrocEmulator.h:360</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a9b2fa114003168cfc71fba8fb695ccc4"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a9b2fa114003168cfc71fba8fb695ccc4">ldmx::HgcrocEmulator::iSOI_</a></div><div class="ttdeci">int iSOI_</div><div class="ttdoc">Index for the Sample Of Interest in the list of digi samples.</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00333">HgcrocEmulator.h:333</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_aa6be20e18e89384d1bc0110807975205"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#aa6be20e18e89384d1bc0110807975205">ldmx::HgcrocEmulator::noiseRMS_</a></div><div class="ttdeci">double noiseRMS_</div><div class="ttdoc">Noise RMS [mV].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00336">HgcrocEmulator.h:336</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_ac55c62728dab7aac526340223bfd7a3e"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#ac55c62728dab7aac526340223bfd7a3e">ldmx::HgcrocEmulator::timingJitter_</a></div><div class="ttdeci">double timingJitter_</div><div class="ttdoc">Jitter of timing mechanism in the chip [ns].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00342">HgcrocEmulator.h:342</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_ac9f8424af71f659c063042c9f8ed92c9"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#ac9f8424af71f659c063042c9f8ed92c9">ldmx::HgcrocEmulator::nADCs_</a></div><div class="ttdeci">int nADCs_</div><div class="ttdoc">Depth of ADC buffer.</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00330">HgcrocEmulator.h:330</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_acadab969f072fdd35ad96cf5421c591d"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#acadab969f072fdd35ad96cf5421c591d">ldmx::HgcrocEmulator::noise_</a></div><div class="ttdeci">bool noise_</div><div class="ttdoc">Put noise in channels, only configure to false if testing.</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00327">HgcrocEmulator.h:327</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_ad108f3b2bc8205c622f26ece8c4bc322"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#ad108f3b2bc8205c622f26ece8c4bc322">ldmx::HgcrocEmulator::timeDnSlope_</a></div><div class="ttdeci">double timeDnSlope_</div><div class="ttdoc">Time of Down Slope relative to Pulse Shape Fit [ns].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00357">HgcrocEmulator.h:357</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_ad263134be06668bb251c29643ff3749e"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">ldmx::HgcrocEmulator::pulseFunc_</a></div><div class="ttdeci">TF1 pulseFunc_</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00412">HgcrocEmulator.h:412</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_ae588fd493644aa95be980753610facf4"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">ldmx::HgcrocEmulator::clockCycle_</a></div><div class="ttdeci">double clockCycle_</div><div class="ttdoc">Time interval for chip clock [ns].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00339">HgcrocEmulator.h:339</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_af7ac6666b0489259155ea7c7c9f7a3bc"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#af7ac6666b0489259155ea7c7c9f7a3bc">ldmx::HgcrocEmulator::rateDnSlope_</a></div><div class="ttdeci">double rateDnSlope_</div><div class="ttdoc">Rate of Down Slope in Pulse Shape [1/ns].</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00354">HgcrocEmulator.h:354</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_af9f13b9b026fcb5f62223bbfede6e963"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#af9f13b9b026fcb5f62223bbfede6e963">ldmx::HgcrocEmulator::ns_</a></div><div class="ttdeci">double ns_</div><div class="ttdoc">Conversion from time [ns] to counts.</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00345">HgcrocEmulator.h:345</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocEmulator_8h_source.html#l00339">clockCycle_</a>, <a class="el" href="Parameters_8h_source.html#l00089">framework::config::Parameters::getParameter()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00363">hit_merge_ns_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00333">iSOI_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00330">nADCs_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00327">noise_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00336">noiseRMS_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00345">ns_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00412">pulseFunc_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00354">rateDnSlope_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00348">rateUpSlope_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00357">timeDnSlope_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00360">timePeak_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00351">timeUpSlope_</a>, and <a class="el" href="HgcrocEmulator_8h_source.html#l00342">timingJitter_</a>.</p>

</div>
</div>
<a id="aad1bb6993c6e03552d0bc64b419c3580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad1bb6993c6e03552d0bc64b419c3580">&#9670;&nbsp;</a></span>~HgcrocEmulator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::HgcrocEmulator::~HgcrocEmulator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor </p>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8h_source.html#l00049">49</a> of file <a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0d77dea1247637d36e1bacbed8bf8a86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d77dea1247637d36e1bacbed8bf8a86">&#9670;&nbsp;</a></span>condition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::HgcrocEmulator::condition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classconditions_1_1DoubleTableCondition.html">conditions::DoubleTableCondition</a> &amp;&#160;</td>
          <td class="paramname"><em>table</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set Conditions</p>
<p>Passes the chips conditions to be cached here and used later in digitization.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">table</td><td>conditions::DoubleTableConditions to be used for chip parameters </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8h_source.html#l00072">72</a> of file <a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                                              {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// reset cache of column numbers if table changes</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (&amp;table != <a class="code" href="classldmx_1_1HgcrocEmulator.html#a4ec09162817da87f206c25a4bb0376c7">chipConditions_</a>) <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa1a403cc2554201c7098ce6d9674987d">conditionNamesToIndex_</a>.clear();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="classldmx_1_1HgcrocEmulator.html#a4ec09162817da87f206c25a4bb0376c7">chipConditions_</a> = &amp;table;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a4ec09162817da87f206c25a4bb0376c7"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a4ec09162817da87f206c25a4bb0376c7">ldmx::HgcrocEmulator::chipConditions_</a></div><div class="ttdeci">const conditions::DoubleTableCondition * chipConditions_</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00375">HgcrocEmulator.h:375</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_aa1a403cc2554201c7098ce6d9674987d"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#aa1a403cc2554201c7098ce6d9674987d">ldmx::HgcrocEmulator::conditionNamesToIndex_</a></div><div class="ttdeci">std::map&lt; std::string, int &gt; conditionNamesToIndex_</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00383">HgcrocEmulator.h:383</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocEmulator_8h_source.html#l00375">chipConditions_</a>, and <a class="el" href="HgcrocEmulator_8h_source.html#l00383">conditionNamesToIndex_</a>.</p>

</div>
</div>
<a id="a0ceb81a1867e8523b7e2e686bb2abb0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ceb81a1867e8523b7e2e686bb2abb0c">&#9670;&nbsp;</a></span>digitize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::HgcrocEmulator::digitize </td>
          <td>(</td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>channelID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; double, double &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>arriving_pulses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classldmx_1_1HgcrocDigiCollection_1_1Sample.html">ldmx::HgcrocDigiCollection::Sample</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>digiToAdd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Digitize the signals from the simulated hits</p>
<p>This is where the hefty amount of work is done.</p>
<p>0. Prepare for Emulation</p><ul>
<li>Clear input list of digi samples</li>
<li>Get conditions for the current chip</li>
<li>Sort the input sim voltage hits by amplitude</li>
</ul>
<p>Combine input simulated hits into one <a class="el" href="classldmx_1_1HgcrocEmulator_1_1CompositePulse.html">CompositePulse</a> to digitize.</p><ul>
<li>This composite pulse decides whether to merge two simulated hits into one larger pulse depending on how close they are in time.</li>
</ul>
<p>Add a timing jitter TODO</p>
<ol type="1">
<li>Go through sampling baskets one-by-one<ul>
<li>If enter pulse goes above tot threshold, then enter TOT readout mode, digitize, and return true.</li>
<li>If pulse never goes above tot threshold, then only return true if the voltage sample taken in the SOI is above the readout threshold.</li>
</ul>
</li>
</ol>
<h4><a class="anchor" id="autotoc_md11"></a>
ADC Mode</h4>
<p>Here, we measure the height of the pulse once per clock cycle. This leaves us with nADCs_ samples for each digitized hit. The voltage measurements are converted to ADC counts using the parameter gain_.</p>
<p>The time of arrival (TOA) is zero unless the amplitude is greater than toaThreshold_. Then the TOA is set to the point the pulse crosses the toaThreshold_ with respect to the current clock window. The time measurements are converted to clock counts using 2^10=1024 and clockCycle_.</p>
<p>Both the tot_complete_ and tot_progress_ flags are set to false for all the samples.</p>
<h4><a class="anchor" id="autotoc_md12"></a>
TOT Mode</h4>
<p>Here, we measure how long the chip is in saturation. This is calculated using the drain rate and assuming a linear drain of the charge off of the chip.</p>
<p>The charge deposited on the chip is converted from the pulse triggering TOT without including the pedestal. The pedestal is included in the pulse when determining if the pulse should enter TOT mode.</p>
<p>Thus, TOT = charge deposited / drain rate and TOA is calculated as before, seeing when the pulse crossed the TOA threshold.</p>
<h4><a class="anchor" id="autotoc_md13"></a>
Pulse Measurement</h4>
<p>All "measurements" of the pulse use the object <a class="el" href="classldmx_1_1HgcrocEmulator_1_1CompositePulse.html">CompositePulse</a>. This function incorporates the pedestal_ and linearly adds all the pulses at a variety of times. The pulses at different times are "merged" upon addition to the composite pulse depending on how close they are. This is done in a single pass, so we might end up with pulses closer than the provided separation time.</p>
<dl class="section note"><dt>Note</dt><dd>For more realism, some chip parameters should change depending on the chip they are coming from. This should be modified here, with a package of "HgcrocConditions" passed to this function to configure the emulator before digitizing.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">channelID</td><td>raw integer ID for this readout channel </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arriving_pulses</td><td>pairs of (voltage,time) of hits arriving at the chip </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">digiToAdd</td><td>digi that will be filled with the samples from the chip </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if digis were constructed (false if hit was below readout) </dd></dl>
<p>the time here is nominal (zero gives peak if hit.second is zero)</p>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8cxx_source.html#l00046">46</a> of file <a class="el" href="HgcrocEmulator_8cxx_source.html">HgcrocEmulator.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                                {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="comment">// step 0: prepare ourselves for emulation</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  digiToAdd.clear();  <span class="comment">// make sure it is clean</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// Configure chip settings based off of table (that may have been passed)</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">double</span> totMax = <a class="code" href="classldmx_1_1HgcrocEmulator.html#a5d65be55ae8c085d964ac546f240452e">getCondition</a>(channelID, <span class="stringliteral">&quot;TOT_MAX&quot;</span>);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordtype">double</span> padCapacitance = <a class="code" href="classldmx_1_1HgcrocEmulator.html#a5d65be55ae8c085d964ac546f240452e">getCondition</a>(channelID, <span class="stringliteral">&quot;PAD_CAPACITANCE&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa6897487befcdc0c93e93e7e2fdef1e7">gain</a> = this-&gt;<a class="code" href="classldmx_1_1HgcrocEmulator.html#aa6897487befcdc0c93e93e7e2fdef1e7">gain</a>(channelID);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">pedestal</a> = this-&gt;<a class="code" href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">pedestal</a>(channelID);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordtype">double</span> toaThreshold = <a class="code" href="classldmx_1_1HgcrocEmulator.html#a5d65be55ae8c085d964ac546f240452e">getCondition</a>(channelID, <span class="stringliteral">&quot;TOA_THRESHOLD&quot;</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="keywordtype">double</span> totThreshold = <a class="code" href="classldmx_1_1HgcrocEmulator.html#a5d65be55ae8c085d964ac546f240452e">getCondition</a>(channelID, <span class="stringliteral">&quot;TOT_THRESHOLD&quot;</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">// measTime defines the point in the BX where an in-time</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">//  (time=0 in times vector) hit would arrive.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// Used to determine BX boundaries and TOA behavior.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">double</span> measTime = <a class="code" href="classldmx_1_1HgcrocEmulator.html#a5d65be55ae8c085d964ac546f240452e">getCondition</a>(channelID, <span class="stringliteral">&quot;MEAS_TIME&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordtype">double</span> drainRate = <a class="code" href="classldmx_1_1HgcrocEmulator.html#a5d65be55ae8c085d964ac546f240452e">getCondition</a>(channelID, <span class="stringliteral">&quot;DRAIN_RATE&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordtype">double</span> readoutThresholdFloat = this-&gt;<a class="code" href="classldmx_1_1HgcrocEmulator.html#a134959bfddf791ef386543df167768cf">readoutThreshold</a>(channelID);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classldmx_1_1HgcrocEmulator.html#a134959bfddf791ef386543df167768cf">readoutThreshold</a> = int(readoutThresholdFloat);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// sort by amplitude</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">//  ==&gt; makes sure that puleses are merged towards higher ones</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  std::sort(</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      arriving_pulses.begin(), arriving_pulses.end(),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      [](<span class="keyword">const</span> std::pair&lt;double, double&gt; &amp;a,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;         <span class="keyword">const</span> std::pair&lt;double, double&gt; &amp;b) { return a.first &gt; b.first; });</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// step 1: gather voltages into groups separated by (programmable) ns, single</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// pass</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  CompositePulse pulse(<a class="code" href="classldmx_1_1HgcrocEmulator.html#ad263134be06668bb251c29643ff3749e">pulseFunc_</a>, <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa6897487befcdc0c93e93e7e2fdef1e7">gain</a>, <a class="code" href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">pedestal</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> hit : arriving_pulses) pulse.addOrMerge(hit, <a class="code" href="classldmx_1_1HgcrocEmulator.html#a71424170e176c107011c31d6c1b1f30d">hit_merge_ns_</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// TODO step 2: add timing jitter</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// if (noise_) pulse.jitter();</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// step 3: go through each BX sample one by one</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">bool</span> doReadout = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">bool</span> wasTOA = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iADC = 0; iADC &lt; <a class="code" href="classldmx_1_1HgcrocEmulator.html#ac9f8424af71f659c063042c9f8ed92c9">nADCs_</a>; iADC++) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">double</span> startBX = (iADC - <a class="code" href="classldmx_1_1HgcrocEmulator.html#a9b2fa114003168cfc71fba8fb695ccc4">iSOI_</a>) * <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a> - measTime;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// step 3b: check each merged hit to see if it peaks in this BX.  If so,</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// check its peak time to see if it&#39;s over TOT or TOA.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">bool</span> startTOT = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordtype">bool</span> overTOA = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">double</span> toverTOA = -1;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">double</span> toverTOT = -1;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> hit : pulse.hits()) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      <span class="keywordtype">int</span> hitBX = int((hit.second + measTime) / <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a> + <a class="code" href="classldmx_1_1HgcrocEmulator.html#a9b2fa114003168cfc71fba8fb695ccc4">iSOI_</a>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      <span class="keywordflow">if</span> (hitBX != iADC)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">continue</span>;  <span class="comment">// if this hit wasn&#39;t in the current BX, continue...</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="keywordtype">double</span> vpeak = pulse(hit.second);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">if</span> (vpeak &gt; totThreshold) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        startTOT = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">if</span> (toverTOT &lt; hit.second)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          toverTOT = hit.second;  <span class="comment">// use the latest time in the window</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordflow">if</span> (vpeak &gt; toaThreshold) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (!overTOA || hit.second &lt; toverTOA) toverTOA = hit.second;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        overTOA = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }  <span class="comment">// loop over sim hits</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// check for the case of a TOA even though the peak is in the next BX</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (!overTOA &amp;&amp; pulse(startBX + <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a>) &gt; toaThreshold) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">if</span> (pulse(startBX) &lt; toaThreshold) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="comment">// pulse crossed TOA threshold somewhere between the start of this</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">// basket and the end</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        overTOA = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        toverTOA = startBX + <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">if</span> (startTOT) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="comment">// above TOT threshold -&gt; do TOT readout mode</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// @TODO NO NOISE</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">//  CompositePulse includes pedestal, we need to remove it</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      <span class="comment">//  when calculating the charge deposited.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordtype">double</span> charge_deposited =</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          (pulse(toverTOT) - <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa6897487befcdc0c93e93e7e2fdef1e7">gain</a> * <a class="code" href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">pedestal</a>) * padCapacitance;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="comment">// Measure Time Over Threshold (TOT) by using the drain rate.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">//  1. Use drain rate to see how long it takes for the charge to drain off</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="comment">//  2. Translate this into DIGI samples</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <span class="comment">// Assume linear drain with slope drain rate:</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <span class="comment">//      y-intercept = pulse amplitude</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="comment">//      slope       = drain rate</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="comment">//  ==&gt; x-intercept = amplitude / rate</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">// actual time over threshold using the real signal voltage amplitude</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <span class="keywordtype">double</span> tot = charge_deposited / drainRate;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// calculate the index that tot will complete on</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordtype">int</span> num_whole_clocks = int(tot / <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="comment">// calculate the TDC counts for this tot measurement</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="comment">//  internally, the chip uses 12 bits (2^12 = 4096)</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="comment">//  to measure a maximum of tot Max [ns]</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keywordtype">int</span> tdc_counts = int(tot * 4096 / totMax) + <a class="code" href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">pedestal</a>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">// were we already over TOA?  TOT is reported in BX where TOA went over</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">// threshold...</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordtype">int</span> toa{0};</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">if</span> (wasTOA) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="comment">// TOA was in the past</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        toa = digiToAdd.back().toa();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// TOA is here and we need to find it</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordtype">double</span> timecross = pulse.findCrossing(startBX, toverTOT, toaThreshold);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        toa = int((timecross - startBX) * <a class="code" href="classldmx_1_1HgcrocEmulator.html#af9f13b9b026fcb5f62223bbfede6e963">ns_</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">// keep inside valid limits</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">if</span> (toa == 0) toa = 1;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">if</span> (toa &gt; 1023) toa = 1023;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      digiToAdd.emplace_back(</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          <span class="keyword">false</span>, <span class="keyword">true</span>,  <span class="comment">// mark as a TOT measurement</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          (iADC &gt; 0) ? digiToAdd.at(iADC - 1).adc_t()</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                     : <a class="code" href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">pedestal</a>,  <span class="comment">// ADC t-1 is first measurement</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          tdc_counts,             <span class="comment">// TOT</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          toa                     <span class="comment">// TOA is third measurement</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      );</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="comment">// TODO: properly handle saturation and recovery, eventually.  </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="comment">// Now just kill everything...</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">while</span> (digiToAdd.size() &lt; <a class="code" href="classldmx_1_1HgcrocEmulator.html#ac9f8424af71f659c063042c9f8ed92c9">nADCs_</a>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        digiToAdd.emplace_back(<span class="keyword">true</span>, <span class="keyword">false</span>,  <span class="comment">// flags to mark type of sample</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                               0x3FF, 0x3FF, 0);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;  <span class="comment">// always readout</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">// determine the voltage at the sampling time</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordtype">double</span> bxvolts = pulse((iADC - <a class="code" href="classldmx_1_1HgcrocEmulator.html#a9b2fa114003168cfc71fba8fb695ccc4">iSOI_</a>) * <a class="code" href="classldmx_1_1HgcrocEmulator.html#ae588fd493644aa95be980753610facf4">clockCycle_</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// add noise if requested</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classldmx_1_1HgcrocEmulator.html#acadab969f072fdd35ad96cf5421c591d">noise_</a>) bxvolts += <a class="code" href="classldmx_1_1HgcrocEmulator.html#a9e01884b555cf0134cb467dce52ddaa5">noiseInjector_</a>-&gt;Gaus(0., <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa6be20e18e89384d1bc0110807975205">noiseRMS_</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="comment">// convert to integer and keep in range (handle low and high saturation)</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="keywordtype">int</span> adc = bxvolts / <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa6897487befcdc0c93e93e7e2fdef1e7">gain</a>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">if</span> (adc &lt; 0) adc = 0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">if</span> (adc &gt; 1023) adc = 1023;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="comment">// check for TOA</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="keywordtype">int</span> toa(0);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keywordflow">if</span> (pulse(startBX) &lt; toaThreshold &amp;&amp; overTOA) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordtype">double</span> timecross = pulse.findCrossing(startBX, toverTOA, toaThreshold);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        toa = int((timecross - startBX) * <a class="code" href="classldmx_1_1HgcrocEmulator.html#af9f13b9b026fcb5f62223bbfede6e963">ns_</a>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// keep inside valid limits</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">if</span> (toa == 0) toa = 1;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span> (toa &gt; 1023) toa = 1023;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        wasTOA = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        wasTOA = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      digiToAdd.emplace_back(</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          <span class="keyword">false</span>, <span class="keyword">false</span>,  <span class="comment">// use flags to mark this sample as an ADC measurement</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          (iADC &gt; 0) ? digiToAdd.at(iADC - 1).adc_t()</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                     : <a class="code" href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">pedestal</a>,  <span class="comment">// ADC t-1 is first measurement</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          adc,                    <span class="comment">// ADC[t] is the second field</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          toa                     <span class="comment">// TOA is third measurement</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      );</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }  <span class="comment">// TOT or ADC Mode</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }    <span class="comment">// sampling baskets</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// we only get here if we never went into TOT mode</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="comment">// check the SOI to see if we should read out</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">return</span> digiToAdd.at(<a class="code" href="classldmx_1_1HgcrocEmulator.html#a9b2fa114003168cfc71fba8fb695ccc4">iSOI_</a>).adc_t() &gt;= <a class="code" href="classldmx_1_1HgcrocEmulator.html#a134959bfddf791ef386543df167768cf">readoutThreshold</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}  <span class="comment">// HgcrocEmulator::digitize</span></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a134959bfddf791ef386543df167768cf"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a134959bfddf791ef386543df167768cf">ldmx::HgcrocEmulator::readoutThreshold</a></div><div class="ttdeci">double readoutThreshold(const int &amp;id) const</div><div class="ttdoc">Readout Threshold (ADC Counts)</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00166">HgcrocEmulator.h:166</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a445cb84888558b67adbbe9a0e1c8d58a"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a445cb84888558b67adbbe9a0e1c8d58a">ldmx::HgcrocEmulator::pedestal</a></div><div class="ttdeci">double pedestal(const int &amp;id) const</div><div class="ttdoc">Pedestal [ADC Counts] for input channel.</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00161">HgcrocEmulator.h:161</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a5d65be55ae8c085d964ac546f240452e"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a5d65be55ae8c085d964ac546f240452e">ldmx::HgcrocEmulator::getCondition</a></div><div class="ttdeci">double getCondition(int id, const std::string &amp;name) const</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00180">HgcrocEmulator.h:180</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_a9e01884b555cf0134cb467dce52ddaa5"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#a9e01884b555cf0134cb467dce52ddaa5">ldmx::HgcrocEmulator::noiseInjector_</a></div><div class="ttdeci">std::unique_ptr&lt; TRandom3 &gt; noiseInjector_</div><div class="ttdoc">Generates Gaussian noise on top of real hits.</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00390">HgcrocEmulator.h:390</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocEmulator_html_aa6897487befcdc0c93e93e7e2fdef1e7"><div class="ttname"><a href="classldmx_1_1HgcrocEmulator.html#aa6897487befcdc0c93e93e7e2fdef1e7">ldmx::HgcrocEmulator::gain</a></div><div class="ttdeci">double gain(const int &amp;channelID) const</div><div class="ttdoc">Gain for input channel.</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocEmulator_8h_source.html#l00156">HgcrocEmulator.h:156</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocEmulator_8h_source.html#l00225">ldmx::HgcrocEmulator::CompositePulse::addOrMerge()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00339">clockCycle_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00250">ldmx::HgcrocEmulator::CompositePulse::findCrossing()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00156">gain()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00180">getCondition()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00363">hit_merge_ns_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00300">ldmx::HgcrocEmulator::CompositePulse::hits()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00333">iSOI_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00330">nADCs_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00327">noise_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00390">noiseInjector_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00336">noiseRMS_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00345">ns_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00161">pedestal()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00412">pulseFunc_</a>, and <a class="el" href="HgcrocEmulator_8h_source.html#l00166">readoutThreshold()</a>.</p>

</div>
</div>
<a id="a5d65be55ae8c085d964ac546f240452e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d65be55ae8c085d964ac546f240452e">&#9670;&nbsp;</a></span>getCondition()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double ldmx::HgcrocEmulator::getCondition </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get condition for input chip ID, condition name, and default value</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>chip global integer ID used in condition table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>std::string name of chip parameter in table </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">def</td><td>default value for parameter if not found in table (or table not set) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>value of chip parameter </dd></dl>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8h_source.html#l00180">180</a> of file <a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                                           {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// check if emulator has been passed a table of conditions</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classldmx_1_1HgcrocEmulator.html#a4ec09162817da87f206c25a4bb0376c7">chipConditions_</a>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      EXCEPTION_RAISE(<span class="stringliteral">&quot;HgcrocCond&quot;</span>,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          <span class="stringliteral">&quot;HGC ROC Emulator was not given a conditions table.&quot;</span>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// cache column index for the input name</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classldmx_1_1HgcrocEmulator.html#aa1a403cc2554201c7098ce6d9674987d">conditionNamesToIndex_</a>.count(name) == 0)</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa1a403cc2554201c7098ce6d9674987d">conditionNamesToIndex_</a>[name] = <a class="code" href="classldmx_1_1HgcrocEmulator.html#a4ec09162817da87f206c25a4bb0376c7">chipConditions_</a>-&gt;<a class="code" href="classconditions_1_1BaseTableCondition.html#a4ea72a29ab6cf3bf81a7459ed39d4cd9">getColumnNumber</a>(name);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// get condition</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1HgcrocEmulator.html#a4ec09162817da87f206c25a4bb0376c7">chipConditions_</a>-&gt;<a class="code" href="classconditions_1_1HomogenousTableCondition.html#a025ceb80d04d648b8ffc14888fd09e96">get</a>(<span class="keywordtype">id</span>, <a class="code" href="classldmx_1_1HgcrocEmulator.html#aa1a403cc2554201c7098ce6d9674987d">conditionNamesToIndex_</a>.at(name));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="ttc" id="aclassconditions_1_1BaseTableCondition_html_a4ea72a29ab6cf3bf81a7459ed39d4cd9"><div class="ttname"><a href="classconditions_1_1BaseTableCondition.html#a4ea72a29ab6cf3bf81a7459ed39d4cd9">conditions::BaseTableCondition::getColumnNumber</a></div><div class="ttdeci">unsigned int getColumnNumber(const std::string &amp;colname) const</div><div class="ttdef"><b>Definition:</b> <a href="SimpleTableCondition_8h_source.html#l00034">SimpleTableCondition.h:34</a></div></div>
<div class="ttc" id="aclassconditions_1_1HomogenousTableCondition_html_a025ceb80d04d648b8ffc14888fd09e96"><div class="ttname"><a href="classconditions_1_1HomogenousTableCondition.html#a025ceb80d04d648b8ffc14888fd09e96">conditions::HomogenousTableCondition::get</a></div><div class="ttdeci">T get(unsigned int id, unsigned int col) const</div><div class="ttdef"><b>Definition:</b> <a href="SimpleTableCondition_8h_source.html#l00145">SimpleTableCondition.h:145</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocEmulator_8h_source.html#l00375">chipConditions_</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00383">conditionNamesToIndex_</a>, <a class="el" href="SimpleTableCondition_8h_source.html#l00145">conditions::HomogenousTableCondition&lt; T &gt;::get()</a>, and <a class="el" href="SimpleTableCondition_8h_source.html#l00034">conditions::BaseTableCondition::getColumnNumber()</a>.</p>

<p class="reference">Referenced by <a class="el" href="HgcrocEmulator_8cxx_source.html#l00046">digitize()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00156">gain()</a>, <a class="el" href="HgcrocEmulator_8h_source.html#l00161">pedestal()</a>, and <a class="el" href="HgcrocEmulator_8h_source.html#l00166">readoutThreshold()</a>.</p>

</div>
</div>
<a id="a3d9b7c67e001e4387d3780e8915dff9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d9b7c67e001e4387d3780e8915dff9e">&#9670;&nbsp;</a></span>hasSeed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ldmx::HgcrocEmulator::hasSeed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if emulator has been seeded </p><dl class="section return"><dt>Returns</dt><dd>true if random generator has been seeded </dd></dl>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8h_source.html#l00055">55</a> of file <a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classldmx_1_1HgcrocEmulator.html#a9e01884b555cf0134cb467dce52ddaa5">noiseInjector_</a>.get() != <span class="keyword">nullptr</span>; }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocEmulator_8h_source.html#l00390">noiseInjector_</a>.</p>

</div>
</div>
<a id="a1c0d7365c751bb3028a3a22f677a289c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c0d7365c751bb3028a3a22f677a289c">&#9670;&nbsp;</a></span>seedGenerator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::HgcrocEmulator::seedGenerator </td>
          <td>(</td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Seed the emulator for random number generation </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">seed</td><td>integer to use as random seed </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8cxx_source.html#l00042">42</a> of file <a class="el" href="HgcrocEmulator_8cxx_source.html">HgcrocEmulator.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                                {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classldmx_1_1HgcrocEmulator.html#a9e01884b555cf0134cb467dce52ddaa5">noiseInjector_</a> = std::make_unique&lt;TRandom3&gt;(seed);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocEmulator_8h_source.html#l00390">noiseInjector_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4ec09162817da87f206c25a4bb0376c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ec09162817da87f206c25a4bb0376c7">&#9670;&nbsp;</a></span>chipConditions_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classconditions_1_1DoubleTableCondition.html">conditions::DoubleTableCondition</a>* ldmx::HgcrocEmulator::chipConditions_ {nullptr}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Handle to table of chip-dependent conditions</p>
<p>The defaults are listed below and are separate parameters passed through the python configuration. </p>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8h_source.html#l00375">375</a> of file <a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="HgcrocEmulator_8h_source.html#l00072">condition()</a>, and <a class="el" href="HgcrocEmulator_8h_source.html#l00180">getCondition()</a>.</p>

</div>
</div>
<a id="aa1a403cc2554201c7098ce6d9674987d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a403cc2554201c7098ce6d9674987d">&#9670;&nbsp;</a></span>conditionNamesToIndex_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;std::string, int&gt; ldmx::HgcrocEmulator::conditionNamesToIndex_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map of condition names to column numbers</p>
<p>mutable so that we can update the cached column values in getCondition during processing. </p>

<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8h_source.html#l00383">383</a> of file <a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="HgcrocEmulator_8h_source.html#l00072">condition()</a>, and <a class="el" href="HgcrocEmulator_8h_source.html#l00180">getCondition()</a>.</p>

</div>
</div>
<a id="ad263134be06668bb251c29643ff3749e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad263134be06668bb251c29643ff3749e">&#9670;&nbsp;</a></span>pulseFunc_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TF1 ldmx::HgcrocEmulator::pulseFunc_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Functional shape of signal pulse in time</p>
<p>Shape parameters are hardcoded into the function currently. Pulse Shape: [0]*((1.0+exp([1]*(-[2]+[3])))*(1.0+exp([5]*(-[6]+[3]))))/((1.0+exp([1]*(x-[2]+[3]-[4])))*(1.0+exp([5]*(x-[6]+[3]-[4])))) p[0] = amplitude (height of peak in mV) p[1] = rate of up slope - rateUpSlope_ p[2] = time of up slope relative to shape fit - timeUpSlope_ p[3] = time of peak relative to shape fit - timePeak_ p[4] = peak time (related to time of hit [ns]) p[5] = rate of down slope - rateDnSlope_ p[6] = time of down slope relative to shape fit - timeDnSlope_</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ V(t) = p_0\frac{(1+\exp(p_1(-p_2+p_3)))(1+\exp(p_5*(-p_6+p_3)))} {(1+\exp(p_1(t-p_2+p_3-p_4)))(1+\exp(p_5*(t-p_6+p_3-p_4)))} \]" src="form_16.png"/>
</p>
 
<p class="definition">Definition at line <a class="el" href="HgcrocEmulator_8h_source.html#l00412">412</a> of file <a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="HgcrocEmulator_8cxx_source.html#l00046">digitize()</a>, and <a class="el" href="HgcrocEmulator_8cxx_source.html#l00006">HgcrocEmulator()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Tools/include/Tools/<a class="el" href="HgcrocEmulator_8h_source.html">HgcrocEmulator.h</a></li>
<li>Tools/src/Tools/<a class="el" href="HgcrocEmulator_8cxx_source.html">HgcrocEmulator.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>