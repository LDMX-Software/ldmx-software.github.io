<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.2"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: ldmx::HgcrocTriggerCalculations Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>ldmx</b></li><li class="navelem"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html">HgcrocTriggerCalculations</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classldmx_1_1HgcrocTriggerCalculations-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ldmx::HgcrocTriggerCalculations Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Contains the core logic for the Hgcroc trigger calculations.  
 <a href="classldmx_1_1HgcrocTriggerCalculations.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="HgcrocTriggerCalculations_8h_source.html">HgcrocTriggerCalculations.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af204baf26991a7df729ccd504f77360c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#af204baf26991a7df729ccd504f77360c">HgcrocTriggerCalculations</a> (const <a class="el" href="classconditions_1_1IntegerTableCondition.html">conditions::IntegerTableCondition</a> &amp;ict)</td></tr>
<tr class="separator:af204baf26991a7df729ccd504f77360c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b40766dc1614fd071e8791f8a31ea84"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#a0b40766dc1614fd071e8791f8a31ea84">addDigi</a> (unsigned int id, unsigned int tid, int adc, int tot)</td></tr>
<tr class="separator:a0b40766dc1614fd071e8791f8a31ea84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e8eae1ca3bcfa6cebdb30e3fe6cb7bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#a2e8eae1ca3bcfa6cebdb30e3fe6cb7bc">compressDigis</a> (int cells_per_trig)</td></tr>
<tr class="separator:a2e8eae1ca3bcfa6cebdb30e3fe6cb7bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d857f7199df3d75ab44f9032a0bf045"><td class="memItemLeft" align="right" valign="top">const std::map&lt; unsigned int, uint8_t &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#a0d857f7199df3d75ab44f9032a0bf045">compressedEnergies</a> () const</td></tr>
<tr class="separator:a0d857f7199df3d75ab44f9032a0bf045"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:abc975e2c92e071359ab41c1439afa003"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#abc975e2c92e071359ab41c1439afa003">singleChannelCharge</a> (int adc, int tot, int adc_ped, int adc_thresh, int tot_ped, int tot_thresh, int tot_gain)</td></tr>
<tr class="separator:abc975e2c92e071359ab41c1439afa003"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:afece286b6da7e14f03a178e2a4edf491"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1HgcrocTriggerConditions.html">HgcrocTriggerConditions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#afece286b6da7e14f03a178e2a4edf491">conditions_</a></td></tr>
<tr class="separator:afece286b6da7e14f03a178e2a4edf491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b226ffc6740c0d385294fe919b60a3"><td class="memItemLeft" align="right" valign="top">std::map&lt; unsigned int, unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#ae4b226ffc6740c0d385294fe919b60a3">linearCharge_</a></td></tr>
<tr class="separator:ae4b226ffc6740c0d385294fe919b60a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a110cdd40e15fe93944eb2c66193944db"><td class="memItemLeft" align="right" valign="top">std::map&lt; unsigned int, uint8_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#a110cdd40e15fe93944eb2c66193944db">compressedCharge_</a></td></tr>
<tr class="separator:a110cdd40e15fe93944eb2c66193944db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Contains the core logic for the Hgcroc trigger calculations. </p>
<p >This class is meant to be created once per event along with the conditions for the chip. These chip conditions are wrapped in an <a class="el" href="classldmx_1_1HgcrocTriggerConditions.html">HgcrocTriggerConditions</a> class for easier access. These chip conditions may change from event-to-event, so it is best to allow for this object to change from event-to-event. </p>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00108">108</a> of file <a class="el" href="HgcrocTriggerCalculations_8h_source.html">HgcrocTriggerCalculations.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="af204baf26991a7df729ccd504f77360c" name="af204baf26991a7df729ccd504f77360c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af204baf26991a7df729ccd504f77360c">&#9670;&nbsp;</a></span>HgcrocTriggerCalculations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ldmx::HgcrocTriggerCalculations::HgcrocTriggerCalculations </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classconditions_1_1IntegerTableCondition.html">conditions::IntegerTableCondition</a> &amp;&#160;</td>
          <td class="paramname"><em>ict</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Construct the chip trigger calculator</p>
<p >Here we pass the table of chip conditions that is used to emulate the chip's behavior for all of the different channel IDs.</p>
<p >We also use this opportunity to double check that the column indices in <a class="el" href="classldmx_1_1HgcrocTriggerConditions.html">HgcrocTriggerConditions</a> match the column indices imported from the input table.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ict</td><td>table of chip conditions </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00055">55</a> of file <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html">HgcrocTriggerCalculations.cxx</a>.</p>
<div class="fragment"><div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    : <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#afece286b6da7e14f03a178e2a4edf491">conditions_</a>{ict, <span class="keyword">true</span>} {}</div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerCalculations_html_afece286b6da7e14f03a178e2a4edf491"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerCalculations.html#afece286b6da7e14f03a178e2a4edf491">ldmx::HgcrocTriggerCalculations::conditions_</a></div><div class="ttdeci">HgcrocTriggerConditions conditions_</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8h_source.html#l00187">HgcrocTriggerCalculations.h:187</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a0b40766dc1614fd071e8791f8a31ea84" name="a0b40766dc1614fd071e8791f8a31ea84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b40766dc1614fd071e8791f8a31ea84">&#9670;&nbsp;</a></span>addDigi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::HgcrocTriggerCalculations::addDigi </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>tid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>adc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Determine the linear charge for the given channel, using the calibration information, and add it to the map of trigger channel IDs to linear charge measurements.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classldmx_1_1HgcrocTriggerCalculations.html#abc975e2c92e071359ab41c1439afa003">singleChannelCharge</a> for how the precision channel measurement is converted to a linear trig-digi charge </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td>Precision channel id (used to lookup in the conditions table) </td></tr>
    <tr><td class="paramname">tid</td><td>Trigger channel id </td></tr>
    <tr><td class="paramname">adc</td><td>ADC measurement of precision channel if not TOT complete </td></tr>
    <tr><td class="paramname">tot</td><td>TOT measurement of precision channel if TOT is complete </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00059">59</a> of file <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html">HgcrocTriggerCalculations.cxx</a>.</p>
<div class="fragment"><div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>                                                          {</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> charge = <a class="code hl_function" href="classldmx_1_1HgcrocTriggerCalculations.html#abc975e2c92e071359ab41c1439afa003">singleChannelCharge</a>(</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>      adc, tot, <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#afece286b6da7e14f03a178e2a4edf491">conditions_</a>.<a class="code hl_function" href="classldmx_1_1HgcrocTriggerConditions.html#a4e116657668ca614b5ddbd98cb6e40ed">adcPedestal</a>(<span class="keywordtype">id</span>), <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#afece286b6da7e14f03a178e2a4edf491">conditions_</a>.<a class="code hl_function" href="classldmx_1_1HgcrocTriggerConditions.html#aa9ab32f0737e285a1a3bb85f5c13c53e">adcThreshold</a>(<span class="keywordtype">id</span>),</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>      <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#afece286b6da7e14f03a178e2a4edf491">conditions_</a>.<a class="code hl_function" href="classldmx_1_1HgcrocTriggerConditions.html#ac32c128d8f3b8c7767bfc3e07c620be9">totPedestal</a>(<span class="keywordtype">id</span>), <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#afece286b6da7e14f03a178e2a4edf491">conditions_</a>.<a class="code hl_function" href="classldmx_1_1HgcrocTriggerConditions.html#a0d0eb1cdbfe9a5efef062e27d6712af4">totThreshold</a>(<span class="keywordtype">id</span>),</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>      <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#afece286b6da7e14f03a178e2a4edf491">conditions_</a>.<a class="code hl_function" href="classldmx_1_1HgcrocTriggerConditions.html#a12bf3fe1360a95e55db8c06bd8f52e9e">totGain</a>(<span class="keywordtype">id</span>));</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>  <span class="keywordflow">if</span> (charge &gt; 0) {</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    std::map&lt;unsigned int, unsigned int&gt;::iterator ic = <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#ae4b226ffc6740c0d385294fe919b60a3">linearCharge_</a>.find(tid);</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="keywordflow">if</span> (ic == <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#ae4b226ffc6740c0d385294fe919b60a3">linearCharge_</a>.end())</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>      <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#ae4b226ffc6740c0d385294fe919b60a3">linearCharge_</a>[tid] = charge;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>      ic-&gt;second += charge;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  }</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>}</div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerCalculations_html_abc975e2c92e071359ab41c1439afa003"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerCalculations.html#abc975e2c92e071359ab41c1439afa003">ldmx::HgcrocTriggerCalculations::singleChannelCharge</a></div><div class="ttdeci">static unsigned int singleChannelCharge(int adc, int tot, int adc_ped, int adc_thresh, int tot_ped, int tot_thresh, int tot_gain)</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8cxx_source.html#l00033">HgcrocTriggerCalculations.cxx:33</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerCalculations_html_ae4b226ffc6740c0d385294fe919b60a3"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerCalculations.html#ae4b226ffc6740c0d385294fe919b60a3">ldmx::HgcrocTriggerCalculations::linearCharge_</a></div><div class="ttdeci">std::map&lt; unsigned int, unsigned int &gt; linearCharge_</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8h_source.html#l00189">HgcrocTriggerCalculations.h:189</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerConditions_html_a0d0eb1cdbfe9a5efef062e27d6712af4"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerConditions.html#a0d0eb1cdbfe9a5efef062e27d6712af4">ldmx::HgcrocTriggerConditions::totThreshold</a></div><div class="ttdeci">int totThreshold(unsigned int id) const</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8h_source.html#l00081">HgcrocTriggerCalculations.h:81</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerConditions_html_a12bf3fe1360a95e55db8c06bd8f52e9e"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerConditions.html#a12bf3fe1360a95e55db8c06bd8f52e9e">ldmx::HgcrocTriggerConditions::totGain</a></div><div class="ttdeci">int totGain(unsigned int id) const</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8h_source.html#l00091">HgcrocTriggerCalculations.h:91</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerConditions_html_a4e116657668ca614b5ddbd98cb6e40ed"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerConditions.html#a4e116657668ca614b5ddbd98cb6e40ed">ldmx::HgcrocTriggerConditions::adcPedestal</a></div><div class="ttdeci">int adcPedestal(unsigned int id) const</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8h_source.html#l00055">HgcrocTriggerCalculations.h:55</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerConditions_html_aa9ab32f0737e285a1a3bb85f5c13c53e"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerConditions.html#aa9ab32f0737e285a1a3bb85f5c13c53e">ldmx::HgcrocTriggerConditions::adcThreshold</a></div><div class="ttdeci">int adcThreshold(unsigned int id) const</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8h_source.html#l00063">HgcrocTriggerCalculations.h:63</a></div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerConditions_html_ac32c128d8f3b8c7767bfc3e07c620be9"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerConditions.html#ac32c128d8f3b8c7767bfc3e07c620be9">ldmx::HgcrocTriggerConditions::totPedestal</a></div><div class="ttdeci">int totPedestal(unsigned int id) const</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8h_source.html#l00073">HgcrocTriggerCalculations.h:73</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00055">ldmx::HgcrocTriggerConditions::adcPedestal()</a>, <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00063">ldmx::HgcrocTriggerConditions::adcThreshold()</a>, <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00187">conditions_</a>, <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00189">linearCharge_</a>, <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00033">singleChannelCharge()</a>, <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00091">ldmx::HgcrocTriggerConditions::totGain()</a>, <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00073">ldmx::HgcrocTriggerConditions::totPedestal()</a>, and <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00081">ldmx::HgcrocTriggerConditions::totThreshold()</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalTrigPrimDigiProducer_8cxx_source.html#l00020">ecal::EcalTrigPrimDigiProducer::produce()</a>.</p>

</div>
</div>
<a id="a2e8eae1ca3bcfa6cebdb30e3fe6cb7bc" name="a2e8eae1ca3bcfa6cebdb30e3fe6cb7bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e8eae1ca3bcfa6cebdb30e3fe6cb7bc">&#9670;&nbsp;</a></span>compressDigis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::HgcrocTriggerCalculations::compressDigis </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>cells_per_trig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Convert the linear charges to compressed charges, with a division depending on the number of cells summed by HGCROC</p>
<p >Fills the map of trigger channel IDs to compressed charge measurements. Some of the lowest order bits are dropped during compression in order to effectively reach the necessary dynamic range. The number of these bits that are dropped depends on the number of cells in each trigger grouping.</p><ul>
<li>9 --&gt; drop 8 lowest order bits --&gt; multiply unpacked charge by 8 to get full amount</li>
<li>4 --&gt; drop 4 lowest order bits --&gt; mutliply unpacked charge by 4 to get full amount</li>
</ul>
<p >@raises Exception if the input cells_per_trig is not 4 or 9. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cells_per_trig</td><td>Valid values are 4 or 9 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00074">74</a> of file <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html">HgcrocTriggerCalculations.cxx</a>.</p>
<div class="fragment"><div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>                                                                {</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>  <span class="keywordtype">int</span> shift;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>  <span class="keywordflow">if</span> (cells_per_trig == 4)</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    shift = 1;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cells_per_trig == 9)</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    shift = 3;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    EXCEPTION_RAISE(<span class="stringliteral">&quot;HgcrocTriggerException&quot;</span>,</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                    <span class="stringliteral">&quot;Invalid number of precision cells per trigger cell: &quot;</span> +</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>                        std::to_string(cells_per_trig));</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>  }</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> ilinear : <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#ae4b226ffc6740c0d385294fe919b60a3">linearCharge_</a>) {</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> lcharge = ilinear.second;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    lcharge = lcharge &gt;&gt; shift;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    uint8_t ccharge = <a class="code hl_function" href="classldmx_1_1HgcrocTrigDigi.html#ae19041646fc5cbedb236ede0f91ecb07">ldmx::HgcrocTrigDigi::linear2Compressed</a>(lcharge);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#a110cdd40e15fe93944eb2c66193944db">compressedCharge_</a>[ilinear.first] = ccharge;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>  }</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>}</div>
<div class="ttc" id="aclassldmx_1_1HgcrocTrigDigi_html_ae19041646fc5cbedb236ede0f91ecb07"><div class="ttname"><a href="classldmx_1_1HgcrocTrigDigi.html#ae19041646fc5cbedb236ede0f91ecb07">ldmx::HgcrocTrigDigi::linear2Compressed</a></div><div class="ttdeci">static uint8_t linear2Compressed(uint32_t lin)</div></div>
<div class="ttc" id="aclassldmx_1_1HgcrocTriggerCalculations_html_a110cdd40e15fe93944eb2c66193944db"><div class="ttname"><a href="classldmx_1_1HgcrocTriggerCalculations.html#a110cdd40e15fe93944eb2c66193944db">ldmx::HgcrocTriggerCalculations::compressedCharge_</a></div><div class="ttdeci">std::map&lt; unsigned int, uint8_t &gt; compressedCharge_</div><div class="ttdef"><b>Definition:</b> <a href="HgcrocTriggerCalculations_8h_source.html#l00191">HgcrocTriggerCalculations.h:191</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00191">compressedCharge_</a>, <a class="el" href="classldmx_1_1HgcrocTrigDigi.html#ae19041646fc5cbedb236ede0f91ecb07">ldmx::HgcrocTrigDigi::linear2Compressed()</a>, and <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00189">linearCharge_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalTrigPrimDigiProducer_8cxx_source.html#l00020">ecal::EcalTrigPrimDigiProducer::produce()</a>.</p>

</div>
</div>
<a id="a0d857f7199df3d75ab44f9032a0bf045" name="a0d857f7199df3d75ab44f9032a0bf045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d857f7199df3d75ab44f9032a0bf045">&#9670;&nbsp;</a></span>compressedEnergies()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::map&lt; unsigned int, uint8_t &gt; &amp; ldmx::HgcrocTriggerCalculations::compressedEnergies </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Access the map of trigger ids to compressed energies </p><dl class="section return"><dt>Returns</dt><dd>const reference to the map of trigger channel ID to compressed charge measurements </dd></dl>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00181">181</a> of file <a class="el" href="HgcrocTriggerCalculations_8h_source.html">HgcrocTriggerCalculations.h</a>.</p>
<div class="fragment"><div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                                                                  {</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classldmx_1_1HgcrocTriggerCalculations.html#a110cdd40e15fe93944eb2c66193944db">compressedCharge_</a>;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00191">compressedCharge_</a>.</p>

<p class="reference">Referenced by <a class="el" href="EcalTrigPrimDigiProducer_8cxx_source.html#l00020">ecal::EcalTrigPrimDigiProducer::produce()</a>.</p>

</div>
</div>
<a id="abc975e2c92e071359ab41c1439afa003" name="abc975e2c92e071359ab41c1439afa003"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc975e2c92e071359ab41c1439afa003">&#9670;&nbsp;</a></span>singleChannelCharge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int ldmx::HgcrocTriggerCalculations::singleChannelCharge </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>adc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>adc_ped</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>adc_thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tot_ped</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tot_thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>tot_gain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Calculates the linear trigger charge for a single precision channel (before 2x2 or 3x3 summing) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">adc</td><td>ADC measurement for the channel </td></tr>
    <tr><td class="paramname">tot</td><td>TOT measurement for the channel or zero if no TOT </td></tr>
    <tr><td class="paramname">adc_ped</td><td>Trigger pedestal to subtract (8 bits, per channel) </td></tr>
    <tr><td class="paramname">adc_thresh</td><td>ADC threshold for noise-suppression in the trigger path (5 bits, global for ROC) </td></tr>
    <tr><td class="paramname">tot_ped</td><td>TOT pedestal (7 bits, group-of-nine) </td></tr>
    <tr><td class="paramname">tot_thresh</td><td>TOT threshold, use this fixed value as "TOT" if the TOT is below this value (8 bits, group-of-nine) </td></tr>
    <tr><td class="paramname">tot_gain</td><td>TOT to charge multiplicative factor (5 bits, integer math, global for ROC) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>linear trigger charge from a single precision channel </dd></dl>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00033">33</a> of file <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html">HgcrocTriggerCalculations.cxx</a>.</p>
<div class="fragment"><div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>                  {</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> charge_adc = 0;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  <span class="keywordflow">if</span> (adc &gt; (adc_ped + adc_thresh))</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    charge_adc = adc - adc_ped;  <span class="comment">// otherwise zero</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> eff_tot{0};</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>  <span class="keywordflow">if</span> (tot &gt; tot_thresh &amp;&amp; tot &gt; tot_ped)</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    eff_tot = tot - tot_ped;</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    eff_tot = tot_thresh - tot_ped;</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span> </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> charge_tot{0};</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  charge_tot = eff_tot * tot_gain;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> charge_final = (tot != 0) ? (charge_tot) : (charge_adc);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>  <span class="keywordflow">return</span> charge_final;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00059">addDigi()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a110cdd40e15fe93944eb2c66193944db" name="a110cdd40e15fe93944eb2c66193944db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a110cdd40e15fe93944eb2c66193944db">&#9670;&nbsp;</a></span>compressedCharge_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;unsigned int, uint8_t&gt; ldmx::HgcrocTriggerCalculations::compressedCharge_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >A map of trigger channel id to compressed charge </p>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00191">191</a> of file <a class="el" href="HgcrocTriggerCalculations_8h_source.html">HgcrocTriggerCalculations.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00074">compressDigis()</a>, and <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00181">compressedEnergies()</a>.</p>

</div>
</div>
<a id="afece286b6da7e14f03a178e2a4edf491" name="afece286b6da7e14f03a178e2a4edf491"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afece286b6da7e14f03a178e2a4edf491">&#9670;&nbsp;</a></span>conditions_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classldmx_1_1HgcrocTriggerConditions.html">HgcrocTriggerConditions</a> ldmx::HgcrocTriggerCalculations::conditions_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >The conditions to be used </p>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00187">187</a> of file <a class="el" href="HgcrocTriggerCalculations_8h_source.html">HgcrocTriggerCalculations.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00059">addDigi()</a>.</p>

</div>
</div>
<a id="ae4b226ffc6740c0d385294fe919b60a3" name="ae4b226ffc6740c0d385294fe919b60a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b226ffc6740c0d385294fe919b60a3">&#9670;&nbsp;</a></span>linearCharge_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;unsigned int, unsigned int&gt; ldmx::HgcrocTriggerCalculations::linearCharge_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >A map of trigger channel id to linear charge </p>

<p class="definition">Definition at line <a class="el" href="HgcrocTriggerCalculations_8h_source.html#l00189">189</a> of file <a class="el" href="HgcrocTriggerCalculations_8h_source.html">HgcrocTriggerCalculations.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00059">addDigi()</a>, and <a class="el" href="HgcrocTriggerCalculations_8cxx_source.html#l00074">compressDigis()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>Tools/include/Tools/<a class="el" href="HgcrocTriggerCalculations_8h_source.html">HgcrocTriggerCalculations.h</a></li>
<li>Tools/src/Tools/<a class="el" href="HgcrocTriggerCalculations_8cxx_source.html">HgcrocTriggerCalculations.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>