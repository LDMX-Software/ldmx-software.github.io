<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.18"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: G4eDarkBremsstrahlungModel Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classG4eDarkBremsstrahlungModel-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">G4eDarkBremsstrahlungModel Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structG4eDarkBremsstrahlungModel_1_1Chi.html">Chi</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structG4eDarkBremsstrahlungModel_1_1DiffCross.html">DiffCross</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structG4eDarkBremsstrahlungModel_1_1OutgoingKinematics.html">OutgoingKinematics</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:afd9431cde55e971717f4597be27d36d2"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2">DarkBremMethod</a> { <b>ForwardOnly</b> = 1, 
<a class="el" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2a0d503551ee89e3153881e83c2b70647a">CMScaling</a>, 
<a class="el" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2a7b66a2198b4a37476f739f9474a8482a">Undefined</a>
 }</td></tr>
<tr class="separator:afd9431cde55e971717f4597be27d36d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a799e773786195c7440c02c78d1852e11"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a799e773786195c7440c02c78d1852e11">G4eDarkBremsstrahlungModel</a> (const G4ParticleDefinition *p=0, const G4String &amp;theName=&quot;eDBrem&quot;)</td></tr>
<tr class="separator:a799e773786195c7440c02c78d1852e11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c0100a177c7ad93fb96ecee3cfdfdb"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a11c0100a177c7ad93fb96ecee3cfdfdb">~G4eDarkBremsstrahlungModel</a> ()</td></tr>
<tr class="separator:a11c0100a177c7ad93fb96ecee3cfdfdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73d1879f78a4951508383ddd4cf6f925"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a73d1879f78a4951508383ddd4cf6f925">Initialise</a> (const G4ParticleDefinition *p, const G4DataVector &amp;cuts)</td></tr>
<tr class="separator:a73d1879f78a4951508383ddd4cf6f925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66ef5938ea90c90b921c4dd0646bff65"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a66ef5938ea90c90b921c4dd0646bff65">SampleSecondaries</a> (std::vector&lt; G4DynamicParticle * &gt; *secondaries, const G4MaterialCutsCouple *, const G4DynamicParticle *primary, G4double tmin, G4double maxEnergy)</td></tr>
<tr class="separator:a66ef5938ea90c90b921c4dd0646bff65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7adf731e39c0fe6f7a1e82f2d3645d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#ad7adf731e39c0fe6f7a1e82f2d3645d6">SetMethod</a> (<a class="el" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2">DarkBremMethod</a> method)</td></tr>
<tr class="separator:ad7adf731e39c0fe6f7a1e82f2d3645d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac03b3e608eb59a1a8801a7e0fcc6cb1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#ac03b3e608eb59a1a8801a7e0fcc6cb1f">SetMadGraphDataFile</a> (std::string file)</td></tr>
<tr class="separator:ac03b3e608eb59a1a8801a7e0fcc6cb1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:af013ac6d9a00269ad2667c7632177fbc"><td class="memItemLeft" align="right" valign="top">const G4Element *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#af013ac6d9a00269ad2667c7632177fbc">SelectRandomAtom</a> (const G4MaterialCutsCouple *couple)</td></tr>
<tr class="separator:af013ac6d9a00269ad2667c7632177fbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a1f6676019afd6dbd745048979d6d0b91"><td class="memItemLeft" align="right" valign="top">const G4ParticleDefinition *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a1f6676019afd6dbd745048979d6d0b91">particle_</a></td></tr>
<tr class="separator:a1f6676019afd6dbd745048979d6d0b91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5ed0705c9d8a047ae8136f856042f40"><td class="memItemLeft" align="right" valign="top">G4ParticleChangeForLoss *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">fParticleChange_</a></td></tr>
<tr class="separator:aa5ed0705c9d8a047ae8136f856042f40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:ae541628fa4dc2ae2ac029ed3abd28c68"><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#ae541628fa4dc2ae2ac029ed3abd28c68">StateType</a></td></tr>
<tr class="separator:ae541628fa4dc2ae2ac029ed3abd28c68"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a39026424216039a82f476682f8cc8126"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a39026424216039a82f476682f8cc8126">SetParticle</a> (const G4ParticleDefinition *p)</td></tr>
<tr class="separator:a39026424216039a82f476682f8cc8126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9477cfa6081acf6e3c51399822736d8"><td class="memItemLeft" align="right" valign="top"><a id="ae9477cfa6081acf6e3c51399822736d8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>ParseLHE</b> (std::string fname)</td></tr>
<tr class="separator:ae9477cfa6081acf6e3c51399822736d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8844dbde8fa44a5cd26eb5608af6d831"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a8844dbde8fa44a5cd26eb5608af6d831">MakePlaceholders</a> ()</td></tr>
<tr class="separator:a8844dbde8fa44a5cd26eb5608af6d831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09d4d7609a2d492e26051f76b9dd13aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structG4eDarkBremsstrahlungModel_1_1OutgoingKinematics.html">G4eDarkBremsstrahlungModel::OutgoingKinematics</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a09d4d7609a2d492e26051f76b9dd13aa">GetMadgraphData</a> (double E0)</td></tr>
<tr class="separator:a09d4d7609a2d492e26051f76b9dd13aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf9523a77918dbecf88a82ff4b9ba8ff"><td class="memItemLeft" align="right" valign="top">virtual G4double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#aaf9523a77918dbecf88a82ff4b9ba8ff">ComputeCrossSectionPerAtom</a> (const G4ParticleDefinition *, G4double E0, G4double Z, G4double A, G4double cut, G4double)</td></tr>
<tr class="separator:aaf9523a77918dbecf88a82ff4b9ba8ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf7d66717226c3c281748f2c4493cb6c"><td class="memItemLeft" align="right" valign="top">G4DataVector *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#adf7d66717226c3c281748f2c4493cb6c">ComputePartialSumSigma</a> (const G4Material *material, G4double kineticEnergy, G4double cut)</td></tr>
<tr class="separator:adf7d66717226c3c281748f2c4493cb6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee28b6810d3304fe1eb67596312acbbe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classG4eDarkBremsstrahlungModel.html">G4eDarkBremsstrahlungModel</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#aee28b6810d3304fe1eb67596312acbbe">operator=</a> (const <a class="el" href="classG4eDarkBremsstrahlungModel.html">G4eDarkBremsstrahlungModel</a> &amp;right)</td></tr>
<tr class="separator:aee28b6810d3304fe1eb67596312acbbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45dc2bcac247d29ef6b0913a556d8706"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a45dc2bcac247d29ef6b0913a556d8706">G4eDarkBremsstrahlungModel</a> (const <a class="el" href="classG4eDarkBremsstrahlungModel.html">G4eDarkBremsstrahlungModel</a> &amp;)</td></tr>
<tr class="separator:a45dc2bcac247d29ef6b0913a556d8706"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a8fb5279d5de92deab62969171c5823e4"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a8fb5279d5de92deab62969171c5823e4">maxIterations_</a> {10000}</td></tr>
<tr class="separator:a8fb5279d5de92deab62969171c5823e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c4126a806f8678b215223d2ccdb9354"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a></td></tr>
<tr class="separator:a7c4126a806f8678b215223d2ccdb9354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65f5ec091fbd1a185487fdb6191c9fde"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a></td></tr>
<tr class="separator:a65f5ec091fbd1a185487fdb6191c9fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33e9d70ecff37406defc1ac75b055aa7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2">DarkBremMethod</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a33e9d70ecff37406defc1ac75b055aa7">method_</a> {DarkBremMethod::Undefined}</td></tr>
<tr class="separator:a33e9d70ecff37406defc1ac75b055aa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bc59ee5da2099a71a9149b1f2cd3e74"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a8bc59ee5da2099a71a9149b1f2cd3e74">alwaysCreateNewElectron_</a> {true}</td></tr>
<tr class="separator:a8bc59ee5da2099a71a9149b1f2cd3e74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c357850a78b284df86d35cd23df3f3"><td class="memItemLeft" align="right" valign="top">std::map&lt; double, std::vector&lt; <a class="el" href="structG4eDarkBremsstrahlungModel_1_1OutgoingKinematics.html">OutgoingKinematics</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#a35c357850a78b284df86d35cd23df3f3">madGraphData_</a></td></tr>
<tr class="separator:a35c357850a78b284df86d35cd23df3f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa99e94204e7d86b0043fcfcc12d7c051"><td class="memItemLeft" align="right" valign="top">std::map&lt; double, unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a></td></tr>
<tr class="separator:aa99e94204e7d86b0043fcfcc12d7c051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ddb6fa56dc73aa65d83f69ec05c3798"><td class="memItemLeft" align="right" valign="top"><a id="a1ddb6fa56dc73aa65d83f69ec05c3798"></a>
std::vector&lt; G4DataVector * &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>partialSumSigma_</b></td></tr>
<tr class="separator:a1ddb6fa56dc73aa65d83f69ec05c3798"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Geant4 implementation of the model for a particle undergoing a dark brem.</p>
<p>This is where all the heavy lifting in terms of calculating cross sections and actually having an electron do a dark brem occurs. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00025">25</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ae541628fa4dc2ae2ac029ed3abd28c68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae541628fa4dc2ae2ac029ed3abd28c68">&#9670;&nbsp;</a></span>StateType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;double&gt; <a class="el" href="classG4eDarkBremsstrahlungModel.html#ae541628fa4dc2ae2ac029ed3abd28c68">G4eDarkBremsstrahlungModel::StateType</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helpful typedef for boost integration. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00106">106</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="afd9431cde55e971717f4597be27d36d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd9431cde55e971717f4597be27d36d2">&#9670;&nbsp;</a></span>DarkBremMethod</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2">G4eDarkBremsstrahlungModel::DarkBremMethod</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Possible methods to dark brem inside of this model. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="afd9431cde55e971717f4597be27d36d2a0d503551ee89e3153881e83c2b70647a"></a>CMScaling&#160;</td><td class="fielddoc"><p>Use actual electron energy and get pT from LHE (such that pT^2+me^2 &lt; Eacc^2) </p>
</td></tr>
<tr><td class="fieldname"><a id="afd9431cde55e971717f4597be27d36d2a7b66a2198b4a37476f739f9474a8482a"></a>Undefined&#160;</td><td class="fielddoc"><p>Boost LHE vertex momenta to the actual electron energy. </p>
<p>Use LHE vertex as is </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00034">34</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                           {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;            ForwardOnly = 1, </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;            <a class="code" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2a0d503551ee89e3153881e83c2b70647a">CMScaling</a>, </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;            <a class="code" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2a7b66a2198b4a37476f739f9474a8482a">Undefined</a> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a799e773786195c7440c02c78d1852e11"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a799e773786195c7440c02c78d1852e11">&#9670;&nbsp;</a></span>G4eDarkBremsstrahlungModel() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">G4eDarkBremsstrahlungModel::G4eDarkBremsstrahlungModel </td>
          <td>(</td>
          <td class="paramtype">const G4ParticleDefinition *&#160;</td>
          <td class="paramname"><em>p</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4String &amp;&#160;</td>
          <td class="paramname"><em>theName</em> = <code>&quot;eDBrem&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the particle definition that this model will represent. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00036">36</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    : G4VEmModel(theName),</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <a class="code" href="classG4eDarkBremsstrahlungModel.html#a1f6676019afd6dbd745048979d6d0b91">particle_</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">fParticleChange_</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <a class="code" href="classG4eDarkBremsstrahlungModel.html#a33e9d70ecff37406defc1ac75b055aa7">method_</a>(DarkBremMethod::Undefined) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span>(p) { <a class="code" href="classG4eDarkBremsstrahlungModel.html#a39026424216039a82f476682f8cc8126">SetParticle</a>(p); } <span class="comment">//Verify that the particle is an electron.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>  = <a class="code" href="classG4APrime.html#a44abfc4088b55222b87331a8bc34d6ae">G4APrime::APrime</a>()    -&gt;GetPDGMass()/CLHEP::GeV; <span class="comment">//Get the A&#39; mass in GeV</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a> = G4Electron::Electron()-&gt;GetPDGMass()/CLHEP::GeV;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4APrime_8cxx_source.html#l00037">G4APrime::APrime()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00276">MA_</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00279">Mel_</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00291">SetParticle()</a>.</p>

</div>
</div>
<a id="a11c0100a177c7ad93fb96ecee3cfdfdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c0100a177c7ad93fb96ecee3cfdfdb">&#9670;&nbsp;</a></span>~G4eDarkBremsstrahlungModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4eDarkBremsstrahlungModel::~G4eDarkBremsstrahlungModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Destructor</p>
<p>Attempt to cleanup hanging pointers and leftover memory. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00050">50</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                                        {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">for</span> (G4DataVector *dv : partialSumSigma_ ) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;       <span class="keywordflow">if</span> ( dv )  <span class="keyword">delete</span> dv;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    partialSumSigma_.clear();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#a35c357850a78b284df86d35cd23df3f3">madGraphData_</a>.clear();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a>.clear();</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00307">currentDataPoints_</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00296">madGraphData_</a>.</p>

</div>
</div>
<a id="a45dc2bcac247d29ef6b0913a556d8706"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45dc2bcac247d29ef6b0913a556d8706">&#9670;&nbsp;</a></span>G4eDarkBremsstrahlungModel() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4eDarkBremsstrahlungModel::G4eDarkBremsstrahlungModel </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classG4eDarkBremsstrahlungModel.html">G4eDarkBremsstrahlungModel</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Hide copy constructor </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aaf9523a77918dbecf88a82ff4b9ba8ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf9523a77918dbecf88a82ff4b9ba8ff">&#9670;&nbsp;</a></span>ComputeCrossSectionPerAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4double G4eDarkBremsstrahlungModel::ComputeCrossSectionPerAtom </td>
          <td>(</td>
          <td class="paramtype">const G4ParticleDefinition *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>E0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>cut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Calculates the cross section per atom in GEANT4 internal units. Uses WW approximation to find the total cross section, performing numerical integrals over x and theta.</p>
<p>Non named parameters are not used.</p>
<p>Numerical integrals are done using boost::numeric::odeint.</p>
<p>Integrate <a class="el" href="structG4eDarkBremsstrahlungModel_1_1Chi.html">Chi</a> from <img class="formulaInl" alt="$m_A^4/(4E_0^2)$" src="form_12.png"/> to <img class="formulaInl" alt="$m_A^2$" src="form_13.png"/></p>
<p>Integrate diffcross from 0 to <img class="formulaInl" alt="$min(1-m_e/E_0,1-m_A/E_0)$" src="form_14.png"/></p>
<p>Total cross section is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \sigma = 4 \frac{pb}{GeV}\alpha_{EW}^3 \int \chi(t)dt \int \frac{d\sigma}{dx}(x)dx \]" src="form_15.png"/>
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">E0</td><td>energy of beam (incoming particle) </td></tr>
    <tr><td class="paramname">Z</td><td>atomic number of atom </td></tr>
    <tr><td class="paramname">A</td><td>atomic mass of atom </td></tr>
    <tr><td class="paramname">cut</td><td>minimum energy cut to calculate cross section </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>cross section (0. if outside energy cuts) </dd></dl>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00400">400</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                                                      {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> ( E0 &lt; keV or E0 &lt; cut) <span class="keywordflow">return</span> 0.; <span class="comment">//outside viable region for model</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    E0 = E0 / CLHEP::GeV; <span class="comment">//Change energy to GeV.</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">if</span>(E0 &lt; 2.*<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>) <span class="keywordflow">return</span> 0.; <span class="comment">//can&#39;t produce a prime</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">//begin: chi-formfactor calculation</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    Chi chiformfactor;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">//  set parameters</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    chiformfactor.A  = A;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    chiformfactor.Z  = Z;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    chiformfactor.E0 = E0;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    chiformfactor.MA = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    chiformfactor.Mel = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">double</span> tmin = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>*<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>*<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>*<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>/(4.*E0*E0);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordtype">double</span> tmax = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>*<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">//Integrate over chi.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#ae541628fa4dc2ae2ac029ed3abd28c68">StateType</a> integral(1);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    integral[0] = 0.; <span class="comment">//start integral value at zero</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    boost::numeric::odeint::integrate (</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            chiformfactor <span class="comment">// how to calculate integrand</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            , integral <span class="comment">// integral result</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            , tmin <span class="comment">// integral lower limit</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            , tmax <span class="comment">// integral upper limit</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            , (tmax - tmin)/1000 <span class="comment">// dt - initial, adapts based off error</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            );</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    </div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    G4double ChiRes = integral[0];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="comment">//Integrate over x. Can use log approximation instead, which falls off at high A&#39; mass.</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    DiffCross diffcross;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    diffcross.E0 = E0;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    diffcross.MA = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    diffcross.Mel = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">double</span> xmin = 0;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordtype">double</span> xmax = 1;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>/E0)&gt;(<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>/E0)) xmax = 1-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>/E0;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">else</span> xmax = 1-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>/E0;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">//Integrate over differential cross section.</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    integral[0] = 0.; <span class="comment">//start integral value at zero</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    boost::numeric::odeint::integrate (</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            diffcross <span class="comment">// how to calculate integrand</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            , integral <span class="comment">// integral result</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            , xmin <span class="comment">// integral lower limit</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            , xmax <span class="comment">// integral upper limit</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            , (xmax - xmin)/1000 <span class="comment">// dx - initial, adapts based off error</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            );</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    G4double DsDx = integral[0];</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    G4double GeVtoPb = 3.894E08;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    G4double alphaEW = 1.0/137.0;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    G4double epsilBench = 1;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    G4double cross = GeVtoPb*4.*alphaEW*alphaEW*alphaEW*epsilBench*epsilBench*ChiRes*DsDx*CLHEP::picobarn;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">if</span>(cross &lt; 0.) <span class="keywordflow">return</span> 0.; <span class="comment">//safety check all the math</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">return</span> cross;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00131">G4eDarkBremsstrahlungModel::Chi::E0</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00132">G4eDarkBremsstrahlungModel::Chi::MA</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00160">G4eDarkBremsstrahlungModel::DiffCross::MA</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00276">MA_</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00133">G4eDarkBremsstrahlungModel::Chi::Mel</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00161">G4eDarkBremsstrahlungModel::DiffCross::Mel</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00279">Mel_</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00130">G4eDarkBremsstrahlungModel::Chi::Z</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00471">ComputePartialSumSigma()</a>.</p>

</div>
</div>
<a id="adf7d66717226c3c281748f2c4493cb6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf7d66717226c3c281748f2c4493cb6c">&#9670;&nbsp;</a></span>ComputePartialSumSigma()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4DataVector * G4eDarkBremsstrahlungModel::ComputePartialSumSigma </td>
          <td>(</td>
          <td class="paramtype">const G4Material *&#160;</td>
          <td class="paramname"><em>material</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>kineticEnergy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>cut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Build the table of cross section per element.</p>
<p>The table is built for MATERIALS. This table is used by DoIt to select randomly an element in the material.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">material</td><td>Material to build cross section table for </td></tr>
    <tr><td class="paramname">kineticEnergy</td><td>kinetic energy of incoming particle </td></tr>
    <tr><td class="paramname">cut</td><td>minimum energy cut on cross section </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>G4DataVector of elements to cross sections for the input material. </dd></dl>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00471">471</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                                        {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    G4int nElements = material-&gt;GetNumberOfElements();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keyword">const</span> G4ElementVector* theElementVector = material-&gt;GetElementVector();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keyword">const</span> G4double* theAtomNumDensityVector = material-&gt;GetAtomicNumDensityVector();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    G4DataVector* dv = <span class="keyword">new</span> G4DataVector(); <span class="comment">//stored into partialSumSigma_ and then cleaned up later</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    G4double cross = 0.0;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">for</span> (G4int i=0; i&lt;nElements; i++ ) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        cross += theAtomNumDensityVector[i] * <a class="code" href="classG4eDarkBremsstrahlungModel.html#aaf9523a77918dbecf88a82ff4b9ba8ff">ComputeCrossSectionPerAtom</a>( </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <a class="code" href="classG4eDarkBremsstrahlungModel.html#a1f6676019afd6dbd745048979d6d0b91">particle_</a>, kineticEnergy, (*theElementVector)[i]-&gt;GetZ(), (*theElementVector)[i]-&gt;GetA(), cut, 0.</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                );</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        dv-&gt;push_back(cross);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">return</span> dv;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00400">ComputeCrossSectionPerAtom()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00265">particle_</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00059">Initialise()</a>.</p>

</div>
</div>
<a id="a09d4d7609a2d492e26051f76b9dd13aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09d4d7609a2d492e26051f76b9dd13aa">&#9670;&nbsp;</a></span>GetMadgraphData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structG4eDarkBremsstrahlungModel_1_1OutgoingKinematics.html">G4eDarkBremsstrahlungModel::OutgoingKinematics</a> G4eDarkBremsstrahlungModel::GetMadgraphData </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>E0</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns mad graph data given an energy [GeV].</p>
<p>Gets the energy fraction and Pt from the imported LHE data. E0 should be in GeV, returns the total energy and Pt in GeV. Scales from the closest imported beam energy above the given value (scales down to avoid biasing issues).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">E0</td><td>energy of particle undergoing dark brem [GeV] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>total energy and transverse momentum of particle [GeV] </dd></dl>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00373">373</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                                                                                  {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    OutgoingKinematics cmdata; <span class="comment">//data frame to return</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">//Cycle through imported beam energies until the closest one above is found, or the max is reached.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordtype">double</span> samplingE = 0.;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;keyVal : <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a> ) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        samplingE = keyVal.first; <span class="comment">//move samplingE up</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">//check if went under the sampling energy </span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="comment">//  the map is sorted by key, so we can be done right after E0 goes under samplingE</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> ( E0 &lt; samplingE ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">//now samplingE is the closest energy above E0 or the maximum energy imported from mad graph</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">//Need to loop around if we hit the end, when the size of madGraphData_[samplingE] is smaller than </span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">//  the number of events we want</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a>.at(samplingE)&gt;=<a class="code" href="classG4eDarkBremsstrahlungModel.html#a35c357850a78b284df86d35cd23df3f3">madGraphData_</a>.at(samplingE).size()) {<a class="code" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a>[samplingE] = 0;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">//Get the lorentz vectors from the index given by the placeholder.</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    cmdata = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a35c357850a78b284df86d35cd23df3f3">madGraphData_</a>.at(samplingE).at(<a class="code" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a>.at(samplingE));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">//Increment the current index</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a>[samplingE]++;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span> cmdata;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00307">currentDataPoints_</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00296">madGraphData_</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">SampleSecondaries()</a>.</p>

</div>
</div>
<a id="a73d1879f78a4951508383ddd4cf6f925"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73d1879f78a4951508383ddd4cf6f925">&#9670;&nbsp;</a></span>Initialise()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void G4eDarkBremsstrahlungModel::Initialise </td>
          <td>(</td>
          <td class="paramtype">const G4ParticleDefinition *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4DataVector &amp;&#160;</td>
          <td class="paramname"><em>cuts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the cuts using the particle definition and comput the partial sum sigma. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00059">59</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                                                                        {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span>(p) { <a class="code" href="classG4eDarkBremsstrahlungModel.html#a39026424216039a82f476682f8cc8126">SetParticle</a>(p); }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    G4double highKinEnergy = this-&gt;HighEnergyLimit();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keyword">const</span> G4ProductionCutsTable* theCoupleTable = G4ProductionCutsTable::GetProductionCutsTable();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">if</span>(theCoupleTable) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        G4int numOfCouples = theCoupleTable-&gt;GetTableSize();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        G4int nn = partialSumSigma_.size();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        G4int nc = cuts.size();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">if</span>(nn &gt; 0) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="comment">//reset partialSumSigma</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">for</span> (G4DataVector *dv : partialSumSigma_ ) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">if</span> ( dv )  <span class="keyword">delete</span> dv;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            partialSumSigma_.clear();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="keywordflow">for</span> (G4int i=0; i&lt;numOfCouples; i++) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            G4double cute   = DBL_MAX;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            <span class="keywordflow">if</span>(i &lt; nc) cute = cuts[i];</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keyword">const</span> G4MaterialCutsCouple* couple = theCoupleTable-&gt;GetMaterialCutsCouple(i);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keyword">const</span> G4Material* material = couple-&gt;GetMaterial();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            G4DataVector* dv = <a class="code" href="classG4eDarkBremsstrahlungModel.html#adf7d66717226c3c281748f2c4493cb6c">ComputePartialSumSigma</a>(material, 0.5*highKinEnergy,std::min(cute, 0.25*highKinEnergy));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            partialSumSigma_.push_back(dv);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span>(not <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">fParticleChange_</a>) <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">fParticleChange_</a> = GetParticleChangeForLoss();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00471">ComputePartialSumSigma()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00268">fParticleChange_</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00291">SetParticle()</a>.</p>

</div>
</div>
<a id="a8844dbde8fa44a5cd26eb5608af6d831"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8844dbde8fa44a5cd26eb5608af6d831">&#9670;&nbsp;</a></span>MakePlaceholders()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void G4eDarkBremsstrahlungModel::MakePlaceholders </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Fill vector of energies with the same number of items as the madgraph data. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00364">364</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                                  {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a>.clear();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#a8fb5279d5de92deab62969171c5823e4">maxIterations_</a> = 10000;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">for</span> ( <span class="keyword">const</span> <span class="keyword">auto</span> &amp;iter : <a class="code" href="classG4eDarkBremsstrahlungModel.html#a35c357850a78b284df86d35cd23df3f3">madGraphData_</a> ) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">currentDataPoints_</a>[iter.first] = int(G4UniformRand()*iter.second.size());</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">if</span> ( iter.second.size() &lt; <a class="code" href="classG4eDarkBremsstrahlungModel.html#a8fb5279d5de92deab62969171c5823e4">maxIterations_</a> ) <a class="code" href="classG4eDarkBremsstrahlungModel.html#a8fb5279d5de92deab62969171c5823e4">maxIterations_</a> = iter.second.size();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00307">currentDataPoints_</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00296">madGraphData_</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00273">maxIterations_</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00196">SetMadGraphDataFile()</a>.</p>

</div>
</div>
<a id="aee28b6810d3304fe1eb67596312acbbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee28b6810d3304fe1eb67596312acbbe">&#9670;&nbsp;</a></span>operator=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classG4eDarkBremsstrahlungModel.html">G4eDarkBremsstrahlungModel</a>&amp; G4eDarkBremsstrahlungModel::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classG4eDarkBremsstrahlungModel.html">G4eDarkBremsstrahlungModel</a> &amp;&#160;</td>
          <td class="paramname"><em>right</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Hide assignment operator </p>

</div>
</div>
<a id="a66ef5938ea90c90b921c4dd0646bff65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66ef5938ea90c90b921c4dd0646bff65">&#9670;&nbsp;</a></span>SampleSecondaries()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void G4eDarkBremsstrahlungModel::SampleSecondaries </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; G4DynamicParticle * &gt; *&#160;</td>
          <td class="paramname"><em>secondaries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4MaterialCutsCouple *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const G4DynamicParticle *&#160;</td>
          <td class="paramname"><em>primary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>tmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">G4double&#160;</td>
          <td class="paramname"><em>maxEnergy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Simulates the emission of a dark photon + electron.</p>
<p>Gets an energy fraction and Pt from madgraph files. Scales the energy so that the fraction of kinectic energy is constant, keeps the Pt constant. If the Pt is larger than the new energy, that event is skipped, and a new one is taken from the file.</p>
<p>Deactivates the dark brem, ensuring only one dark brem per step and per event. Needs to be reactived in the end of event action.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">secondaries</td><td>vector of primary particle's offspring </td></tr>
    <tr><td class="paramname">primary</td><td>particle that could go dark brem </td></tr>
    <tr><td class="paramname">tmin</td><td>minimum energy possible for sampling </td></tr>
    <tr><td class="paramname">maxEnergy</td><td>maximum energy possible for sampling </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">90</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                                                      {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//Deactivate the process after one dark brem. Needs to be reactivated in the end of event action. </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">//If this is in the stepping action instead, more than one brem can occur within each step.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    G4bool state = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    G4String pname = <span class="stringliteral">&quot;biasWrapper(eDBrem)&quot;</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    G4ProcessTable* ptable = G4ProcessTable::GetProcessTable();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    ptable-&gt;SetProcessActivation(pname,state);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> ( G4RunManager::GetRunManager()-&gt;GetVerboseLevel() &gt; 1 ) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;[ G4eDarkBremsstrahlungModel ] : A dark brem occurred!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    G4double E0 = primary-&gt;GetTotalEnergy();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    G4double tmax = std::min(maxEnergy, E0);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span>(tmin &gt;= tmax) { <span class="keywordflow">return</span>; } <span class="comment">// limits of the energy sampling</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    E0 = E0 / CLHEP::GeV; <span class="comment">//Convert the energy to GeV, the units used in the LHE files.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    OutgoingKinematics data = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a09d4d7609a2d492e26051f76b9dd13aa">GetMadgraphData</a>(E0);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">double</span> EAcc   = (data.electron.E()-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>)/(data.E-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>)*(E0-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>); </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">double</span> Pt     = data.electron.Pt();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">double</span> P      = sqrt(EAcc*EAcc-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>*<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">double</span> PhiAcc = data.electron.Phi();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="classG4eDarkBremsstrahlungModel.html#a33e9d70ecff37406defc1ac75b055aa7">method_</a> == DarkBremMethod::ForwardOnly ) { </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="keywordflow">while</span>(Pt*Pt+<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>*<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>&gt;EAcc*EAcc) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="comment">//Skip events until the Pt is less than the energy.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            i++;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            data = <a class="code" href="classG4eDarkBremsstrahlungModel.html#a09d4d7609a2d492e26051f76b9dd13aa">GetMadgraphData</a>(E0);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            EAcc = (data.electron.E()-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>)/(data.E-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>)*(E0-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            Pt = data.electron.Pt();</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            P = sqrt(EAcc*EAcc-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>*<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            PhiAcc = data.electron.Phi();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">if</span>(i &gt; <a class="code" href="classG4eDarkBremsstrahlungModel.html#a8fb5279d5de92deab62969171c5823e4">maxIterations_</a>) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;[ G4eDarkBremsstrahlungModel ] : &quot;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;Did not manage to simulate with E0 = &quot;</span> &lt;&lt; E0</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot; and EAcc = &quot;</span> &lt;&lt; EAcc &lt;&lt; std::endl;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code" href="classG4eDarkBremsstrahlungModel.html#a33e9d70ecff37406defc1ac75b055aa7">method_</a> == DarkBremMethod::CMScaling ) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        TLorentzVector el(data.electron.X(),data.electron.Y(),data.electron.Z(),data.electron.E());</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordtype">double</span> ediff = data.E-E0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        TLorentzVector newcm(</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                data.centerMomentum.X(),data.centerMomentum.Y()</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                ,data.centerMomentum.Z()-ediff,data.centerMomentum.E()-ediff);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        el.Boost(-1.*data.centerMomentum.BoostVector());</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        el.Boost(newcm.BoostVector());</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordtype">double</span> newE = (data.electron.E()-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>)/(data.E-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>)*(E0-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">Mel_</a>-<a class="code" href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">MA_</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        el.SetE(newE);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        EAcc = el.E();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        Pt = el.Pt();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        P = el.P();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classG4eDarkBremsstrahlungModel.html#a33e9d70ecff37406defc1ac75b055aa7">method_</a> == DarkBremMethod::Undefined ) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        EAcc = E0;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        P = primary-&gt;GetTotalMomentum();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        Pt = sqrt(primary-&gt;Get4Momentum().px()*primary-&gt;Get4Momentum().px()+primary-&gt;Get4Momentum().py()*primary-&gt;Get4Momentum().py());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8">EXCEPTION_RAISE</a>(</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="stringliteral">&quot;InvalidMethod&quot;</span>,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="stringliteral">&quot;Invallid dark brem simulation method &quot;</span> + std::to_string(<a class="code" href="classG4eDarkBremsstrahlungModel.html#a33e9d70ecff37406defc1ac75b055aa7">method_</a>) + <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                );</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    EAcc = EAcc*CLHEP::GeV; <span class="comment">//Change the energy back to MeV, the internal GEANT unit.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    G4double momentum = sqrt(EAcc*EAcc-electron_mass_c2*electron_mass_c2); <span class="comment">//Electron momentum in MeV.</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    G4ThreeVector newDirection;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordtype">double</span> ThetaAcc = std::asin(Pt/P);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    newDirection.set(std::sin(ThetaAcc)*std::cos(PhiAcc),std::sin(ThetaAcc)*std::sin(PhiAcc), std::cos(ThetaAcc));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    newDirection.rotateUz(primary-&gt;GetMomentumDirection());</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    newDirection.setMag(momentum);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// create g4dynamicparticle object for the dark photon.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    G4ThreeVector direction = (primary-&gt;GetMomentum()- newDirection);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    G4DynamicParticle* dphoton = <span class="keyword">new</span> G4DynamicParticle(<a class="code" href="classG4APrime.html#a44abfc4088b55222b87331a8bc34d6ae">G4APrime::APrime</a>(),direction);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    secondaries-&gt;push_back(dphoton);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// energy of primary</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    G4double finalKE = EAcc - electron_mass_c2;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// stop tracking and create new secondary instead of primary</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classG4eDarkBremsstrahlungModel.html#a8bc59ee5da2099a71a9149b1f2cd3e74">alwaysCreateNewElectron_</a> or finalKE &lt; SecondaryThreshold()) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">fParticleChange_</a>-&gt;ProposeTrackStatus(fStopAndKill);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">fParticleChange_</a>-&gt;SetProposedKineticEnergy(0.0);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        G4DynamicParticle* el = <span class="keyword">new</span> G4DynamicParticle(<span class="keyword">const_cast&lt;</span>G4ParticleDefinition*<span class="keyword">&gt;</span>(<a class="code" href="classG4eDarkBremsstrahlungModel.html#a1f6676019afd6dbd745048979d6d0b91">particle_</a>),</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                    newDirection.unit(), finalKE);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        secondaries-&gt;push_back(el);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">// continue tracking</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">// just have primary lose energy (don&#39;t rename to different track ID)</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">fParticleChange_</a>-&gt;SetProposedMomentumDirection(newDirection.unit());</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <a class="code" href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">fParticleChange_</a>-&gt;SetProposedKineticEnergy(finalKE);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;} </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00289">alwaysCreateNewElectron_</a>, <a class="el" href="G4APrime_8cxx_source.html#l00037">G4APrime::APrime()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00178">G4eDarkBremsstrahlungModel::OutgoingKinematics::centerMomentum</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00179">G4eDarkBremsstrahlungModel::OutgoingKinematics::E</a>, <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00268">fParticleChange_</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00373">GetMadgraphData()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00276">MA_</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00273">maxIterations_</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00279">Mel_</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00282">method_</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00265">particle_</a>.</p>

</div>
</div>
<a id="af013ac6d9a00269ad2667c7632177fbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af013ac6d9a00269ad2667c7632177fbc">&#9670;&nbsp;</a></span>SelectRandomAtom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const G4Element * G4eDarkBremsstrahlungModel::SelectRandomAtom </td>
          <td>(</td>
          <td class="paramtype">const G4MaterialCutsCouple *&#160;</td>
          <td class="paramname"><em>couple</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Selects random element out of the material information given.</p>
<p>Uses weights for materials calculated before and stored in partialSumSigma</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">couple</td><td>G4 package containing material and other relevant information </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the chosen G4Element </dd></dl>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00229">229</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                                                                                 {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// select randomly 1 element within the material</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">const</span> G4Material* material = couple-&gt;GetMaterial();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    G4int nElements = material-&gt;GetNumberOfElements();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keyword">const</span> G4ElementVector* theElementVector = material-&gt;GetElementVector();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keyword">const</span> G4Element* elm = 0;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span>(1 &lt; nElements) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        --nElements; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        G4DataVector* dv = partialSumSigma_.at(couple-&gt;GetIndex());</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        G4double rval = G4UniformRand()*((*dv)[nElements]);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        elm = (*theElementVector)[nElements];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">for</span> (G4int i=0; i&lt;nElements; ++i) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">if</span> (rval &lt;= (*dv)[i]) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                elm = (*theElementVector)[i];</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    } <span class="keywordflow">else</span> { </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        elm = (*theElementVector)[0]; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    SetCurrentElement(elm);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">return</span> elm;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac03b3e608eb59a1a8801a7e0fcc6cb1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac03b3e608eb59a1a8801a7e0fcc6cb1f">&#9670;&nbsp;</a></span>SetMadGraphDataFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void G4eDarkBremsstrahlungModel::SetMadGraphDataFile </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the data file for the dark brem events to be scaled. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>path to LHE file </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00196">196</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                                                   {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">//TODO do we need to read all LHE files in a directory? Can it just be one LHE file?</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">//Read all of the lhe files in the Resources/ directory. Assumes that they </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">//are of the correct mass, need to implement method of separating masses </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">//(either filenames, or skipping events with incorrect masses).</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">//    DIR *dir;</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">//    dir = opendir(&quot;Resources/&quot;); </span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">//    struct dirent *directory;</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">//    if(dir) {</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">//        while((directory = readdir(dir)) != NULL) {</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">//            std::string fname = &quot;Resources/&quot; + std::string(directory-&gt;d_name);</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">//            //Parse files that end in &quot;.lhe&quot;</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//            if(fname.substr(fname.find_last_of(&quot;.&quot;)+1) == &quot;lhe&quot;) {ParseLHE(fname);}   </span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">//        }</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span>( file.substr(file.find_last_of(<span class="stringliteral">&quot;.&quot;</span>)+1) == <span class="stringliteral">&quot;lhe&quot;</span> ) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">//is an lhe file</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        ParseLHE(file);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8">EXCEPTION_RAISE</a>(</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <span class="stringliteral">&quot;LHEFile&quot;</span>,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="stringliteral">&quot;The passed file path &#39;&quot;</span> + file</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                + <span class="stringliteral">&quot;&#39; does not end with &#39;lhe&#39;, so we are assuming it is not an LHE file.&quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                );</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#a8844dbde8fa44a5cd26eb5608af6d831">MakePlaceholders</a>(); <span class="comment">//Setup the placeholder offsets for getting data.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00364">MakePlaceholders()</a>.</p>

</div>
</div>
<a id="ad7adf731e39c0fe6f7a1e82f2d3645d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7adf731e39c0fe6f7a1e82f2d3645d6">&#9670;&nbsp;</a></span>SetMethod()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void G4eDarkBremsstrahlungModel::SetMethod </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2">DarkBremMethod</a>&#160;</td>
          <td class="paramname"><em>method</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the method for the dark brem simulation </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00191">191</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                                                 {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#a33e9d70ecff37406defc1ac75b055aa7">method_</a> = method;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00282">method_</a>.</p>

</div>
</div>
<a id="a39026424216039a82f476682f8cc8126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39026424216039a82f476682f8cc8126">&#9670;&nbsp;</a></span>SetParticle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void G4eDarkBremsstrahlungModel::SetParticle </td>
          <td>(</td>
          <td class="paramtype">const G4ParticleDefinition *&#160;</td>
          <td class="paramname"><em>p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sets the particle being looked at and checks whether it is an electron or not. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00291">291</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                                                          {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (p != G4Electron::Electron()) {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8">EXCEPTION_RAISE</a>(</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <span class="stringliteral">&quot;InvalidParticle&quot;</span>,</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="stringliteral">&quot;The particle passed to G4eDarkBremsstrahlungModel &#39;&quot;</span> </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                + p-&gt;GetParticleName() + <span class="stringliteral">&quot;&#39; is not an electron.&quot;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="classG4eDarkBremsstrahlungModel.html#a1f6676019afd6dbd745048979d6d0b91">particle_</a> = p;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Exception_8h_source.html#l00127">EXCEPTION_RAISE</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00265">particle_</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00036">G4eDarkBremsstrahlungModel()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00059">Initialise()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a8bc59ee5da2099a71a9149b1f2cd3e74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bc59ee5da2099a71a9149b1f2cd3e74">&#9670;&nbsp;</a></span>alwaysCreateNewElectron_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool G4eDarkBremsstrahlungModel::alwaysCreateNewElectron_ {true}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>should we always create a totally new electron when we dark brem?</p>
<p>TODO make this configurable? I (Tom E) can't think of a reason NOT to have it... </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00289">289</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">SampleSecondaries()</a>.</p>

</div>
</div>
<a id="aa99e94204e7d86b0043fcfcc12d7c051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa99e94204e7d86b0043fcfcc12d7c051">&#9670;&nbsp;</a></span>currentDataPoints_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; double , unsigned int &gt; G4eDarkBremsstrahlungModel::currentDataPoints_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Stores a map of current access points to mad graph data.</p>
<p>Maps incoming electron energy to the index of the data vector that we will get the data from.</p>
<p>Also sorts the incoming electron energy so that we can find the sampling energy that is closest above the actual incoming energy. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00307">307</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00373">GetMadgraphData()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00364">MakePlaceholders()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00050">~G4eDarkBremsstrahlungModel()</a>.</p>

</div>
</div>
<a id="aa5ed0705c9d8a047ae8136f856042f40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5ed0705c9d8a047ae8136f856042f40">&#9670;&nbsp;</a></span>fParticleChange_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">G4ParticleChangeForLoss* G4eDarkBremsstrahlungModel::fParticleChange_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>loss in particle energy </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00268">268</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00059">Initialise()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">SampleSecondaries()</a>.</p>

</div>
</div>
<a id="a7c4126a806f8678b215223d2ccdb9354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c4126a806f8678b215223d2ccdb9354">&#9670;&nbsp;</a></span>MA_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double G4eDarkBremsstrahlungModel::MA_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>mass of the A Prime [GeV] </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00276">276</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00400">ComputeCrossSectionPerAtom()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00036">G4eDarkBremsstrahlungModel()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">SampleSecondaries()</a>.</p>

</div>
</div>
<a id="a35c357850a78b284df86d35cd23df3f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35c357850a78b284df86d35cd23df3f3">&#9670;&nbsp;</a></span>madGraphData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt; double , std::vector &lt; <a class="el" href="structG4eDarkBremsstrahlungModel_1_1OutgoingKinematics.html">OutgoingKinematics</a> &gt; &gt; G4eDarkBremsstrahlungModel::madGraphData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Storage of data from mad graph</p>
<p>Maps incoming electron energy to various options for outgoing kinematics. </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00296">296</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00373">GetMadgraphData()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00364">MakePlaceholders()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00050">~G4eDarkBremsstrahlungModel()</a>.</p>

</div>
</div>
<a id="a8fb5279d5de92deab62969171c5823e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fb5279d5de92deab62969171c5823e4">&#9670;&nbsp;</a></span>maxIterations_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int G4eDarkBremsstrahlungModel::maxIterations_ {10000}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>maximum number of iterations to check before giving up on an event </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00273">273</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00364">MakePlaceholders()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">SampleSecondaries()</a>.</p>

</div>
</div>
<a id="a65f5ec091fbd1a185487fdb6191c9fde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65f5ec091fbd1a185487fdb6191c9fde">&#9670;&nbsp;</a></span>Mel_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double G4eDarkBremsstrahlungModel::Mel_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>mass of an electron [GeV] </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00279">279</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00400">ComputeCrossSectionPerAtom()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00036">G4eDarkBremsstrahlungModel()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">SampleSecondaries()</a>.</p>

</div>
</div>
<a id="a33e9d70ecff37406defc1ac75b055aa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33e9d70ecff37406defc1ac75b055aa7">&#9670;&nbsp;</a></span>method_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2">DarkBremMethod</a> G4eDarkBremsstrahlungModel::method_ {DarkBremMethod::Undefined}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>method for this model </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00282">282</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">SampleSecondaries()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00191">SetMethod()</a>.</p>

</div>
</div>
<a id="a1f6676019afd6dbd745048979d6d0b91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f6676019afd6dbd745048979d6d0b91">&#9670;&nbsp;</a></span>particle_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const G4ParticleDefinition* G4eDarkBremsstrahlungModel::particle_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>definition of particle </p>

<p class="definition">Definition at line <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html#l00265">265</a> of file <a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00471">ComputePartialSumSigma()</a>, <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00090">SampleSecondaries()</a>, and <a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00291">SetParticle()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>SimApplication/include/SimApplication/<a class="el" href="G4eDarkBremsstrahlungModel_8h_source.html">G4eDarkBremsstrahlungModel.h</a></li>
<li>SimApplication/src/<a class="el" href="G4eDarkBremsstrahlungModel_8cxx_source.html">G4eDarkBremsstrahlungModel.cxx</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aException_8h_html_a6d45ac49a0cb250fe3cabf8cf3fae7e8"><div class="ttname"><a href="Exception_8h.html#a6d45ac49a0cb250fe3cabf8cf3fae7e8">EXCEPTION_RAISE</a></div><div class="ttdeci">#define EXCEPTION_RAISE(EXCEPTION, MSG)</div><div class="ttdoc">Utility macro for throwing exceptions, automatically including the necessary file,...</div><div class="ttdef"><b>Definition:</b> <a href="Exception_8h_source.html#l00128">Exception.h:127</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a1f6676019afd6dbd745048979d6d0b91"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a1f6676019afd6dbd745048979d6d0b91">G4eDarkBremsstrahlungModel::particle_</a></div><div class="ttdeci">const G4ParticleDefinition * particle_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00265">G4eDarkBremsstrahlungModel.h:265</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a65f5ec091fbd1a185487fdb6191c9fde"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a65f5ec091fbd1a185487fdb6191c9fde">G4eDarkBremsstrahlungModel::Mel_</a></div><div class="ttdeci">double Mel_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00279">G4eDarkBremsstrahlungModel.h:279</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a7c4126a806f8678b215223d2ccdb9354"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a7c4126a806f8678b215223d2ccdb9354">G4eDarkBremsstrahlungModel::MA_</a></div><div class="ttdeci">double MA_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00276">G4eDarkBremsstrahlungModel.h:276</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a8844dbde8fa44a5cd26eb5608af6d831"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a8844dbde8fa44a5cd26eb5608af6d831">G4eDarkBremsstrahlungModel::MakePlaceholders</a></div><div class="ttdeci">void MakePlaceholders()</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00364">G4eDarkBremsstrahlungModel.cxx:364</a></div></div>
<div class="ttc" id="aclassG4APrime_html_a44abfc4088b55222b87331a8bc34d6ae"><div class="ttname"><a href="classG4APrime.html#a44abfc4088b55222b87331a8bc34d6ae">G4APrime::APrime</a></div><div class="ttdeci">static G4APrime * APrime(G4double theMass=10.0 *MeV)</div><div class="ttdef"><b>Definition:</b> <a href="G4APrime_8cxx_source.html#l00037">G4APrime.cxx:37</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a8bc59ee5da2099a71a9149b1f2cd3e74"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a8bc59ee5da2099a71a9149b1f2cd3e74">G4eDarkBremsstrahlungModel::alwaysCreateNewElectron_</a></div><div class="ttdeci">bool alwaysCreateNewElectron_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00289">G4eDarkBremsstrahlungModel.h:289</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_afd9431cde55e971717f4597be27d36d2a7b66a2198b4a37476f739f9474a8482a"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2a7b66a2198b4a37476f739f9474a8482a">G4eDarkBremsstrahlungModel::Undefined</a></div><div class="ttdeci">@ Undefined</div><div class="ttdoc">Boost LHE vertex momenta to the actual electron energy.</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00038">G4eDarkBremsstrahlungModel.h:37</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a35c357850a78b284df86d35cd23df3f3"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a35c357850a78b284df86d35cd23df3f3">G4eDarkBremsstrahlungModel::madGraphData_</a></div><div class="ttdeci">std::map&lt; double, std::vector&lt; OutgoingKinematics &gt; &gt; madGraphData_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00296">G4eDarkBremsstrahlungModel.h:296</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a33e9d70ecff37406defc1ac75b055aa7"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a33e9d70ecff37406defc1ac75b055aa7">G4eDarkBremsstrahlungModel::method_</a></div><div class="ttdeci">DarkBremMethod method_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00282">G4eDarkBremsstrahlungModel.h:282</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a09d4d7609a2d492e26051f76b9dd13aa"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a09d4d7609a2d492e26051f76b9dd13aa">G4eDarkBremsstrahlungModel::GetMadgraphData</a></div><div class="ttdeci">G4eDarkBremsstrahlungModel::OutgoingKinematics GetMadgraphData(double E0)</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00373">G4eDarkBremsstrahlungModel.cxx:373</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a39026424216039a82f476682f8cc8126"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a39026424216039a82f476682f8cc8126">G4eDarkBremsstrahlungModel::SetParticle</a></div><div class="ttdeci">void SetParticle(const G4ParticleDefinition *p)</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00291">G4eDarkBremsstrahlungModel.cxx:291</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_ae541628fa4dc2ae2ac029ed3abd28c68"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#ae541628fa4dc2ae2ac029ed3abd28c68">G4eDarkBremsstrahlungModel::StateType</a></div><div class="ttdeci">std::vector&lt; double &gt; StateType</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00106">G4eDarkBremsstrahlungModel.h:106</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_aa99e94204e7d86b0043fcfcc12d7c051"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#aa99e94204e7d86b0043fcfcc12d7c051">G4eDarkBremsstrahlungModel::currentDataPoints_</a></div><div class="ttdeci">std::map&lt; double, unsigned int &gt; currentDataPoints_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00307">G4eDarkBremsstrahlungModel.h:307</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_aa5ed0705c9d8a047ae8136f856042f40"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#aa5ed0705c9d8a047ae8136f856042f40">G4eDarkBremsstrahlungModel::fParticleChange_</a></div><div class="ttdeci">G4ParticleChangeForLoss * fParticleChange_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00268">G4eDarkBremsstrahlungModel.h:268</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_a8fb5279d5de92deab62969171c5823e4"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#a8fb5279d5de92deab62969171c5823e4">G4eDarkBremsstrahlungModel::maxIterations_</a></div><div class="ttdeci">unsigned int maxIterations_</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00273">G4eDarkBremsstrahlungModel.h:273</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_afd9431cde55e971717f4597be27d36d2a0d503551ee89e3153881e83c2b70647a"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#afd9431cde55e971717f4597be27d36d2a0d503551ee89e3153881e83c2b70647a">G4eDarkBremsstrahlungModel::CMScaling</a></div><div class="ttdeci">@ CMScaling</div><div class="ttdoc">Use actual electron energy and get pT from LHE (such that pT^2+me^2 &lt; Eacc^2)</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8h_source.html#l00036">G4eDarkBremsstrahlungModel.h:36</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_adf7d66717226c3c281748f2c4493cb6c"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#adf7d66717226c3c281748f2c4493cb6c">G4eDarkBremsstrahlungModel::ComputePartialSumSigma</a></div><div class="ttdeci">G4DataVector * ComputePartialSumSigma(const G4Material *material, G4double kineticEnergy, G4double cut)</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00471">G4eDarkBremsstrahlungModel.cxx:471</a></div></div>
<div class="ttc" id="aclassG4eDarkBremsstrahlungModel_html_aaf9523a77918dbecf88a82ff4b9ba8ff"><div class="ttname"><a href="classG4eDarkBremsstrahlungModel.html#aaf9523a77918dbecf88a82ff4b9ba8ff">G4eDarkBremsstrahlungModel::ComputeCrossSectionPerAtom</a></div><div class="ttdeci">virtual G4double ComputeCrossSectionPerAtom(const G4ParticleDefinition *, G4double E0, G4double Z, G4double A, G4double cut, G4double)</div><div class="ttdef"><b>Definition:</b> <a href="G4eDarkBremsstrahlungModel_8cxx_source.html#l00400">G4eDarkBremsstrahlungModel.cxx:400</a></div></div>
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>