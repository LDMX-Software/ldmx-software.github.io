<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.8.18"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: ldmx::HcalDigiProducer Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceldmx.html">ldmx</a></li><li class="navelem"><a class="el" href="classldmx_1_1HcalDigiProducer.html">HcalDigiProducer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classldmx_1_1HcalDigiProducer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ldmx::HcalDigiProducer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Performs digitization of simulated HCal data.  
 <a href="classldmx_1_1HcalDigiProducer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="HcalDigiProducer_8h_source.html">HcalDigiProducer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ad1da34c3f9d5192780151c65ab6276f7"><td class="memItemLeft" align="right" valign="top"><a id="ad1da34c3f9d5192780151c65ab6276f7"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>HcalDigiProducer</b> (const std::string &amp;name, <a class="el" href="classldmx_1_1Process.html">Process</a> &amp;process)</td></tr>
<tr class="separator:ad1da34c3f9d5192780151c65ab6276f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1aa323272060cbf43c10639ea050a34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HcalDigiProducer.html#ac1aa323272060cbf43c10639ea050a34">configure</a> (<a class="el" href="classldmx_1_1Parameters.html">Parameters</a> &amp;parameters) final override</td></tr>
<tr class="separator:ac1aa323272060cbf43c10639ea050a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33096e5559d8db1eaa2b7702afa54ce0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1HcalDigiProducer.html#a33096e5559d8db1eaa2b7702afa54ce0">produce</a> (<a class="el" href="classldmx_1_1Event.html">Event</a> &amp;event)</td></tr>
<tr class="separator:a33096e5559d8db1eaa2b7702afa54ce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ded41f6c812e1f2c0ac4fa1aac65a3"><td class="memItemLeft" align="right" valign="top"><a id="ac9ded41f6c812e1f2c0ac4fa1aac65a3"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>generateRandomID</b> (<a class="el" href="namespaceldmx.html#a95e1e089bedc0f533c12cde197768bd1">HcalSection</a> sec)</td></tr>
<tr class="separator:ac9ded41f6c812e1f2c0ac4fa1aac65a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae181e375b6493f502725105f7ce45735"><td class="memItemLeft" align="right" valign="top"><a id="ae181e375b6493f502725105f7ce45735"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>constructNoiseHit</b> (std::vector&lt; <a class="el" href="classldmx_1_1HcalHit.html">HcalHit</a> &gt; &amp;, <a class="el" href="namespaceldmx.html#a95e1e089bedc0f533c12cde197768bd1">HcalSection</a>, double, double, const std::map&lt; unsigned int, float &gt; &amp;, std::unordered_set&lt; unsigned int &gt; &amp;)</td></tr>
<tr class="separator:ae181e375b6493f502725105f7ce45735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classldmx_1_1Producer"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classldmx_1_1Producer')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classldmx_1_1Producer.html">ldmx::Producer</a></td></tr>
<tr class="memitem:abd1f979d49afb16c520ca66840d174cc inherit pub_methods_classldmx_1_1Producer"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1Producer.html#abd1f979d49afb16c520ca66840d174cc">Producer</a> (const std::string &amp;name, <a class="el" href="classldmx_1_1Process.html">Process</a> &amp;process)</td></tr>
<tr class="separator:abd1f979d49afb16c520ca66840d174cc inherit pub_methods_classldmx_1_1Producer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classldmx_1_1EventProcessor"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classldmx_1_1EventProcessor')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classldmx_1_1EventProcessor.html">ldmx::EventProcessor</a></td></tr>
<tr class="memitem:ab1d17dd7b596699bbcc7837b4b7ffa7a inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#ab1d17dd7b596699bbcc7837b4b7ffa7a">EventProcessor</a> (const std::string &amp;name, <a class="el" href="classldmx_1_1Process.html">Process</a> &amp;process)</td></tr>
<tr class="separator:ab1d17dd7b596699bbcc7837b4b7ffa7a inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab68e52016c598c53d2d9978bb244213a inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#ab68e52016c598c53d2d9978bb244213a">~EventProcessor</a> ()</td></tr>
<tr class="separator:ab68e52016c598c53d2d9978bb244213a inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668ae5d32705c4f65368bb3b25dcf13f inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#a668ae5d32705c4f65368bb3b25dcf13f">onNewRun</a> (const <a class="el" href="classldmx_1_1RunHeader.html">RunHeader</a> &amp;runHeader)</td></tr>
<tr class="separator:a668ae5d32705c4f65368bb3b25dcf13f inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b7388860e54cbce5bb95c6c6171881 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#a45b7388860e54cbce5bb95c6c6171881">onFileOpen</a> (<a class="el" href="classldmx_1_1EventFile.html">EventFile</a> &amp;eventFile)</td></tr>
<tr class="separator:a45b7388860e54cbce5bb95c6c6171881 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab54b6c2dd2b56b107942a04c5e10c620 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#ab54b6c2dd2b56b107942a04c5e10c620">onFileClose</a> (<a class="el" href="classldmx_1_1EventFile.html">EventFile</a> &amp;eventFile)</td></tr>
<tr class="separator:ab54b6c2dd2b56b107942a04c5e10c620 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9915215ea81db00eca7eacc35aac08e inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#ac9915215ea81db00eca7eacc35aac08e">onProcessStart</a> ()</td></tr>
<tr class="separator:ac9915215ea81db00eca7eacc35aac08e inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad217e06c4e1cb63ee2a8ee0a2c4f6fe4 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#ad217e06c4e1cb63ee2a8ee0a2c4f6fe4">onProcessEnd</a> ()</td></tr>
<tr class="separator:ad217e06c4e1cb63ee2a8ee0a2c4f6fe4 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa844f84a142be4a4ee74f575debc291d inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">TDirectory *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#aa844f84a142be4a4ee74f575debc291d">getHistoDirectory</a> ()</td></tr>
<tr class="separator:aa844f84a142be4a4ee74f575debc291d inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab38afea01d11e6c540b3646717ed33a5 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#ab38afea01d11e6c540b3646717ed33a5">setStorageHint</a> (ldmx::StorageControlHint hint)</td></tr>
<tr class="separator:ab38afea01d11e6c540b3646717ed33a5 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac235e777cff959f18bc120232d689f50 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#ac235e777cff959f18bc120232d689f50">setStorageHint</a> (ldmx::StorageControlHint hint, const std::string &amp;purposeString)</td></tr>
<tr class="separator:ac235e777cff959f18bc120232d689f50 inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4deffb5a280902e2cc54a0118ec7f29b inherit pub_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#a4deffb5a280902e2cc54a0118ec7f29b">createHistograms</a> (const std::vector&lt; <a class="el" href="classldmx_1_1Parameters.html">Parameters</a> &gt; &amp;histos)</td></tr>
<tr class="separator:a4deffb5a280902e2cc54a0118ec7f29b inherit pub_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a95ab1bc46a44d1987a1286d3ab58f9bf"><td class="memItemLeft" align="right" valign="top"><a id="a95ab1bc46a44d1987a1286d3ab58f9bf"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>verbose_</b> {false}</td></tr>
<tr class="separator:a95ab1bc46a44d1987a1286d3ab58f9bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23ff687e6aa0873db306589c41232fbf"><td class="memItemLeft" align="right" valign="top"><a id="a23ff687e6aa0873db306589c41232fbf"></a>
std::unique_ptr&lt; TRandom3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>random_</b></td></tr>
<tr class="separator:a23ff687e6aa0873db306589c41232fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a308ffd903b9b9047342228e97af60f6e"><td class="memItemLeft" align="right" valign="top"><a id="a308ffd903b9b9047342228e97af60f6e"></a>
<a class="el" href="classldmx_1_1HcalID.html">HcalID</a>&#160;</td><td class="memItemRight" valign="bottom"><b>detID_</b></td></tr>
<tr class="separator:a308ffd903b9b9047342228e97af60f6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1981115651b62e12a453101b3385fadb"><td class="memItemLeft" align="right" valign="top"><a id="a1981115651b62e12a453101b3385fadb"></a>
std::unique_ptr&lt; <a class="el" href="classldmx_1_1NoiseGenerator.html">NoiseGenerator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>noiseGenerator_</b></td></tr>
<tr class="separator:a1981115651b62e12a453101b3385fadb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963e8bbcbc68f24a07823121e0fe3ce5"><td class="memItemLeft" align="right" valign="top"><a id="a963e8bbcbc68f24a07823121e0fe3ce5"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>meanNoise_</b> {0}</td></tr>
<tr class="separator:a963e8bbcbc68f24a07823121e0fe3ce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99474af9ba3bacc6069a65a09629c89e"><td class="memItemLeft" align="right" valign="top"><a id="a99474af9ba3bacc6069a65a09629c89e"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>nProcessed_</b> {0}</td></tr>
<tr class="separator:a99474af9ba3bacc6069a65a09629c89e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20cc971ce9abc41dc2f55a43f5deb13"><td class="memItemLeft" align="right" valign="top"><a id="af20cc971ce9abc41dc2f55a43f5deb13"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>mev_per_mip_</b> {1.40}</td></tr>
<tr class="separator:af20cc971ce9abc41dc2f55a43f5deb13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a4caf83fa3a7e8a8f821a82a9299ae1"><td class="memItemLeft" align="right" valign="top"><a id="a3a4caf83fa3a7e8a8f821a82a9299ae1"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>pe_per_mip_</b> {13.5}</td></tr>
<tr class="separator:a3a4caf83fa3a7e8a8f821a82a9299ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebfc90c71ef82eb386a7aef9f05a505a"><td class="memItemLeft" align="right" valign="top"><a id="aebfc90c71ef82eb386a7aef9f05a505a"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>strip_attenuation_length_</b> {100.}</td></tr>
<tr class="separator:aebfc90c71ef82eb386a7aef9f05a505a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab590dbe4b6bf7be03efcd12a1876340e"><td class="memItemLeft" align="right" valign="top"><a id="ab590dbe4b6bf7be03efcd12a1876340e"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><b>strip_position_resolution_</b> {150.}</td></tr>
<tr class="separator:ab590dbe4b6bf7be03efcd12a1876340e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5b5f6fd3813d20355885ba962cc79fc"><td class="memItemLeft" align="right" valign="top"><a id="ae5b5f6fd3813d20355885ba962cc79fc"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>sim_hit_pass_name_</b></td></tr>
<tr class="separator:ae5b5f6fd3813d20355885ba962cc79fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7a64d20cd7fc3085194cbc4abe59a41"><td class="memItemLeft" align="right" valign="top"><a id="ad7a64d20cd7fc3085194cbc4abe59a41"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>readoutThreshold_</b> {2}</td></tr>
<tr class="separator:ad7a64d20cd7fc3085194cbc4abe59a41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae005ab84d8b6d328b430264b5abfc7b7"><td class="memItemLeft" align="right" valign="top"><a id="ae005ab84d8b6d328b430264b5abfc7b7"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>STRIPS_BACK_PER_LAYER_</b> {60}</td></tr>
<tr class="separator:ae005ab84d8b6d328b430264b5abfc7b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f990c29bb66e6bcb889064af59159c4"><td class="memItemLeft" align="right" valign="top"><a id="a1f990c29bb66e6bcb889064af59159c4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_BACK_HCAL_LAYERS_</b> {150}</td></tr>
<tr class="separator:a1f990c29bb66e6bcb889064af59159c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff50dc40577c33f1bc31282fc043e8e2"><td class="memItemLeft" align="right" valign="top"><a id="aff50dc40577c33f1bc31282fc043e8e2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>STRIPS_SIDE_TB_PER_LAYER_</b> {6}</td></tr>
<tr class="separator:aff50dc40577c33f1bc31282fc043e8e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72ab49d9cc107012fccc1a655db07e13"><td class="memItemLeft" align="right" valign="top"><a id="a72ab49d9cc107012fccc1a655db07e13"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_SIDE_TB_HCAL_LAYERS_</b> {31}</td></tr>
<tr class="separator:a72ab49d9cc107012fccc1a655db07e13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acad8ccc5066ab83909a7ff4ea565c059"><td class="memItemLeft" align="right" valign="top"><a id="acad8ccc5066ab83909a7ff4ea565c059"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>STRIPS_SIDE_LR_PER_LAYER_</b> {31}</td></tr>
<tr class="separator:acad8ccc5066ab83909a7ff4ea565c059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ebf99bf22e15983a2c112f164dde1ff"><td class="memItemLeft" align="right" valign="top"><a id="a2ebf99bf22e15983a2c112f164dde1ff"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>NUM_SIDE_LR_HCAL_LAYERS_</b> {63}</td></tr>
<tr class="separator:a2ebf99bf22e15983a2c112f164dde1ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede20db460c0bc74421535410b14179b"><td class="memItemLeft" align="right" valign="top"><a id="aede20db460c0bc74421535410b14179b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>SUPER_STRIP_SIZE_</b> {1}</td></tr>
<tr class="separator:aede20db460c0bc74421535410b14179b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_classldmx_1_1EventProcessor"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_classldmx_1_1EventProcessor')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="classldmx_1_1EventProcessor.html">ldmx::EventProcessor</a></td></tr>
<tr class="memitem:a13b557e0dd7b52cee597ce4f16bfea1c inherit pub_static_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#a13b557e0dd7b52cee597ce4f16bfea1c">declare</a> (const std::string &amp;classname, int classtype, <a class="el" href="namespaceldmx.html#a5ac5f202d9290421144c78b7414c0080">EventProcessorMaker</a> *)</td></tr>
<tr class="separator:a13b557e0dd7b52cee597ce4f16bfea1c inherit pub_static_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_static_attribs_classldmx_1_1Producer"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classldmx_1_1Producer')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el" href="classldmx_1_1Producer.html">ldmx::Producer</a></td></tr>
<tr class="memitem:a23ad69b267e4f827ba0a3de32887bd44 inherit pub_static_attribs_classldmx_1_1Producer"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1Producer.html#a23ad69b267e4f827ba0a3de32887bd44">CLASSTYPE</a> {1}</td></tr>
<tr class="separator:a23ad69b267e4f827ba0a3de32887bd44 inherit pub_static_attribs_classldmx_1_1Producer"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classldmx_1_1EventProcessor"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classldmx_1_1EventProcessor')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classldmx_1_1EventProcessor.html">ldmx::EventProcessor</a></td></tr>
<tr class="memitem:afffb4b8c898001d952408798676d5635 inherit pro_methods_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#afffb4b8c898001d952408798676d5635">abortEvent</a> ()</td></tr>
<tr class="separator:afffb4b8c898001d952408798676d5635 inherit pro_methods_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classldmx_1_1EventProcessor"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classldmx_1_1EventProcessor')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classldmx_1_1EventProcessor.html">ldmx::EventProcessor</a></td></tr>
<tr class="memitem:ae4d5efe10b50e887f4e71a8c00b0eac0 inherit pro_attribs_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classldmx_1_1Process.html">Process</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#ae4d5efe10b50e887f4e71a8c00b0eac0">process_</a></td></tr>
<tr class="separator:ae4d5efe10b50e887f4e71a8c00b0eac0 inherit pro_attribs_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9caad392817bb9e2ca9c9f28a544de2f inherit pro_attribs_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top"><a id="a9caad392817bb9e2ca9c9f28a544de2f"></a>
<a class="el" href="classldmx_1_1HistogramHelper.html">HistogramHelper</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#a9caad392817bb9e2ca9c9f28a544de2f">histograms_</a></td></tr>
<tr class="memdesc:a9caad392817bb9e2ca9c9f28a544de2f inherit pro_attribs_classldmx_1_1EventProcessor"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface class for making and filling histograms. <br /></td></tr>
<tr class="separator:a9caad392817bb9e2ca9c9f28a544de2f inherit pro_attribs_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2a1ee9a8ceeed570810cfe402d5195 inherit pro_attribs_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top"><a id="aba2a1ee9a8ceeed570810cfe402d5195"></a>
<a class="el" href="classldmx_1_1NtupleManager.html">NtupleManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#aba2a1ee9a8ceeed570810cfe402d5195">ntuple_</a> {<a class="el" href="classldmx_1_1NtupleManager.html#a52f11cc97f4fd6889e2f7138c96ac0ac">NtupleManager::getInstance</a>()}</td></tr>
<tr class="memdesc:aba2a1ee9a8ceeed570810cfe402d5195 inherit pro_attribs_classldmx_1_1EventProcessor"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manager for any ntuples. <br /></td></tr>
<tr class="separator:aba2a1ee9a8ceeed570810cfe402d5195 inherit pro_attribs_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9685619198fab6900155a29101be7e42 inherit pro_attribs_classldmx_1_1EventProcessor"><td class="memItemLeft" align="right" valign="top"><a id="a9685619198fab6900155a29101be7e42"></a>
logging::logger&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classldmx_1_1EventProcessor.html#a9685619198fab6900155a29101be7e42">theLog_</a></td></tr>
<tr class="memdesc:a9685619198fab6900155a29101be7e42 inherit pro_attribs_classldmx_1_1EventProcessor"><td class="mdescLeft">&#160;</td><td class="mdescRight">The logger for this <a class="el" href="classldmx_1_1EventProcessor.html" title="Base class for all event processing components.">EventProcessor</a>. <br /></td></tr>
<tr class="separator:a9685619198fab6900155a29101be7e42 inherit pro_attribs_classldmx_1_1EventProcessor"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Performs digitization of simulated HCal data. </p>

<p class="definition">Definition at line <a class="el" href="HcalDigiProducer_8h_source.html#l00031">31</a> of file <a class="el" href="HcalDigiProducer_8h_source.html">HcalDigiProducer.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ac1aa323272060cbf43c10639ea050a34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1aa323272060cbf43c10639ea050a34">&#9670;&nbsp;</a></span>configure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::HcalDigiProducer::configure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1Parameters.html">Parameters</a> &amp;&#160;</td>
          <td class="paramname"><em>parameters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Configure the processor using the given user specified parameters.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parameters</td><td>Set of parameters used to configure this processor. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="classldmx_1_1EventProcessor.html#a9482dccbb5ce7bc2efe0537c679c0ec0">ldmx::EventProcessor</a>.</p>

<p class="definition">Definition at line <a class="el" href="HcalDigiProducer_8cxx_source.html#l00018">18</a> of file <a class="el" href="HcalDigiProducer_8cxx_source.html">HcalDigiProducer.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                                           {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;        random_                    = std::make_unique&lt;TRandom3&gt;(parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;randomSeed&quot;</span>));</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;        STRIPS_BACK_PER_LAYER_     = parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;strips_back_per_layer&quot;</span>);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        NUM_BACK_HCAL_LAYERS_      = parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;num_back_hcal_layers&quot;</span>);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;        STRIPS_SIDE_TB_PER_LAYER_  = parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;strips_side_tb_per_layer&quot;</span>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        NUM_SIDE_TB_HCAL_LAYERS_   = parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;num_side_tb_hcal_layers&quot;</span>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;        STRIPS_SIDE_LR_PER_LAYER_  = parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;strips_side_lr_per_layer&quot;</span>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        NUM_SIDE_LR_HCAL_LAYERS_   = parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;num_side_lr_hcal_layers&quot;</span>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        SUPER_STRIP_SIZE_          = parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;super_strip_size&quot;</span>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        readoutThreshold_          = parameters.getParameter&lt; <span class="keywordtype">int</span> &gt;(<span class="stringliteral">&quot;readoutThreshold&quot;</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        meanNoise_                 = parameters.getParameter&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;meanNoise&quot;</span>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        mev_per_mip_               = parameters.getParameter&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;mev_per_mip&quot;</span>);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        pe_per_mip_                = parameters.getParameter&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;pe_per_mip&quot;</span>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        strip_attenuation_length_  = parameters.getParameter&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;strip_attenuation_length&quot;</span>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        strip_position_resolution_ = parameters.getParameter&lt; <span class="keywordtype">double</span> &gt;(<span class="stringliteral">&quot;strip_position_resolution&quot;</span>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        sim_hit_pass_name_         = parameters.getParameter&lt; std::string &gt;(<span class="stringliteral">&quot;sim_hit_pass_name&quot;</span>);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        noiseGenerator_ = std::make_unique&lt;NoiseGenerator&gt;(meanNoise_,<span class="keyword">false</span>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        noiseGenerator_-&gt;setNoiseThreshold(1); <span class="comment">// hard-code this number, create noise hits for non-zero PEs! </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="Parameters_8h_source.html#l00060">ldmx::Parameters::getParameter()</a>.</p>

</div>
</div>
<a id="a33096e5559d8db1eaa2b7702afa54ce0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33096e5559d8db1eaa2b7702afa54ce0">&#9670;&nbsp;</a></span>produce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ldmx::HcalDigiProducer::produce </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classldmx_1_1Event.html">Event</a> &amp;&#160;</td>
          <td class="paramname"><em>event</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="classldmx_1_1Process.html" title="Class which represents the process under execution.">Process</a> the event and put new data products into it. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>The <a class="el" href="classldmx_1_1Event.html" title="Implements an event buffer system for storing event data.">Event</a> to process. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classldmx_1_1Producer.html#a7ac942786d11a4768ad430d52ba6a427">ldmx::Producer</a>.</p>

<p class="definition">Definition at line <a class="el" href="HcalDigiProducer_8cxx_source.html#l00086">86</a> of file <a class="el" href="HcalDigiProducer_8cxx_source.html">HcalDigiProducer.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        std::map&lt;unsigned int, int&gt;   hcalLayerPEs;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        std::map&lt;unsigned int, int&gt;   hcalLayerMinPEs;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        std::map&lt;unsigned int, float&gt; hcalXpos,hcalYpos,hcalZpos,hcaldetIDEdep, hcaldetIDTime;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        std::unordered_set&lt;unsigned int&gt; noiseHitIDs;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordtype">int</span> numSigHits_back=0,numSigHits_side_tb=0,numSigHits_side_lr=0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordtype">float</span> side_hcal_z0(215.0f);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keywordtype">float</span> strip_width(50.0f);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordtype">float</span> super_strip_width  = SUPER_STRIP_SIZE_*strip_width;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordtype">float</span> total_super_strips = STRIPS_BACK_PER_LAYER_/SUPER_STRIP_SIZE_; <span class="comment">// to help the integer round up</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordtype">float</span> half_total_width   = STRIPS_BACK_PER_LAYER_*strip_width/2.0f;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// first check if the super strip size divides nicely into the total number of strips</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (STRIPS_BACK_PER_LAYER_ % SUPER_STRIP_SIZE_ != 0){</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            EXCEPTION_RAISE( <span class="stringliteral">&quot;InvalidArg&quot;</span> , </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    <span class="stringliteral">&quot;The specified superstrip size is not compatible with the total number of strips! (Number of strips is not divisible by super strip size)&quot;</span> );</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">// looper over sim hits and aggregate energy depositions for each detID</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keyword">auto</span> hcalHits{<span class="keyword">event</span>.getCollection&lt;SimCalorimeterHit&gt;(EventConstants::HCAL_SIM_HITS,sim_hit_pass_name_)};</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> SimCalorimeterHit &amp;simHit : hcalHits ) {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keywordtype">int</span> detIDraw = simHit.getID();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            detID_.<a class="code" href="classldmx_1_1DetectorID.html#a0ab7435051b257d4974ce87c0a1772cd">setRawValue</a>(detIDraw);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            detID_.<a class="code" href="classldmx_1_1DetectorID.html#aed9bd3abdb7038a7a43ca4d9eed91b85">unpack</a>();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            <span class="keywordtype">int</span> layer = detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;layer&quot;</span>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keywordtype">int</span> subsection = detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;section&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            <span class="keywordtype">int</span> strip = detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;strip&quot;</span>);                 </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            std::vector&lt;float&gt; position = simHit.getPosition();       </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keywordflow">if</span> (verbose_) {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;section: &quot;</span> &lt;&lt; detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;section&quot;</span>) </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;  layer: &quot;</span> &lt;&lt; detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;layer&quot;</span>) </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    &lt;&lt;  <span class="stringliteral">&quot;  strip: &quot;</span> &lt;&lt; detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;strip&quot;</span>) &lt;&lt;std::endl;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            }        </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="comment">// re-assign the strip number based on super strip size -- ONLY FOR Back Hcal</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keywordflow">if</span> (SUPER_STRIP_SIZE_ != 1 &amp;&amp; subsection == 0){</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordtype">int</span> newstrip = strip/SUPER_STRIP_SIZE_;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                detID_.<a class="code" href="classldmx_1_1DetectorID.html#a85f7b28fce48a9f692fc5dc1723c2cad">setFieldValue</a>(<span class="stringliteral">&quot;strip&quot;</span>,newstrip);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                detID_.<a class="code" href="classldmx_1_1DetectorID.html#abb59fb4b7024033aac9a36512b1f78e6">pack</a>();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                detIDraw = detID_.<a class="code" href="classldmx_1_1DetectorID.html#af0545d6fc148cdb35bbb6228f545ead3">getRawValue</a>();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="comment">// for now, we take an energy weighted average of the hit in each stip to simulate the hit position. </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="comment">// will use strip TOF and light yield between strips to estimate position.            </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> (hcaldetIDEdep.find(detIDraw) == hcaldetIDEdep.end()){</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="comment">// first hit, initialize</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                hcaldetIDEdep[detIDraw] = simHit.getEdep();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                hcaldetIDTime[detIDraw] = simHit.getTime() * simHit.getEdep();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                hcalXpos[detIDraw]      = position[0]* simHit.getEdep();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                hcalYpos[detIDraw]      = position[1]* simHit.getEdep();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                hcalZpos[detIDraw]      = position[2]* simHit.getEdep();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                <span class="comment">// not first hit, aggregate, and store the largest radius hit</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                hcalXpos[detIDraw]      += position[0]* simHit.getEdep();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                hcalYpos[detIDraw]      += position[1]* simHit.getEdep();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                hcalZpos[detIDraw]      += position[2]* simHit.getEdep();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                hcaldetIDEdep[detIDraw] += simHit.getEdep();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                hcaldetIDTime[detIDraw] += simHit.getTime() * simHit.getEdep();</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="comment">// loop over detIDs and simulate number of PEs</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        std::vector&lt;HcalHit&gt; hcalRecHits;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">for</span> (std::map&lt;unsigned int, float&gt;::iterator it = hcaldetIDEdep.begin(); it != hcaldetIDEdep.end(); ++it) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="keywordtype">int</span> detIDraw = it-&gt;first;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordtype">double</span> depEnergy = hcaldetIDEdep[detIDraw];</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            hcaldetIDTime[detIDraw] = hcaldetIDTime[detIDraw] / hcaldetIDEdep[detIDraw];</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            hcalXpos[detIDraw]      = hcalXpos[detIDraw] / hcaldetIDEdep[detIDraw];</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            hcalYpos[detIDraw]      = hcalYpos[detIDraw] / hcaldetIDEdep[detIDraw];</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            hcalZpos[detIDraw]      = hcalZpos[detIDraw] / hcaldetIDEdep[detIDraw];</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordtype">double</span> meanPE           = depEnergy / mev_per_mip_ * pe_per_mip_;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            HcalID curDetId;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            curDetId.setRawValue(detIDraw);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            curDetId.unpack();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordtype">int</span> cur_subsection = curDetId.getFieldValue(<span class="stringliteral">&quot;section&quot;</span>);            </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordtype">int</span> cur_layer      = curDetId.getFieldValue(<span class="stringliteral">&quot;layer&quot;</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordtype">int</span> cur_strip      = curDetId.getFieldValue(<span class="stringliteral">&quot;strip&quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">if</span> (curDetId.getSection() == HcalSection::BACK)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                numSigHits_back++;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (curDetId.getSection() == HcalSection::TOP  || curDetId.getSection() == HcalSection::BOTTOM)</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                numSigHits_side_tb++;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (curDetId.getSection() == HcalSection::LEFT || curDetId.getSection() == HcalSection::RIGHT)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                numSigHits_side_lr++;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordflow">else</span> std::cout &lt;&lt; <span class="stringliteral">&quot;WARNING [HcalDigiProducer::produce]: HcalSection is not known&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">// need to add in a weighting factor eventually, so keep it that way to make sure we don&#39;t forget about it</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordtype">double</span> energy = depEnergy; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">// quantize/smear the position            </span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordtype">float</span> cur_xpos(hcalXpos[detIDraw]),cur_ypos(hcalYpos[detIDraw]),cur_zpos(hcalZpos[detIDraw]); </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="comment">// for back HCal, get PEs with attentuation</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordflow">if</span> (cur_subsection == 0) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <span class="keywordtype">float</span> distance_along_bar = (cur_layer % 2) ? fabs(cur_xpos) : fabs(cur_ypos);                </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;              </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="comment">// increase the PE count to the case with no attentuation (assuming 80% attenuation on the pe_per_mip number @ 1m)</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                meanPE *= exp(1./strip_attenuation_length_); </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keywordtype">float</span> meanPE_close = meanPE * exp( -1. * ((half_total_width - distance_along_bar) / 1000.) / strip_attenuation_length_ );</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordtype">float</span> meanPE_far   = meanPE * exp( -1. * ((half_total_width + distance_along_bar) / 1000.) / strip_attenuation_length_ );</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="keywordtype">float</span> PE_close     = random_-&gt;Poisson(meanPE_close+meanNoise_);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="keywordtype">float</span> PE_far       = random_-&gt;Poisson(meanPE_far+meanNoise_);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                hcalLayerPEs[detIDraw] = PE_close + PE_far;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                hcalLayerMinPEs[detIDraw] = std::min(PE_close,PE_far);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordflow">if</span> (cur_layer % 2 == 0){ <span class="comment">// even layers, vertical</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    cur_xpos = (super_strip_width * (float(cur_strip)+0.5)) - half_total_width; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    cur_ypos = hcalYpos[detIDraw] + random_-&gt;Gaus(0.,strip_position_resolution_); </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <span class="keywordflow">if</span> (cur_layer % 2 == 1){ <span class="comment">// odd layers, horizontal</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    cur_ypos = (super_strip_width * (float(cur_strip)+0.5)) - half_total_width; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    cur_xpos = hcalXpos[detIDraw] + random_-&gt;Gaus(0.,strip_position_resolution_); </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                }                </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                cur_xpos = std::max(std::min(cur_xpos,half_total_width),-half_total_width);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                cur_ypos = std::max(std::min(cur_ypos,half_total_width),-half_total_width);                </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                <span class="comment">//This would be the quantized z position. </span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="comment">//The back_hcal_z0 and back_hcal_layer_thickness values must be derived fromn the geometry!</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="comment">//float back_hcal_z0(552);</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="comment">//float back_hcal_layer_thickness(44.0);</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="comment">//cur_zpos = back_hcal_z0+(cur_layer-1)*back_hcal_layer_thickness;                            </span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            }            </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="comment">// for sidecal don&#39;t worry about attenuation because it&#39;s single readout</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                hcalLayerPEs[detIDraw]    = int(meanPE+meanNoise_); <span class="comment">//random_-&gt;Poisson(meanPE+meanNoise_);</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                hcalLayerMinPEs[detIDraw] = hcalLayerPEs[detIDraw];            </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">// It looks like LEFT / RIGHT are inverted ?!? LEFT should be + and RIGHT -</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">// The gdml file is wrong, left and right are indeed inverted (x,y coodrinates should be reversed). </span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">// need to fic gdml and this part </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="comment">//Note the side Hcal doesn&#39;t have super strips</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="comment">//This is the quantized position along the length of the bar - LEFT/RIGHT is for fixed HCAL geometry</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="comment">// float ecal_width_(525);</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="comment">//if (cur_subsection == HcalSection::TOP)    cur_xpos =  half_total_width/2.0 - ecal_width/4.0;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="comment">//if (cur_subsection == HcalSection::BOTTOM) cur_xpos = -half_total_width/2.0 + ecal_width/4.0;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="comment">//if (cur_subsection == HcalSection::LEFT)   cur_ypos =  half_total_width/2.0 - ecal_width/4.0;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="comment">//if (cur_subsection == HcalSection::RIGHT)  cur_ypos = -half_total_width/2.0 + ecal_width/4.0;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="comment">//This would be the quantized z position. The side_hcal_z0 value must be derived fromn the geometry!</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                <span class="comment">//float side_hcal_z0(215.5);</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="comment">//cur_zpos = side_hcal_z0+(cur_strip+0.5)*strip_width ;                        </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="comment">//This is the quantized position along the thickness of the bar - check RIGHT / LEFT</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="comment">//float back_hcal_layer_thickness(39);</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="comment">//float side_hcal_xy_offset(294);</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <span class="comment">//if (cur_subsection == HcalSection::TOP)    cur_ypos =  side_hcal_xy_offset+(cur_layer-1)*back_hcal_layer_thickness;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                <span class="comment">//if (cur_subsection == HcalSection::BOTTOM) cur_ypos = -side_hcal_xy_offset-(cur_layer-1)*back_hcal_layer_thickness;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="comment">//if (cur_subsection == HcalSection::LEFT)   cur_xpos = -side_hcal_xy_offset-(cur_layer-1)*back_hcal_layer_thickness;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="comment">//if (cur_subsection == HcalSection::RIGHT)  cur_xpos =  side_hcal_xy_offset+(cur_layer-1)*back_hcal_layer_thickness;               </span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            }            </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">if</span> (hcalLayerPEs[detIDraw] &gt;= readoutThreshold_ ) {                </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                HcalHit hit;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                hit.setID(detIDraw);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                hit.setPE(hcalLayerPEs[detIDraw]);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                hit.setMinPE(hcalLayerMinPEs[detIDraw]);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                hit.setAmplitude(hcalLayerPEs[detIDraw]);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                hit.setEnergy(energy);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                hit.setTime(hcaldetIDTime[detIDraw]);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                hit.setXpos(cur_xpos); <span class="comment">// quantized and smeared positions</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                hit.setYpos(cur_ypos); <span class="comment">// quantized and smeared positions</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                hit.setZpos(cur_zpos);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                hit.setNoise(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                hcalRecHits.push_back( hit );</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">if</span> (verbose_) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                detID_.<a class="code" href="classldmx_1_1DetectorID.html#a0ab7435051b257d4974ce87c0a1772cd">setRawValue</a>(detIDraw);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                detID_.<a class="code" href="classldmx_1_1DetectorID.html#aed9bd3abdb7038a7a43ca4d9eed91b85">unpack</a>();</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <span class="keywordtype">int</span> layer      = detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;layer&quot;</span>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordtype">int</span> subsection = detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;section&quot;</span>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordtype">int</span> strip      = detID_.<a class="code" href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">getFieldValue</a>(<span class="stringliteral">&quot;strip&quot;</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;detID     : &quot;</span> &lt;&lt; detIDraw &lt;&lt; std::endl;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Layer     : &quot;</span> &lt;&lt; layer &lt;&lt; std::endl;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Subsection: &quot;</span> &lt;&lt; subsection &lt;&lt; std::endl;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Strip: &quot;</span> &lt;&lt; strip &lt;&lt; std::endl;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Edep: &quot;</span> &lt;&lt; hcaldetIDEdep[detIDraw] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;numPEs: &quot;</span> &lt;&lt; hcalLayerPEs[detIDraw] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;time: &quot;</span> &lt;&lt; hcaldetIDTime[detIDraw] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;z: &quot;</span> &lt;&lt; hcalZpos[detIDraw] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;Layer: &quot;</span> &lt;&lt; layer </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\t Strip: &quot;</span> &lt;&lt; strip </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\t X: &quot;</span> &lt;&lt; hcalXpos[detIDraw] </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\t Y: &quot;</span> &lt;&lt; hcalYpos[detIDraw] </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;\t Z: &quot;</span> &lt;&lt; hcalZpos[detIDraw] &lt;&lt; std::endl;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            }<span class="comment">// end verbose            </span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        } <span class="comment">//end loop over map of values</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="comment">// ------------------------------- Noise simulation -------------------------------</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="comment">// simulate noise hits in back hcal</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordtype">int</span> total_super_strips_back      = STRIPS_BACK_PER_LAYER_/SUPER_STRIP_SIZE_;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordtype">int</span> total_empty_channels         = 2*(total_super_strips_back*NUM_BACK_HCAL_LAYERS_-numSigHits_back);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        std::vector&lt;double&gt; noiseHits_PE = noiseGenerator_-&gt;generateNoiseHits( total_empty_channels ); <span class="comment">// 2-sided readout</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordtype">int</span> total_zero_channels          = total_empty_channels - noiseHits_PE.size();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        std::vector&lt;double&gt; zeroNoiseHits_PE(total_zero_channels, 0.0);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        noiseHits_PE.insert( noiseHits_PE.end(), zeroNoiseHits_PE.begin(), zeroNoiseHits_PE.end() );</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        std::random_shuffle ( noiseHits_PE.begin(), noiseHits_PE.end() );</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordtype">int</span> ctr_back_noise = 0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; noiseHits_PE.size()/2 ; ++i) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordtype">double</span> cur_noise_pe_1 = noiseHits_PE[i*2];</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordtype">double</span> cur_noise_pe_2 = noiseHits_PE[i*2+1];</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            <span class="keywordtype">double</span> total_noise    = cur_noise_pe_1 + cur_noise_pe_2;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">if</span> (total_noise &lt; readoutThreshold_) <span class="keywordflow">continue</span>; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordtype">double</span> min_noise = std::min(cur_noise_pe_1,cur_noise_pe_2);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            constructNoiseHit(hcalRecHits,HcalSection::BACK,total_noise,min_noise,hcaldetIDEdep,noiseHitIDs);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            ctr_back_noise++;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span> (verbose_) std::cout &lt;&lt; <span class="stringliteral">&quot;numSigHits_back = &quot;</span> &lt;&lt; numSigHits_back &lt;&lt; <span class="stringliteral">&quot;, ctr_back_noise = &quot;</span> &lt;&lt; ctr_back_noise &lt;&lt; std::endl;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">// simulate noise hits in side, top / bottom hcal</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        noiseHits_PE = noiseGenerator_-&gt;generateNoiseHits((STRIPS_SIDE_TB_PER_LAYER_*NUM_SIDE_TB_HCAL_LAYERS_)*2-numSigHits_side_tb);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> noise : noiseHits_PE ) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            constructNoiseHit(hcalRecHits,HcalSection::TOP,noise,noise,hcaldetIDEdep,noiseHitIDs);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            constructNoiseHit(hcalRecHits,HcalSection::BOTTOM,noise,noise,hcaldetIDEdep,noiseHitIDs);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// simulate noise hits in side, left / right hcal</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        noiseHits_PE = noiseGenerator_-&gt;generateNoiseHits((STRIPS_SIDE_LR_PER_LAYER_*NUM_SIDE_LR_HCAL_LAYERS_)*2-numSigHits_side_lr);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> noise : noiseHits_PE ) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            constructNoiseHit(hcalRecHits,HcalSection::LEFT,noise,noise,hcaldetIDEdep,noiseHitIDs);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            constructNoiseHit(hcalRecHits,HcalSection::RIGHT,noise,noise,hcaldetIDEdep,noiseHitIDs);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keyword">event</span>.add( <span class="stringliteral">&quot;HcalRecHits&quot;</span>, hcalRecHits );</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="DetectorID_8cxx_source.html#l00051">ldmx::DetectorID::getFieldValue()</a>, <a class="el" href="SimCalorimeterHit_8h_source.html#l00090">ldmx::SimCalorimeterHit::getID()</a>, <a class="el" href="DetectorID_8cxx_source.html#l00021">ldmx::DetectorID::getRawValue()</a>, <a class="el" href="HcalID_8h_source.html#l00044">ldmx::HcalID::getSection()</a>, <a class="el" href="DetectorID_8cxx_source.html#l00040">ldmx::DetectorID::pack()</a>, <a class="el" href="DetectorID_8cxx_source.html#l00057">ldmx::DetectorID::setFieldValue()</a>, <a class="el" href="DetectorID_8cxx_source.html#l00025">ldmx::DetectorID::setRawValue()</a>, and <a class="el" href="DetectorID_8cxx_source.html#l00029">ldmx::DetectorID::unpack()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>EventProc/include/EventProc/<a class="el" href="HcalDigiProducer_8h_source.html">HcalDigiProducer.h</a></li>
<li>EventProc/src/<a class="el" href="HcalDigiProducer_8cxx_source.html">HcalDigiProducer.cxx</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="aclassldmx_1_1DetectorID_html_a85f7b28fce48a9f692fc5dc1723c2cad"><div class="ttname"><a href="classldmx_1_1DetectorID.html#a85f7b28fce48a9f692fc5dc1723c2cad">ldmx::DetectorID::setFieldValue</a></div><div class="ttdeci">void setFieldValue(int i, FieldValue value)</div><div class="ttdef"><b>Definition:</b> <a href="DetectorID_8cxx_source.html#l00057">DetectorID.cxx:57</a></div></div>
<div class="ttc" id="aclassldmx_1_1DetectorID_html_a0ab7435051b257d4974ce87c0a1772cd"><div class="ttname"><a href="classldmx_1_1DetectorID.html#a0ab7435051b257d4974ce87c0a1772cd">ldmx::DetectorID::setRawValue</a></div><div class="ttdeci">void setRawValue(RawValue rawValue)</div><div class="ttdef"><b>Definition:</b> <a href="DetectorID_8cxx_source.html#l00025">DetectorID.cxx:25</a></div></div>
<div class="ttc" id="aclassldmx_1_1DetectorID_html_aed9bd3abdb7038a7a43ca4d9eed91b85"><div class="ttname"><a href="classldmx_1_1DetectorID.html#aed9bd3abdb7038a7a43ca4d9eed91b85">ldmx::DetectorID::unpack</a></div><div class="ttdeci">const FieldValueList &amp; unpack()</div><div class="ttdef"><b>Definition:</b> <a href="DetectorID_8cxx_source.html#l00029">DetectorID.cxx:29</a></div></div>
<div class="ttc" id="aclassldmx_1_1DetectorID_html_abb59fb4b7024033aac9a36512b1f78e6"><div class="ttname"><a href="classldmx_1_1DetectorID.html#abb59fb4b7024033aac9a36512b1f78e6">ldmx::DetectorID::pack</a></div><div class="ttdeci">RawValue pack()</div><div class="ttdef"><b>Definition:</b> <a href="DetectorID_8cxx_source.html#l00040">DetectorID.cxx:40</a></div></div>
<div class="ttc" id="aclassldmx_1_1DetectorID_html_ae95e1cc6a9bbb0ba8e0961f3a4b02841"><div class="ttname"><a href="classldmx_1_1DetectorID.html#ae95e1cc6a9bbb0ba8e0961f3a4b02841">ldmx::DetectorID::getFieldValue</a></div><div class="ttdeci">FieldValue getFieldValue(int i)</div><div class="ttdef"><b>Definition:</b> <a href="DetectorID_8cxx_source.html#l00051">DetectorID.cxx:51</a></div></div>
<div class="ttc" id="aclassldmx_1_1DetectorID_html_af0545d6fc148cdb35bbb6228f545ead3"><div class="ttname"><a href="classldmx_1_1DetectorID.html#af0545d6fc148cdb35bbb6228f545ead3">ldmx::DetectorID::getRawValue</a></div><div class="ttdeci">RawValue getRawValue()</div><div class="ttdef"><b>Definition:</b> <a href="DetectorID_8cxx_source.html#l00021">DetectorID.cxx:21</a></div></div>
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>