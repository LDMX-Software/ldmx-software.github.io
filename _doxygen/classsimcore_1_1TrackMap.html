<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.1"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>LDMX Software: simcore::TrackMap Class Reference</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">LDMX Software
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part --><!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>simcore</b></li><li class="navelem"><a class="el" href="classsimcore_1_1TrackMap.html">TrackMap</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classsimcore_1_1TrackMap-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">simcore::TrackMap Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Defines a map of particle ancestry and particles to be saved.  
 <a href="classsimcore_1_1TrackMap.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="TrackMap_8h_source.html">TrackMap.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ada353df3b799ca06e53601d7c0eed577"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#ada353df3b799ca06e53601d7c0eed577">insert</a> (const G4Track *track)</td></tr>
<tr class="separator:ada353df3b799ca06e53601d7c0eed577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07e01d1ed897706a15a59fc7ecd42873"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#a07e01d1ed897706a15a59fc7ecd42873">contains</a> (const G4Track *track) const</td></tr>
<tr class="separator:a07e01d1ed897706a15a59fc7ecd42873"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf371c28a8853b88b268823185c7ee8a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#adf371c28a8853b88b268823185c7ee8a">findIncident</a> (int trackID) const</td></tr>
<tr class="separator:adf371c28a8853b88b268823185c7ee8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fba0ce0fdadfd5648ff265d37731fa0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#a2fba0ce0fdadfd5648ff265d37731fa0">isSaved</a> (int trackID) const</td></tr>
<tr class="separator:a2fba0ce0fdadfd5648ff265d37731fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987632720c8a4dcd34438445e48ecaa0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#a987632720c8a4dcd34438445e48ecaa0">save</a> (const G4Track *track)</td></tr>
<tr class="separator:a987632720c8a4dcd34438445e48ecaa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf3d5c14645119e25914a681e221cde9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#abf3d5c14645119e25914a681e221cde9">traceAncestry</a> ()</td></tr>
<tr class="separator:abf3d5c14645119e25914a681e221cde9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0416efc74239b58f7ccb39abd461bc6b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#a0416efc74239b58f7ccb39abd461bc6b">clear</a> ()</td></tr>
<tr class="separator:a0416efc74239b58f7ccb39abd461bc6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5196bffa28137432be796076bf0cd293"><td class="memItemLeft" align="right" valign="top">std::map&lt; int, <a class="el" href="classldmx_1_1SimParticle.html">ldmx::SimParticle</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#a5196bffa28137432be796076bf0cd293">getParticleMap</a> ()</td></tr>
<tr class="separator:a5196bffa28137432be796076bf0cd293"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ab51b0f53451543dda3e3f32169b32675"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#ab51b0f53451543dda3e3f32169b32675">isInCalorimeterRegion</a> (const G4Track *track) const</td></tr>
<tr class="separator:ab51b0f53451543dda3e3f32169b32675"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a05b8b1c8a634a301ffdfb232cd9dc52a"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; int, std::pair&lt; int, bool &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#a05b8b1c8a634a301ffdfb232cd9dc52a">ancestry_</a></td></tr>
<tr class="separator:a05b8b1c8a634a301ffdfb232cd9dc52a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e8313b41d210eb585f32104e8efffcc"><td class="memItemLeft" align="right" valign="top"><a id="a6e8313b41d210eb585f32104e8efffcc"></a>
std::unordered_map&lt; int, std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#a6e8313b41d210eb585f32104e8efffcc">descendents_</a></td></tr>
<tr class="memdesc:a6e8313b41d210eb585f32104e8efffcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">descendents map of particles in event (parent -&gt; children) <br /></td></tr>
<tr class="separator:a6e8313b41d210eb585f32104e8efffcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99275f25372f121a6d1e4ebfddaf3296"><td class="memItemLeft" align="right" valign="top"><a id="a99275f25372f121a6d1e4ebfddaf3296"></a>
std::map&lt; int, <a class="el" href="classldmx_1_1SimParticle.html">ldmx::SimParticle</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsimcore_1_1TrackMap.html#a99275f25372f121a6d1e4ebfddaf3296">particle_map_</a></td></tr>
<tr class="memdesc:a99275f25372f121a6d1e4ebfddaf3296"><td class="mdescLeft">&#160;</td><td class="mdescRight">map of SimParticles that will be stored <br /></td></tr>
<tr class="separator:a99275f25372f121a6d1e4ebfddaf3296"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Defines a map of particle ancestry and particles to be saved. </p>
<p>This class keeps track of the ancestry (child -&gt; parent) and descendents (parent -&gt; children) of ALL particles generated in an event. This allows the particles that are chosen to be saved (via the <a class="el" href="classsimcore_1_1TrackMap.html#a987632720c8a4dcd34438445e48ecaa0">TrackMap::save</a> method) to have their parent and children faithfully recorded in the output file. </p>

<p class="definition">Definition at line <a class="el" href="TrackMap_8h_source.html#l00028">28</a> of file <a class="el" href="TrackMap_8h_source.html">TrackMap.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a0416efc74239b58f7ccb39abd461bc6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0416efc74239b58f7ccb39abd461bc6b">&#9670;&nbsp;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simcore::TrackMap::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clear the internal maps.</p>
<p>This should be called at the <b>beginning</b> of an event. The maps need to persist through the end of the event so that they are available to be written to the output file. </p>

<p class="definition">Definition at line <a class="el" href="TrackMap_8cxx_source.html#l00100">100</a> of file <a class="el" href="TrackMap_8cxx_source.html">TrackMap.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                     {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="classsimcore_1_1TrackMap.html#a05b8b1c8a634a301ffdfb232cd9dc52a">ancestry_</a>.clear();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classsimcore_1_1TrackMap.html#a6e8313b41d210eb585f32104e8efffcc">descendents_</a>.clear();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="classsimcore_1_1TrackMap.html#a99275f25372f121a6d1e4ebfddaf3296">particle_map_</a>.clear();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="ttc" id="aclasssimcore_1_1TrackMap_html_a05b8b1c8a634a301ffdfb232cd9dc52a"><div class="ttname"><a href="classsimcore_1_1TrackMap.html#a05b8b1c8a634a301ffdfb232cd9dc52a">simcore::TrackMap::ancestry_</a></div><div class="ttdeci">std::unordered_map&lt; int, std::pair&lt; int, bool &gt; &gt; ancestry_</div><div class="ttdef"><b>Definition:</b> <a href="TrackMap_8h_source.html#l00128">TrackMap.h:128</a></div></div>
<div class="ttc" id="aclasssimcore_1_1TrackMap_html_a6e8313b41d210eb585f32104e8efffcc"><div class="ttname"><a href="classsimcore_1_1TrackMap.html#a6e8313b41d210eb585f32104e8efffcc">simcore::TrackMap::descendents_</a></div><div class="ttdeci">std::unordered_map&lt; int, std::vector&lt; int &gt; &gt; descendents_</div><div class="ttdoc">descendents map of particles in event (parent -&gt; children)</div><div class="ttdef"><b>Definition:</b> <a href="TrackMap_8h_source.html#l00131">TrackMap.h:131</a></div></div>
<div class="ttc" id="aclasssimcore_1_1TrackMap_html_a99275f25372f121a6d1e4ebfddaf3296"><div class="ttname"><a href="classsimcore_1_1TrackMap.html#a99275f25372f121a6d1e4ebfddaf3296">simcore::TrackMap::particle_map_</a></div><div class="ttdeci">std::map&lt; int, ldmx::SimParticle &gt; particle_map_</div><div class="ttdoc">map of SimParticles that will be stored</div><div class="ttdef"><b>Definition:</b> <a href="TrackMap_8h_source.html#l00134">TrackMap.h:134</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackMap_8h_source.html#l00128">ancestry_</a>, <a class="el" href="TrackMap_8h_source.html#l00131">descendents_</a>, and <a class="el" href="TrackMap_8h_source.html#l00134">particle_map_</a>.</p>

<p class="reference">Referenced by <a class="el" href="UserEventAction_8cxx_source.html#l00024">simcore::UserEventAction::BeginOfEventAction()</a>.</p>

</div>
</div>
<a id="a07e01d1ed897706a15a59fc7ecd42873"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07e01d1ed897706a15a59fc7ecd42873">&#9670;&nbsp;</a></span>contains()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool simcore::TrackMap::contains </td>
          <td>(</td>
          <td class="paramtype">const G4Track *&#160;</td>
          <td class="paramname"><em>track</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if the passed track has already been inserted into the track map. </p>

<p class="definition">Definition at line <a class="el" href="TrackMap_8h_source.html#l00040">40</a> of file <a class="el" href="TrackMap_8h_source.html">TrackMap.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                                   {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classsimcore_1_1TrackMap.html#a05b8b1c8a634a301ffdfb232cd9dc52a">ancestry_</a>.find(track-&gt;GetTrackID()) != <a class="code" href="classsimcore_1_1TrackMap.html#a05b8b1c8a634a301ffdfb232cd9dc52a">ancestry_</a>.end();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackMap_8h_source.html#l00128">ancestry_</a>.</p>

<p class="reference">Referenced by <a class="el" href="UserTrackingAction_8cxx_source.html#l00018">simcore::UserTrackingAction::PreUserTrackingAction()</a>.</p>

</div>
</div>
<a id="adf371c28a8853b88b268823185c7ee8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf371c28a8853b88b268823185c7ee8a">&#9670;&nbsp;</a></span>findIncident()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int simcore::TrackMap::findIncident </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trackID</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find a trajectory's nearest parent that is incident on the calorimeter region. We assume that the primary particles have a parent ID of 0.</p>
<p>If this track ID does not have such a trajectory, then the track ID of the primary in its parentage is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trackID</td><td>The track ID to search its parentage for the incident </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="TrackMap_8cxx_source.html#l00014">14</a> of file <a class="el" href="TrackMap_8cxx_source.html">TrackMap.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                                              {</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordtype">int</span> currTrackID = trackID;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordtype">bool</span> foundIncident{<span class="keyword">false</span>};</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">while</span> (not foundIncident) {</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="keyword">auto</span> &amp;[parentID, inCalRegion] = <a class="code" href="classsimcore_1_1TrackMap.html#a05b8b1c8a634a301ffdfb232cd9dc52a">ancestry_</a>.at(currTrackID);</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keywordflow">if</span> (not inCalRegion or parentID == 0) {</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      <span class="comment">// current track ID is nearest ancestor</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;      <span class="comment">// originating outside cal region</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;      <span class="comment">// or is a primary particle</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;      foundIncident = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;      <span class="comment">// still in cal region, keep going</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;      currTrackID = parentID;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    }</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">return</span> currTrackID;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackMap_8h_source.html#l00128">ancestry_</a>.</p>

</div>
</div>
<a id="a5196bffa28137432be796076bf0cd293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5196bffa28137432be796076bf0cd293">&#9670;&nbsp;</a></span>getParticleMap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;int,<a class="el" href="classldmx_1_1SimParticle.html">ldmx::SimParticle</a>&gt;&amp; simcore::TrackMap::getParticleMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the map of particles to be stored in output event. </p>

<p class="definition">Definition at line <a class="el" href="TrackMap_8h_source.html#l00095">95</a> of file <a class="el" href="TrackMap_8h_source.html">TrackMap.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                                {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classsimcore_1_1TrackMap.html#a99275f25372f121a6d1e4ebfddaf3296">particle_map_</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackMap_8h_source.html#l00134">particle_map_</a>.</p>

<p class="reference">Referenced by <a class="el" href="DecayChildrenKeeper_8cxx_source.html#l00026">biasing::utility::DecayChildrenKeeper::PostUserTrackingAction()</a>.</p>

</div>
</div>
<a id="ada353df3b799ca06e53601d7c0eed577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada353df3b799ca06e53601d7c0eed577">&#9670;&nbsp;</a></span>insert()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simcore::TrackMap::insert </td>
          <td>(</td>
          <td class="paramtype">const G4Track *&#160;</td>
          <td class="paramname"><em>track</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a record in the map for the input track. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">track</td><td>G4Track to insert </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="TrackMap_8cxx_source.html#l00009">9</a> of file <a class="el" href="TrackMap_8cxx_source.html">TrackMap.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                                          {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <a class="code" href="classsimcore_1_1TrackMap.html#a05b8b1c8a634a301ffdfb232cd9dc52a">ancestry_</a>[track-&gt;GetTrackID()] = std::make_pair(track-&gt;GetParentID(),<a class="code" href="classsimcore_1_1TrackMap.html#ab51b0f53451543dda3e3f32169b32675">isInCalorimeterRegion</a>(track));</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <a class="code" href="classsimcore_1_1TrackMap.html#a6e8313b41d210eb585f32104e8efffcc">descendents_</a>[track-&gt;GetParentID()].push_back(track-&gt;GetTrackID());</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;}</div>
<div class="ttc" id="aclasssimcore_1_1TrackMap_html_ab51b0f53451543dda3e3f32169b32675"><div class="ttname"><a href="classsimcore_1_1TrackMap.html#ab51b0f53451543dda3e3f32169b32675">simcore::TrackMap::isInCalorimeterRegion</a></div><div class="ttdeci">bool isInCalorimeterRegion(const G4Track *track) const</div><div class="ttdef"><b>Definition:</b> <a href="TrackMap_8cxx_source.html#l00106">TrackMap.cxx:106</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackMap_8h_source.html#l00128">ancestry_</a>, <a class="el" href="TrackMap_8h_source.html#l00131">descendents_</a>, and <a class="el" href="TrackMap_8cxx_source.html#l00106">isInCalorimeterRegion()</a>.</p>

<p class="reference">Referenced by <a class="el" href="UserTrackingAction_8cxx_source.html#l00018">simcore::UserTrackingAction::PreUserTrackingAction()</a>.</p>

</div>
</div>
<a id="ab51b0f53451543dda3e3f32169b32675"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab51b0f53451543dda3e3f32169b32675">&#9670;&nbsp;</a></span>isInCalorimeterRegion()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool simcore::TrackMap::isInCalorimeterRegion </td>
          <td>(</td>
          <td class="paramtype">const G4Track *&#160;</td>
          <td class="paramname"><em>track</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Was the input track generated inside the calorimeter region?</p>
<p>We rely on the fact that the calorimeter region is named 'CalorimeterRegion' and no other region names contain the string 'Calorimeter' </p>

<p class="definition">Definition at line <a class="el" href="TrackMap_8cxx_source.html#l00106">106</a> of file <a class="el" href="TrackMap_8cxx_source.html">TrackMap.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                                                               {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">auto</span> region{track-&gt;GetLogicalVolumeAtVertex()-&gt;GetRegion()-&gt;GetName()};</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordflow">return</span> region.contains(<span class="stringliteral">&quot;Calorimeter&quot;</span>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="TrackMap_8cxx_source.html#l00009">insert()</a>.</p>

</div>
</div>
<a id="a2fba0ce0fdadfd5648ff265d37731fa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fba0ce0fdadfd5648ff265d37731fa0">&#9670;&nbsp;</a></span>isSaved()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool simcore::TrackMap::isSaved </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>trackID</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return true if the given track ID is saved i.e. will be stored in output file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trackID</td><td>The track ID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if the track ID has been inserted in output particle map </dd></dl>

<p class="definition">Definition at line <a class="el" href="TrackMap_8h_source.html#l00062">62</a> of file <a class="el" href="TrackMap_8h_source.html">TrackMap.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                         {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classsimcore_1_1TrackMap.html#a99275f25372f121a6d1e4ebfddaf3296">particle_map_</a>.find(trackID) != <a class="code" href="classsimcore_1_1TrackMap.html#a99275f25372f121a6d1e4ebfddaf3296">particle_map_</a>.end();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackMap_8h_source.html#l00134">particle_map_</a>.</p>

</div>
</div>
<a id="a987632720c8a4dcd34438445e48ecaa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987632720c8a4dcd34438445e48ecaa0">&#9670;&nbsp;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simcore::TrackMap::save </td>
          <td>(</td>
          <td class="paramtype">const G4Track *&#160;</td>
          <td class="paramname"><em>track</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a track to be stored into output map </p><dl class="section note"><dt>Note</dt><dd>We assume that the track is at the end of processing so that its current kinematics can be labeled as the "end-point" kinematics. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">track</td><td>G4Track to store into output </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="TrackMap_8cxx_source.html#l00032">32</a> of file <a class="el" href="TrackMap_8cxx_source.html">TrackMap.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                        {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">// create sim particle in map, keep reference to the newly created particle</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="classldmx_1_1SimParticle.html">ldmx::SimParticle</a>&amp; particle{<a class="code" href="classsimcore_1_1TrackMap.html#a99275f25372f121a6d1e4ebfddaf3296">particle_map_</a>[track-&gt;GetTrackID()]};</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// TODO: default gen status?</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  particle.setGenStatus(0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// Update the gen status from the primary particle.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">if</span> (track-&gt;GetDynamicParticle()-&gt;GetPrimaryParticle() != NULL) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    G4VUserPrimaryParticleInformation* primaryInfo =</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        track-&gt;GetDynamicParticle()-&gt;GetPrimaryParticle()-&gt;GetUserInformation();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">if</span> (primaryInfo != NULL) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      particle.setGenStatus(</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;          ((UserPrimaryParticleInformation*)primaryInfo)-&gt;getHepEvtStatus());</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  }</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keyword">auto</span> particle_def{track-&gt;GetDefinition()};</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  particle.setPdgID(particle_def-&gt;GetPDGEncoding());</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  particle.setCharge(particle_def-&gt;GetPDGCharge());</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  particle.setMass(track-&gt;GetDynamicParticle()-&gt;GetMass());</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  particle.setEnergy(track-&gt;GetVertexKineticEnergy()+track-&gt;GetDynamicParticle()-&gt;GetMass());</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keyword">auto</span> track_info{<a class="code" href="classsimcore_1_1UserTrackInformation.html#a05d99ef5ad9cc9e31abcfb5505bc2b9e">UserTrackInformation::get</a>(track)};</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  particle.setVertexVolume(track_info-&gt;getVertexVolume());</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keyword">auto</span> vert{track-&gt;GetVertexPosition()};</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  particle.setVertex(vert.x(), vert.y(), vert.z());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  particle.setTime(track_info-&gt;getVertexTime());</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keyword">auto</span> init_momentum{track_info-&gt;<a class="code" href="classsimcore_1_1UserTrackInformation.html#ac761df43c7d9ce5aa6d0bf0f4eb7f2ee">getInitialMomentum</a>()};</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  particle.setMomentum(init_momentum.x(), init_momentum.y(), init_momentum.z());</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keyword">const</span> G4VProcess* process{track-&gt;GetCreatorProcess()};</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">if</span> (process) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">const</span> G4String&amp; name{process-&gt;GetProcessName()};</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    particle.setProcessType(<a class="code" href="classldmx_1_1SimParticle.html#a9017ca6a3b598240f491afa452018de1">ldmx::SimParticle::findProcessType</a>(name));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    particle.setProcessType(ldmx::SimParticle::ProcessType::unknown);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// track&#39;s current kinematics is its end point kinematics</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">//  because we are assuming this track is being stopped/killed</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keyword">auto</span> momentum{track-&gt;GetMomentum()};</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  particle.setEndPointMomentum(momentum.x(), momentum.y(), momentum.z());</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keyword">auto</span> end_pt{track-&gt;GetPosition()};</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  particle.setEndPoint(end_pt.x(), end_pt.y(), end_pt.z());</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="aclassldmx_1_1SimParticle_html"><div class="ttname"><a href="classldmx_1_1SimParticle.html">ldmx::SimParticle</a></div><div class="ttdef"><b>Definition:</b> <a href="SimParticle_8h_source.html#l00023">SimParticle.h:23</a></div></div>
<div class="ttc" id="aclassldmx_1_1SimParticle_html_a9017ca6a3b598240f491afa452018de1"><div class="ttname"><a href="classldmx_1_1SimParticle.html#a9017ca6a3b598240f491afa452018de1">ldmx::SimParticle::findProcessType</a></div><div class="ttdeci">static ProcessType findProcessType(std::string processName)</div></div>
<div class="ttc" id="aclasssimcore_1_1UserTrackInformation_html_a05d99ef5ad9cc9e31abcfb5505bc2b9e"><div class="ttname"><a href="classsimcore_1_1UserTrackInformation.html#a05d99ef5ad9cc9e31abcfb5505bc2b9e">simcore::UserTrackInformation::get</a></div><div class="ttdeci">static UserTrackInformation * get(const G4Track *track)</div><div class="ttdef"><b>Definition:</b> <a href="UserTrackInformation_8cxx_source.html#l00010">UserTrackInformation.cxx:10</a></div></div>
<div class="ttc" id="aclasssimcore_1_1UserTrackInformation_html_ac761df43c7d9ce5aa6d0bf0f4eb7f2ee"><div class="ttname"><a href="classsimcore_1_1UserTrackInformation.html#ac761df43c7d9ce5aa6d0bf0f4eb7f2ee">simcore::UserTrackInformation::getInitialMomentum</a></div><div class="ttdeci">const G4ThreeVector &amp; getInitialMomentum() const</div><div class="ttdef"><b>Definition:</b> <a href="UserTrackInformation_8h_source.html#l00108">UserTrackInformation.h:108</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="classldmx_1_1SimParticle.html#a9017ca6a3b598240f491afa452018de1">ldmx::SimParticle::findProcessType()</a>, <a class="el" href="UserTrackInformation_8cxx_source.html#l00010">simcore::UserTrackInformation::get()</a>, <a class="el" href="UserTrackInformation_8h_source.html#l00108">simcore::UserTrackInformation::getInitialMomentum()</a>, and <a class="el" href="TrackMap_8h_source.html#l00134">particle_map_</a>.</p>

<p class="reference">Referenced by <a class="el" href="UserTrackingAction_8cxx_source.html#l00067">simcore::UserTrackingAction::PostUserTrackingAction()</a>.</p>

</div>
</div>
<a id="abf3d5c14645119e25914a681e221cde9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf3d5c14645119e25914a681e221cde9">&#9670;&nbsp;</a></span>traceAncestry()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simcore::TrackMap::traceAncestry </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Trace the ancestry for the particles that will be stored. This should be done at the end of the event before writing the particle map to the event bus and involves looping through the particles that will be saved. </p>
<p>Use [] instead of at() for descendents_ so that if it wasn't previously created, we will just silently create an empty vector and move on.</p>

<p class="definition">Definition at line <a class="el" href="TrackMap_8cxx_source.html#l00084">84</a> of file <a class="el" href="TrackMap_8cxx_source.html">TrackMap.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                             {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; [<span class="keywordtype">id</span>, particle] : <a class="code" href="classsimcore_1_1TrackMap.html#a99275f25372f121a6d1e4ebfddaf3296">particle_map_</a>) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    particle.addParent(<a class="code" href="classsimcore_1_1TrackMap.html#a05b8b1c8a634a301ffdfb232cd9dc52a">ancestry_</a>.at(<span class="keywordtype">id</span>).first);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;child : <a class="code" href="classsimcore_1_1TrackMap.html#a6e8313b41d210eb585f32104e8efffcc">descendents_</a>[<span class="keywordtype">id</span>]) {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      particle.addDaughter(child);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  }</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="TrackMap_8h_source.html#l00128">ancestry_</a>, <a class="el" href="TrackMap_8h_source.html#l00131">descendents_</a>, and <a class="el" href="TrackMap_8h_source.html#l00134">particle_map_</a>.</p>

<p class="reference">Referenced by <a class="el" href="RootPersistencyManager_8cxx_source.html#l00089">simcore::persist::RootPersistencyManager::buildEvent()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a05b8b1c8a634a301ffdfb232cd9dc52a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05b8b1c8a634a301ffdfb232cd9dc52a">&#9670;&nbsp;</a></span>ancestry_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;int,std::pair&lt;int,bool&gt; &gt; simcore::TrackMap::ancestry_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ancestry map of particles in event (child -&gt; parent)</p>
<p>Primary particles are given a "parent" ID of 0 to reflect that they don't have a parent. This is the default in Geant4 and we assume that holds here.</p>
<p>This is helpful for the findIncident method which looks up through a track's history to find the first ancestor which originated outside of the calorimeter region.</p>
<p>The key value is a pair where the first entry is the parent track ID and the second entry is whether <b>the child track</b> is in the calorimeter region.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classsimcore_1_1TrackMap.html#ab51b0f53451543dda3e3f32169b32675">isInCalorimeterRegion</a> for how we check if a track originated in the calorimeter region. </dd></dl>

<p class="definition">Definition at line <a class="el" href="TrackMap_8h_source.html#l00128">128</a> of file <a class="el" href="TrackMap_8h_source.html">TrackMap.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="TrackMap_8cxx_source.html#l00100">clear()</a>, <a class="el" href="TrackMap_8h_source.html#l00040">contains()</a>, <a class="el" href="TrackMap_8cxx_source.html#l00014">findIncident()</a>, <a class="el" href="TrackMap_8cxx_source.html#l00009">insert()</a>, and <a class="el" href="TrackMap_8cxx_source.html#l00084">traceAncestry()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>SimCore/include/SimCore/<a class="el" href="TrackMap_8h_source.html">TrackMap.h</a></li>
<li>SimCore/src/SimCore/<a class="el" href="TrackMap_8cxx_source.html">TrackMap.cxx</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
		<script src="custom.js"></script>
	</body>
</html>